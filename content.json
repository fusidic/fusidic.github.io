{"pages":[{"title":"about","text":"","link":"/about/index.html"}],"posts":[{"title":"[NOTE] CentOSæ¢æº","text":"mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo yum makecache è¡¥å……Ubuntu/etc/apt/sources.list 123456789101112131415161718192021222324##ä¸­ç§‘å¤§æºdeb https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiversedeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiversedeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiversedeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiversedeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiversedeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiversedeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse# é˜¿é‡Œæºdeb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse sudo apt-get update sudo apt-get upgrade ä¸åŠ -getä¼šæœ‰éƒ¨åˆ†æ›´æ–°å¤±è´¥","link":"/2019/07/03/CentOS%E6%8D%A2%E6%BA%90/"},{"title":"[NOTE] ClockSynchronize","text":"Ubuntu Check your current time-zone: cat /etc/timezone Check if your clock is synchronized with the internet: timedatectl 12345678root@openstack1:~/kubernetes# timedatectl Local time: Tue 2019-12-17 10:30:02 UTC Universal time: Tue 2019-12-17 10:30:02 UTC RTC time: Tue 2019-12-17 10:30:02 Time zone: Etc/UTC (UTC, +0000) System clock synchronized: yessystemd-timesyncd.service active: yes RTC in local TZ: no If you havenâ€™t sychronized with internet, the value of System clock synchronize must be no Use sudo systemctl restart systemd-timesyncd.service to activate timesyncd 12345678910root@openstack1:~/kubernetes# systemctl status systemd-timesyncd.serviceâ— systemd-timesyncd.service - Network Time Synchronization Loaded: loaded (/lib/systemd/system/systemd-timesyncd.service; enabled; vendo Active: active (running) since Mon 2019-12-16 09:24:02 UTC; 1 day 1h ago Docs: man:systemd-timesyncd.service(8) Main PID: 27584 (systemd-timesyn) Status: \"Synchronized to time server 91.189.94.4:123 (ntp.ubuntu.com).\" Tasks: 2 (limit: 4915) CGroup: /system.slice/systemd-timesyncd.service â””â”€27584 /lib/systemd/systemd-timesyncd The final key to synchronize the clock sudo timedatectl set-ntp true Switch your time-zone timedatectl list-timezones to check all the time-zones. sudo timedatectl set-timezone Asia/Shanghai CentOS Using command line 123456789# installationyum install chrony# enable chronydsystemctl start chronydsystemctl enable chronyd# set timezone to Shanghaitimedatectl set-timezone Asia/Shanghai# launch ittimedatectl set-ntp yes","link":"/2019/12/18/ClockSynchronize/"},{"title":"[NOTE] GitLab","text":"Ubuntu Server + Docker + Gitlab ä»¥åŠ Git ä½¿ç”¨ã€‚ å› ä¸ºæœ€è¿‘ä¹Ÿæ¥è§¦äº†Dockerï¼Œæ‰€ä»¥ä¹Ÿç®—æ˜¯ç»ƒæ‰‹ï¼Œå†³å®šå°†Gitlabç›´æ¥éƒ¨ç½²åˆ°dockerå½“ä¸­ ä¸€ã€Dockerå®¹å™¨å®‰è£…1sudo apt-get install docker-ce ä¸ºäº†ä¾¿äºä½¿ç”¨ï¼Œä¿®æ”¹dockeré•œåƒæº 12345678sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'{ \"registry-mirrors\": [\"https://0ghk1qyk.mirror.aliyuncs.com\"]}EOFsudo systemctl daemon-reloadsudo systemctl restart docker äºŒã€å®‰è£…å¹¶é…ç½®gitlab-server12345678910sudo docker run --detach \\ --hostname gitlab-server \\ --publish 443:443 --publish 80:80 --publish 22:22 \\ --name gitlab \\ --restart always \\ --volume /srv/gitlab/config:/etc/gitlab \\ --volume /srv/gitlab/logs:/var/log/gitlab \\ --volume /srv/gitlab/data:/var/opt/gitlab \\ --env GITLAB_OMNIBUS_CONFIG=\"external_url 'http://192.168.1.253';\" \\ gitlab/gitlab-ee:latest ä»‹ç»å…¶ä¸­çš„å‡ ä¸ªé…ç½®é¡¹ï¼Œ â€”publishå‘Šè¯‰å®¹å™¨å‘å¸ƒæ•°æ®çš„ç«¯å£ï¼Œä»¥åŠä¸»æœºç«¯å£ä¸å®¹å™¨ç«¯å£ä¹‹é—´çš„å…³ç³»ï¼Œç”±äºGitLabæ¥å—HTTP(80), HTTPS(443)ä»¥åŠSSH(22)ç«¯å£çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥publishè¿™ä¸€è¡Œçš„è®¾ç½®æ˜¯å°†ä¸»æœºå¯¹åº”çš„ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ç«¯å£ä¸Šã€‚ å¦‚æœæƒ³è¦è®¾ç½®éæ ‡å‡†çš„ç«¯å£(ç”±äºç«¯å£å·²è¢«å ç”¨)ï¼Œè¦å°†ä¸»æœºç«¯å£æ”¾åœ¨å‰ï¼Œå®¹å™¨ç«¯å£æ”¾åœ¨åã€‚ åœ¨é‡‡ç”¨è¿™ä¸ªè®¾ç½®ä¹‹å‰ï¼Œæˆ‘å°†SSHè®¾ç½®ä¸ºäº†2222ï¼ŒHTTPç«¯å£è®¾ç½®ä¸ºäº†9090ï¼Œå¹¶ä¸”åœ¨gitlab.rbæ–‡ä»¶ä¸­ä¿®æ”¹äº†ç›¸åº”çš„ç«¯å£ï¼Œä½†å¯èƒ½æ˜¯å“ªä¸ªæ­¥éª¤æœ‰ç–æ¼ï¼Œå¯¼è‡´GitLabé¡µé¢ä¸€ç›´æ˜¾ç¤º502ï¼Œè¿™ç‚¹ä¹‹åä¼šæœ‰æ‰€è¯´æ˜ â€”restartä½¿å®¹å™¨åœ¨æ¨å‡ºåèƒ½ç«‹å³é‡å¯ï¼Œä¿è¯æŒç»­æä¾›æœåŠ¡ â€”volumeå¯ä»¥è®²å®¹å™¨ä¸­çš„è·¯å¾„æŒ‚è½½åˆ°æœ¬æœºä¸­ï¼Œæ­¤å¤„æŒ‚è½½äº†åŒ…æ‹¬åº”ç”¨æ•°æ®ã€æ—¥å¿—ä»¥åŠé…ç½®æ–‡ä»¶ï¼Œè¿™æ ·åœ¨ç»´æŠ¤ä¸­ä¼šå¸¦æ¥ä¸€äº›æ–¹ä¾¿ è¿™äº›å‘½ä»¤åœ¨æ–‡æ¡£ä¸­éƒ½æœ‰ä»‹ç»ï¼Œæœ‰è¶³å¤Ÿçš„ç»éªŒä¹‹åï¼Œå®Œå…¨å¯ä»¥åœ¨éœ€è¦ä½¿ç”¨æ—¶å†å»æŸ¥è¯¢ã€‚ ä¸‰ã€è¸©å‘è®°å½•(1)ç”±äºæœ€å…ˆå¼€å§‹é…ç½®GItLabæ—¶ï¼Œå¹¶ä¸æƒ³å»ä¿®æ”¹é»˜è®¤çš„sshç«¯å£22ï¼Œé…ç½®å¦‚ä¸‹ï¼š 12345678910docker run --detach \\--hostname gitlab-server \\--publish 9090:9090 \\--publish 8022:8022 \\--name gitlab \\--restart always \\--volume /srv/gitlab/config:/etc/gitlab \\--volume /srv/gitlab/logs:/var/log/gitlab \\--volume /srv/gitlab/data:/var/opt/gitlab \\gitlab/gitlab-ee:latest ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š 1234vi /srv/gitlab/config/gitlab.rb# docker exec -it gitlab vim /etc/gitlab/gitlab.rb# æ­¤å‘½ä»¤ç­‰ä»·# ä¿®æ”¹external_url 'http://192.168.1.253:9090' ç°åœ¨çœ‹æ¥ï¼Œè¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼Œä»¥æˆ‘ç²—æµ…çš„è®¤çŸ¥ï¼Œæˆ‘è®¤ä¸ºåº”è¯¥è‡³å°‘åº”è¯¥æ˜¯å°†publishé…ç½®ä¸º80:8888, 22:8022è¿™æ ·æ‰æ¯”è¾ƒåˆç†ï¼Œä¸çŸ¥æˆ‘æ‰€å‚è€ƒçš„åšå®¢çš„åŸä½œè€…æ˜¯æ€ä¹ˆæˆåŠŸçš„ï¼Œåæ­£æˆ‘è¿™æ ·æ˜¯ä¸€ç›´æ˜¾ç¤º502ï¼Œåœ¨æŸ¥çœ‹logæ–‡ä»¶ä¹‹å å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°é—®é¢˜å‡ºåœ¨è¿æ¥ç«¯å£ä¸Šï¼Œæ­¤åé€šè¿‡dockerå‘½ä»¤åœæ­¢å¹¶åˆ é™¤æ”¹å®¹å™¨ï¼Œé‡æ–°é…ç½®ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚ 12sudo docker stop gitlabsudo docker container rm gitlab åœ¨ä½¿ç”¨é»˜è®¤ç«¯å£ä¹‹åï¼Œsshç«¯å£ä¼šå‘ç”Ÿç«¯å£å†²çªçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨vi /etc/ssh/sshd_configæ–‡ä»¶ä¸­åŠ å…¥Port 26æ¢å¤å¯¹ç«¯å£çš„ç›‘å¬ å››ã€GitLabç»´æŠ¤4.1 GitLabå‡çº§1234567891011121314sudo docker stop gitlabsudo docker rm gitlabsudo docker pull gitlab/gitlab-ee:latestsudo docker run --detach \\ --hostname gitlab-server \\ --publish 443:443 --publish 80:80 --publish 22:22 \\ --name gitlab \\ --restart always \\ --volume /srv/gitlab/config:/etc/gitlab \\ --volume /srv/gitlab/logs:/var/log/gitlab \\ --volume /srv/gitlab/data:/var/opt/gitlab \\ --env GITLAB_OMNIBUS_CONFIG=\"external_url 'http://192.168.1.253/';\" \\ gitlab/gitlab-ee:latest å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ç§»é™¤äº†å½“å‰çš„å®¹å™¨ï¼Œä½†æ˜¯ç”±äºé•œåƒä¾æ—§åœ¨æœ¬åœ°ç£ç›˜ä¸­ï¼Œä¸”ç”±äºæŒ‚è½½çš„å…³ç³»ï¼Œåº”ç”¨æ•°æ®ã€æ—¥å¿—ç­‰éƒ½è¿˜åœ¨ã€‚ äº”ã€è¸©å‘è®°å½•(2)5.1 æäº¤ç¼“å­˜è¶…å‡º(solved)åœ¨æˆ‘å°†æ•´ä¸ªåšå®¢åŠå…¶ç¼–è¯‘ç¯å¢ƒå…¨éƒ¨ä¸Šä¼ gitlabæ—¶é‡åˆ°äº†è¿™ç§æƒ…å†µï¼Œè§£å†³æ–¹æ³•æ˜¯ä¿®æ”¹å·¥ä½œç›®å½•ä¸‹.gitæ–‡ä»¶å¤¹ä¸­çš„configæ–‡ä»¶ï¼š 12[http]postBuffer = 524288000 5.2 æ— æ³•ä½¿ç”¨GitLabå†…ç½®ssh(In queue)![Screen Shot 2019-07-27 at 11.22.08](/Users/fusidic/Documents/work/hugo/test-pages/static/img/GitLab/Screen Shot 2019-07-27 at 11.22.08.png) å°šæœªè§£å†³ï¼ŒçŒœæƒ³åº”è¯¥ä¸gitè´¦æˆ·æƒé™æœ‰å…³","link":"/2019/08/03/GitLab/"},{"title":"[Golang] Go Mod Best-Practice(NotReally)","text":"Goåœ¨1.11ç‰ˆæœ¬åå¼€å§‹æ”¯æŒmodulesï¼Œä»¥go modæ¥å®ç°åŒ…ç®¡ç†ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ Beforeæœ¬æ–‡å‰æä½ å·²ç»æœ‰äº†å¦‚ä¸‹ç¯å¢ƒï¼š VS Code Golang v1.11 or later å·²æ­£ç¡®è®¾ç½®GOROOT GOPATH Git Quick Startç›´æ¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œä½“éªŒæ›´ä½³ã€‚ 1. æ­é…LSPé£Ÿç”¨LSP(Language Server Protocol) å³è¯­è¨€æœåŠ¡å™¨åè®®ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©ä¸åŒçš„ç¼–è¾‘å™¨æˆ–é›†æˆå¼€å‘ç¯å¢ƒæ–¹ä¾¿ä½¿ç”¨å„ç§ç¨‹åºè¯­è¨€ï¼Œæ”¯æŒåŒ…æ‹¬è¯­æ³•æ£€æŸ¥ã€è‡ªåŠ¨è¡¥å…¨ã€è·³è½¬ã€å¼•ç”¨æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚ å°†è¿™äº›åŠŸèƒ½æ”¾å…¥ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼Œå¯ä»¥åŒæ—¶å¯¹ä¸åŒç¼–è¾‘å™¨ç”Ÿæ•ˆï¼Œé¿å…äº†èµ„æºçš„æµªè´¹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å°†è¯­è¨€æœåŠ¡å™¨éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œé‡Šæ”¾æœ¬åœ°å› æ‰«æè¯­è¨€è€Œå¸¦æ¥çš„CPUè´Ÿæ‹…ã€‚ å®‰è£…goplsï¼šæ‰“å¼€VS Codeï¼Œcommand+,æ‰“å¼€è®¾ç½®ï¼Œæœç´¢go.useLanguageServerå‹¾é€‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ—¶Goæ‰©å±•å°±ä¼šè‡ªåŠ¨æç¤ºä½ å®‰è£…goplsï¼Œæˆ–è€…æ‰‹åŠ¨å®‰è£… 1go get golang.org/x/tools/gopls@latest goplsä¼šå®‰è£…åˆ°GOPATHç›®å½•ä¸‹çš„binä¸­ï¼Œå¦‚æœå­˜åœ¨ç½‘ç»œé—®é¢˜ï¼Œå¯ä»¥å°†goproxyè®¾ç½®ä¸ºgoproxy.cnï¼Œæ˜¯ä¸€ä¸ªå›½å†…çš„å¤§å­¦ç”Ÿå’Œä¸ƒç‰›äº‘åˆä½œæä¾›çš„ä¸€ä¸ªå¼€æºCDNï¼Œå®‰å…¨æ€§è‡ªå·±åˆ¤æ–­äº†: 1export GOPROXY=https://goproxy.cn å¯¼å…¥é…ç½®åˆ°settings.jsonä¸­: 123456789101112131415161718192021{ \"go.useLanguageServer\": true, \"go.alternateTools\": { \"go-langserver\": \"gopls\" }, \"go.languageServerExperimentalFeatures\": { \"format\": true, \"autoComplete\": true }, \"[go]\": { \"editor.snippetSuggestions\": \"none\", \"editor.formatOnSave\": true, \"editor.codeActionsOnSave\": { \"source.organizeImports\": true }, }, \"gopls\": { \"usePlaceholders\": true, \"enhancedHover\": true }} å¦‚ä½•æ‰“å¼€settings.json? command + , å³ä¸Šè§’å›¾æ ‡open settings(JSON) (Optional) å¼€å¯è°ƒè¯•ä¿¡æ¯ï¼Œåœ¨settingsä¸­åŠ å…¥ï¼š 12345\"go.languageServerFlags\": [ \"-rpc.trace\", // for more detailed debug logging \"serve\", \"--debug=localhost:6060\", // to investigate memory usage, see profiles], 2. Go Modç®€å•ä½“ä¼šä¸€ä¸‹Go modçš„æ–¹ä¾¿ä¹‹å¤„ï¼Œé¦–å…ˆæ‰“å¼€gomod 123go env -w GO111MODULE=on// orexport GO111MODULE=auto åœ¨GOPATHç›®å½•ä¹‹å¤–çš„åœ°æ–¹åˆ›å»ºé¡¹ç›®æ–‡ä»¶ï¼Œä½¿ç”¨VCS(å¯é€‰) 1234$ mkdir -p /tmp/scratchpad/repo$ cd /tmp/scratchpad/repo$ git init -q$ git remote add origin https://github.com/my/repo åˆå§‹åŒ–module 123$ go mod init github.com/my/repogo: creating new go.mod: module github.com/my/repo demo: 123456789101112$ cat &lt;&lt;EOF &gt; hello.gopackage mainimport ( \"fmt\" \"rsc.io/quote\")func main() { fmt.Println(quote.Hello())}EOF ä¹‹åä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œéƒ½ä¸å†éœ€è¦ä½¿ç”¨go getäº†ï¼Œbuildçš„åŒæ—¶ä¼šè‡ªåŠ¨å°†éœ€è¦çš„åŒ…å¯¼å…¥ï¼š 1234$ go build -o hello$ ./helloHello, world. go.mod: 12345$ cat go.modmodule github.com/my/reporequire rsc.io/quote v1.5.2 3.æ—¥å¸¸ä½¿ç”¨ åœ¨ä½ çš„.goæ–‡ä»¶ä¸­åŠ å…¥éœ€è¦çš„å£°æ˜ ä½¿ç”¨go buildæˆ–è€…go testè‡ªåŠ¨å¯¼å…¥ä¾èµ–ï¼Œgo.modä¹Ÿä¼šè‡ªåŠ¨æ›´æ–° å½“éœ€è¦çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨å¦‚go get foo@v1.1.3, go get foo@masteræ¥é€‰æ‹©åˆé€‚çš„ä¾èµ– Command Usage go list -m all æŸ¥çœ‹ç›´æ¥æˆ–é—´æ¥ä¾èµ–åº“çš„æœ€ç»ˆç‰ˆæœ¬ go list -u -m all æŸ¥çœ‹ç›´æ¥æˆ–é—´æ¥ä¾èµ–åº“çš„å¯ç”¨æ›´æ–°(minorå’Œpatch) go get -u ./â€¦ or go get -u=path ./â€¦ å®‰è£…æ‰€æœ‰ç›´æ¥æˆ–é—´æ¥ä¾èµ–åº“çš„æ›´æ–°(minorå’Œpatch) go build ./â€¦ or go test ./â€¦ buildæˆ–testæ¨¡å—ä¸­çš„æ‰€æœ‰åŒ… go mod tidy ä»go.modä¸­æ¸…é™¤ä¸å†ä½¿ç”¨çš„ä¾èµ– replace or gohack ä½¿ç”¨é€šè¿‡forkã€æœ¬åœ°å¤åˆ¶ã€è§£å‹ç­‰æ–¹æ³•å®‰è£…çš„ go mod vendor Optinal step to create a vendor directory Reference https://github.com/golang/go/wiki/Modules#how-to-install-and-activate-module-support","link":"/2020/03/22/GoModBest-Practice-NotReally/"},{"title":"[Golang] å‡½æ•°","text":"Goè¯­è¨€ä¸­çš„å‡½æ•°ç‰¹æ€§ï¼š å‡½æ•°æœ¬èº«å¯ä»¥ä½œä¸ºå€¼è¿›è¡Œä¼ é€’ æ”¯æŒåŒ¿åå‡½æ•°å’Œé—­åŒ…(closure) å‡½æ•°å¯ä»¥æ»¡è¶³æ¥å£ 1.åˆ©ç”¨å‡½æ•°è¿›è¡Œé“¾å¼å¤„ç†åˆ©ç”¨å‡½æ•°å®ç°å¯¹listä¸­stringç±»å‹çš„â€œå»goâ€ã€â€œå»ç©ºæ ¼â€ã€â€œä¸“ä¸ºå¤§å†™â€ 123456789101112131415161718192021222324252627282930313233343536373839404142package mainimport ( \"fmt\" \"strings\")func StringProcess(list []string, chain []func(string) string) { // list and StringProcess chain for index, str := range list { result := str for _, proc := range chain { result = proc(result) } list[index] = result }}func removePrefix(str string) string { return strings.TrimPrefix(str, \"go\")}func main() { list := []string{ \"go scanner\", \"go parser\", \"go compiler\", \"go printer\", \"go formater\", } chain := []func(string) string{ removePrefix, strings.TrimSpace, strings.ToUpper, } StringProcess(list, chain) for _, str := range list { fmt.Println(str) }} å‡½æ•°StringProcessï¼ˆlist []string, chain []func(string string)ä¸­åˆ†åˆ«å°†stringç±»å‹ä¸å‡½æ•°ç±»å‹ä½œä¸ºå‚æ•°ï¼Œç›¸å¯¹Cè¿™æ˜¯èˆ¹æ–°çš„æ“ä½œã€‚ 2.åŒ¿åå‡½æ•° func(å‚æ•°åˆ—è¡¨) (è¿”å›å‚æ•°åˆ—è¡¨) { body} 2.1 åœ¨å®šä¹‰æ—¶è°ƒç”¨åŒ¿åå‡½æ•°123func(data int) { fmt.Println(data)} (100) 2.2 å°†åŒ¿åå‡½æ•°ç”¨ä½œå›è°ƒå‡½æ•°123456789101112131415package mainimport \"fmt\"func visit(list []int, f func(int2 int)) { for _, v := range list { f(v) }}func main() { visit([]int{1, 2, 3, 4}, func(v int) { fmt.Println(v) })} visit()å‡½æ•°å°†éå†è¿‡ç¨‹å°è£…ï¼Œå½“è¦è·å–éå†æœŸé—´çš„åˆ‡ç‰‡å€¼æ—¶ï¼Œåªéœ€è¦ç»™visit()ä¼ å…¥ä¸€ä¸ªå›è°ƒå‚æ•°å³å¯ã€‚ 2.3ä½¿ç”¨åŒ¿åå‡½æ•°å®ç°å°è£…12345678910111213141516171819202122232425262728package mainimport ( \"flag\" \"fmt\")var skillParam = flag.String(\"skill\", \"\", \"skill to perform\")func main() { flag.Parse() var skill = map[string]func(){ \"fire\": func() { fmt.Println(\"chicken fire\") }, \"run\": func() { fmt.Println(\"solier run\") }, \"fly\": func() { fmt.Println(\"angel fly\") }, } if f, ok := skill[*skillParam]; ok { f() } else { fmt.Println(\"skill not found\") }} è¿™æ®µä»£ç å°†åŒ¿åå‡½æ•°ä½œä¸ºmapçš„valueï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°åŠ¨æ€è°ƒç”¨åŒ¿åå‡½æ•°ã€‚ 2.4å‡½æ•°ä½œä¸ºæ¥å£æ¥ä½¿ç”¨ç»“æ„ä½“å®ç°æ¥å£golangä¸­çš„å…¶ä»–ç±»å‹éƒ½å¯ä»¥å®ç°æ¥å£ï¼Œå‡½æ•°ä¹Ÿå¯ä»¥ï¼Œä¸‹æ–‡å°†åˆ†åˆ«å¯¹æ¯”ç»“æ„ä½“ä¸å‡½æ•°å®ç°æ¥å£çš„è¿‡ç¨‹ä»¥æ¥å£invokerä¸ºä¾‹ï¼š type Invoker interface { Call(interface{})} è¿™ä¸ªæ¥å£éœ€è¦å®ç°Call()æ–¹æ³•ï¼Œè°ƒç”¨æ—¶ä¼šä¼ å…¥ä¸€ä¸ªinterface{}ç±»å‹çš„å˜é‡ï¼Œè¿™ç§ç±»å‹çš„å˜é‡è¡¨ç¤ºä»»æ„ç±»å‹çš„å€¼ã€‚ä»¥ä¸‹ä¸ºç»“æ„ä½“è¿›è¡Œæ¥å£çš„å®ç°ï¼š 1234567891011121314151617181920package mainimport \"fmt\"type Invoker interface { Call(interface{})}type Struct struct{}func (s *Struct) Call(p interface{}) { fmt.Println(\"from struct\", p)}func main() { var invoker Invoker s := new(Struct) s.Call(\"hello\") invoker = s //å°†struct sä¼ å…¥invokerçš„interface invoker.Call(\"hello\")} è¾“å‡ºä¸ºï¼š from struct hellofrom struct hello é‡ç‚¹åœ¨invoker = sä¸­ï¼Œç”±äºsä¸ºStructç±»å‹çš„æŒ‡é’ˆï¼Œä¸”å·²ç»å¯¹åº”å®ç°äº†Call()æ–¹æ³•ï¼Œå³å·²ç»å®ç°äº†Invokeræ¥å£ç±»å‹ï¼Œå½“èµ‹å€¼æ—¶invokeræ¥æ”¶äº†ä¸€ä¸ªç»“æ„ä½“ä½œä¸ºå€¼ã€‚ å‡½æ•°ä½“å®ç°æ¥å£1234567891011121314151617181920212223242526package mainimport \"fmt\"//è°ƒç”¨å™¨æ¥å£type Invoker interface { Call(interface{})}//å‡½æ•°å®šä¹‰ä¸ºç±»å‹type FuncCaller func(interface{})//å®ç°invokerçš„func (f FuncCaller) Call(p interface{}) { f(p)}func main() { var invoker Invoker //å°†åŒ¿åå‡½æ•°è½¬ä¸ºFuncCallerç±»å‹ï¼Œå†èµ‹å€¼ç»™æ¥å£ invoker = FuncCaller(func(v interface{}) { fmt.Println(\"from function\", v) }) invoker.Call(\"hello\")} func (f FuncCaller) Call(p interface{}) {}ä¸­çš„Call()æ–¹æ³•å°†å®ç°Invokerä¸­çš„Call()æ–¹æ³•(è¿˜æœªä¼ é€’)ï¼Œä½†FuncCallerçš„Call()æ–¹æ³•è¢«è°ƒç”¨ä¸func(interface{})æ— å…³ï¼Œè¿˜éœ€è¦é€šè¿‡f(p)æ‰‹åŠ¨è°ƒç”¨å‡½æ•°æœ¬ä½“ã€‚ 123invoker = FuncCaller(func(v interface{}) { fmt.Println(\"from function\", v)}) è¿™æ®µå°†åŒ¿åå‡½æ•°è½¬æ¢ä¸ºFuncCallerç±»å‹(å‡½æ•°ç­¾åæ‰èƒ½è½¬æ¢),æ­¤æ—¶FuncCallerç±»å‹å®ç°äº†INVOKERçš„Call()æ–¹æ³•ï¼Œèµ‹å€¼ç»™invokeræ¥å£æ˜¯æˆåŠŸçš„ã€‚å‡½æ•°ä¸ç»“æ„ä½“å®ç°æ¥å£ä¸åŒï¼š åˆ†åˆ«å°†å‡½æ•°ä¸ç»“æ„ä½“å®šä¹‰ä¸ºç±»å‹type æ¥å£ä¼ å…¥çš„åˆ†åˆ«æ˜¯å‡½æ•°å’Œç»“æ„ä½“ ä¸­é—´éƒ¨åˆ†ä½“ä¼šéœ€è¦åŠ æ·± HTTPåŒ…ä¸­çš„ä¾‹å­HTTPåŒ…ä¸­æœ‰åŒ…å«Handleræ¥å£å®šä¹‰ï¼Œä»£ç å¦‚ä¸‹: 123type Handler interface{ ServeHTTP(ResponseWriter, *Request)} Handlerç”¨äºå®šä¹‰æ¯ä¸ªHTTPçš„è¯·æ±‚å’Œå“åº”çš„å¤„ç†è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨å¤„ç†å‡½æ•°å®ç°æ¥å£ï¼Œå¦‚ä¸‹: 12345type HandlerFunc func(ResponseWriter, *Request)func (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) { f(w, r)} è¦ä½¿ç”¨é—­åŒ…å®ç°é»˜è®¤çš„HTTPè¯·æ±‚å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨http.HandleFunc()å‡½æ•°ï¼Œå‡½æ•°å®šä¹‰ï¼š 123func HandleFunc(pattern string, handler func(ResponseWriter, *Request)) { DefaultServeMux.HandleFunc(Pattern, handler)} è€ŒDefaultServeMuxæ˜¯ServeMuxç»“æ„ï¼Œæ‹¥æœ‰HandleFunc()æ–¹æ³•ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š 123func (mux *ServeMux) HandlerFunc(pattern string, handler func(ResponseWriter, *Request)) { mux.Handle(pattern, HandlerFunc(handler))} ä¸Šé¢ä»£ç å°†å¤–éƒ¨ä¼ å…¥çš„å‡½æ•°handler()è½¬ä¸ºHandlerFuncç±»å‹ï¼ŒHandlerFuncç±»å‹å®ç°äº†Handlerçš„ServeHTTPæ–¹æ³•ï¼Œåº•å±‚å¯ä»¥åŒæ—¶ä½¿ç”¨å„ç§ç±»å‹æ¥å®ç°Handleræ¥å£è¿›è¡Œå¤„ç†ã€‚ 2.5å‡½æ•°é—­åŒ…é—­åŒ…æ˜¯å¼•ç”¨äº†â€œè‡ªç”±å˜é‡â€çš„å‡½æ•°ï¼Œè¢«å¼•ç”¨çš„è‡ªç”±å˜é‡å’Œå‡½æ•°ä¸€åŒå­˜åœ¨ï¼Œå³ä½¿å·²ç»ç¦»å¼€äº†è‡ªç”±å˜é‡çš„ç¯å¢ƒä¹Ÿä¸ä¼šè¢«é‡Šæ”¾æˆ–è€…åˆ é™¤ï¼Œåœ¨é—­åŒ…ä¸­å¯ä»¥ç»§ç»­ä½¿ç”¨è¿™ä¸ªè‡ªç”±å˜é‡ï¼Œç®€å•çš„è¯´ï¼š å‡½æ•°+å¼•ç”¨ç¯å¢ƒ=é—­åŒ… å‡½æ•°æ˜¯ç¼–è¯‘æœŸé™æ€çš„æ¦‚å¿µï¼Œé—­åŒ…æ˜¯è¿è¡ŒæœŸåŠ¨æ€çš„æ¦‚å¿µã€‚ 123456789101112131415161718package mainimport \"fmt\"func char() func(x int32) string { var str string = \"hello, \" return func(x int32) string { str += string(x) return str }}func main() { f := char() fmt.Println(\"1 \", f('a')) fmt.Println(\"2 \", f('b')) fmt.Println(\"3 \", f('c'))} è¿è¡Œç»“æœ: 1 hello, a2 hello, ab3 hello, abc ä¸ªäººç†è§£ï¼Œé—­åŒ…å…¶å®å°±æ˜¯åˆ©ç”¨æ ˆçš„åŸç†ï¼Œé€šè¿‡å®ä¾‹åŒ–å†…éƒ¨å‡½æ•°æ¥ä¿å­˜å±€éƒ¨å˜é‡ã€‚ 2.6 å¯å˜å‚æ•°func function(static variables, v ...T) (r) {} 123456789101112131415161718192021222324252627282930313233package mainimport ( \"bytes\" \"fmt\")func printTypeValue(slist ...interface{}) string { var b bytes.Buffer for _, s := range slist { str := fmt.Sprintf(\"%v\", s) var typeString string switch s.(type) { case bool: typeString = \"bool\" case string: typeString = \"string\" case int: typeString = \"int\" } b.WriteString(\"value: \") b.WriteString(str) b.WriteString(\" type: \") b.WriteString(typeString) b.WriteString(\"\\n\") } return b.String()}func main() { fmt.Println(printTypeValue(100, \"str\", true))} value: 100 type: intvalue: str type: stringvalue: true type: bool","link":"/2020/02/24/Golang%E5%87%BD%E6%95%B0/"},{"title":"[Golang] å®¹å™¨","text":"å½“ç„¶äº†ï¼Œè¿™é‡Œçš„å®¹å™¨ä¸æ˜¯CNIä¹‹ç±»çš„è¿è¡Œå®¹å™¨ï¼Œè€Œæ˜¯æŒ‡Golangä¸­å­˜å‚¨å’Œç»„ç»‡æ•°æ®çš„æ–¹å¼ã€‚ 1.å¹¶å‘å®‰å…¨çš„sync.mapåŠå…¶Range()åœ¨golangä¸­ï¼Œå¸¸ç”¨test := make(map[string]int)çš„å½¢å¼ä½¿ç”¨æ˜ å°„å®¹å™¨mapï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å£°æ˜æ—¶å¡«å……å†…å®¹ï¼š 12345m := map[string]int{ \"w\": 1, \"s\": 2, \"a\": 3, } æ¸…ç©ºmapçš„å”¯ä¸€æ–¹æ³•ï¼šé‡æ–°makeä¸€ä¸ªæ–°çš„mapã€‚ä½†å¹¶å‘çš„mapè¯»å†™ä¸­ä¼šå‡ºç°ç«æ€é—®é¢˜ï¼Œç”±syncåŒ…æä¾›å¹¶å‘å®‰å…¨çš„mapç»“æ„ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920package mainimport ( \"fmt\" \"sync\")func main() { var scene sync.Map scene.Store(\"greece\", 97) scene.Store(\"london\", 100) scene.Store(\"egypt\", 200) fmt.Println(scene.Load(\"london\")) scene.Delete(\"london\") scene.Range(func(k, v interface{}) bool { fmt.Println(\"iterate:\", k, v) return true })} ä»£ç è¾“å‡ºå¦‚ä¸‹ï¼š 100 trueiterate: egypt 200iterate: greece 97 åœ¨sync.Mapä¸­ï¼ŒStoreè¡¨ç¤ºå­˜å‚¨ï¼ŒLoadè¡¨ç¤ºè·å–ï¼ŒDeleteè¡¨ç¤ºåˆ é™¤ã€‚æ¯”è¾ƒæœ‰è¶£çš„æ˜¯Rangeçš„ä½¿ç”¨ï¼ŒRangeé…åˆä¸€ä¸ªå›è°ƒå‡½æ•°è¿›è¡Œéå†æ“ä½œï¼Œé€šè¿‡å›è°ƒå‡½æ•°è¿”å›å†…éƒ¨ä¾¿åˆ©å‡ºæ¥çš„å€¼ã€‚Rangeå‚æ•°æ¥æ”¶åˆ°trueæ—¶ï¼Œç»§ç»­è¿­ä»£éå†ï¼Œè¿”å›falseæ—¶ï¼Œç»ˆæ­¢è¿­ä»£éå†ã€‚Range()æ–¹æ³•å¯ä»¥éå†sync.Mapï¼Œéå†éœ€è¦æä¾›ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå‚æ•°ä¸ºkã€vï¼Œç±»å‹ä¸ºinterface{}ï¼Œæ¯æ¬¡Range()åœ¨éå†ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨è¿™ä¸ªåŒ¿åå‡½æ•°æŠŠç»“æœè¿”å›ã€‚å½“ç„¶ï¼Œsync.Mapä¸ºäº†ä¿è¯å¹¶å‘å®‰å…¨æœ‰ä¸€äº›æ€§èƒ½æŸå¤±ï¼Œå› æ­¤åœ¨éå¹¶å‘æƒ…å†µä¸‹ï¼Œä½¿ç”¨mapç›¸æ¯”ä½¿ç”¨sync.Mapä¼šæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚","link":"/2020/02/25/Golang%E5%AE%B9%E5%99%A8/"},{"title":"[NOTE] Hugo + Github Pagesä¸ªäººåšå®¢æ­å»º","text":"å›é¡¾ä¹‹å‰çš„å­¦ä¹ ç»å†ï¼Œå­¦ä¹ çš„çŸ¥è¯†ä¸æŠ€æœ¯éƒ½ä¸å¤Ÿé€å½»ï¼Œè§£å†³è¿‡çš„é—®é¢˜å†ä¸€æ¬¡å‡ºç°æ—¶å¾€å¾€åˆä¼šéš¾å€’æˆ‘ï¼Œä¹Ÿæ­£é€¢ä¸€ä¸ªæ–°çš„é˜¶æ®µï¼Œäºæ˜¯ä¾¿å†³å®šæ­å»ºä¸€ä¸ªä¸ªäººåšå®¢ï¼Œå¯¹çŸ¥è¯†è¿›è¡Œå½’ç±»ï¼Œæ·±åŒ–çŸ¥è¯†è„‰ç»œã€‚ Goç¯å¢ƒé…ç½®å®‰è£…åŒ…æ˜¯ä»Golangå®˜ç½‘( https://golang.org )ä¸Šä¸‹è½½çš„go1.12.6.windows-and64.msiå®‰è£…åŒ…ï¼Œå®‰è£…æ¯”è¾ƒå‚»ç“œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æœ‰å…³goçš„å‡ ä¸ªç¯å¢ƒå˜é‡ï¼š GOROOTä¸ºgoæ‰€å®‰è£…çš„å…·ä½“ä½ç½®ï¼Œå°†ä¹‹æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ï¼Œwindowsç³»ç»Ÿè¿˜éœ€è¦åœ¨pathä¸­æ–°å¢$GOROOT/bin GOPATHå¯ä»¥ç†è§£ä¸ºå·¥ä½œç›®å½•ï¼Œé»˜è®¤ä¸º$USERNAME/goä¸­ï¼Œæˆ‘å°†ä¹‹è°ƒæ•´åˆ°äº†D://go_workä¸­ï¼Œå¤‡å¿˜ GOPATHç›®å½•ä¸‹æŒ‰ç…§çº¦å®šï¼Œå°† binæ–‡ä»¶å¤¹ç”¨ä½œå­˜æ”¾golangç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶ pkgç”¨ä½œå­˜æ”¾golangç¼–è¯‘æ—¶äº§ç”Ÿçš„.aæ–‡ä»¶ srcç”¨ä½œå­˜æ”¾é¡¹ç›®çš„æºç ï¼ŒåŒæ—¶ï¼Œgo runä¸go installç­‰å‘½ä»¤ä¹Ÿåœ¨è¯¥ç›®å½•ä¸­æ‰§è¡Œ å®‰è£…golangçš„ç›®çš„æœ¬æ¥æ˜¯ä¸ºäº†ç›´æ¥ç¼–è¯‘hugoçš„æºç ï¼Œä½†é‡åˆ°å‡ ä¸ªé—®é¢˜ï¼Œgit clone https://github.com/gohugoio/hugo.gité€Ÿåº¦å¥‡æ…¢ï¼Œä½¿ç”¨å¤šä¸ªæ–¹æ³•éƒ½æ²¡èƒ½è§£å†³ ï¼Œå¥½ä¸å®¹æ˜“å°†æ•´ä¸ªæºç ä¸‹å¥½ä¹‹åï¼Œä½¿ç”¨go installå‘½ä»¤ç¼–è¯‘å®‰è£…hugoæ—¶ï¼Œåˆä¸€æ¬¡è¢«ç½‘ç»œç¯å¢ƒç»™æ”¯é…äº†ï¼Œé…¸é…¸ä¹³çš„æ²¡ç”¨ã€‚ æ— å¥ˆï¼Œåªå¥½ä¸‹è½½é€‚é…çš„zipåŒ…è§£å‹å®‰è£…ã€‚ hugoå®‰è£…æ¥å‰è¨€ï¼Œ step by step è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•åï¼Œå°†./hugo/binæ·»åŠ åˆ°pathä¸­ï¼Œæ­¤æ—¶hugoç›®å½•ä¸­åŒ…æ‹¬binã€resourceã€sitesä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œæ²¡æœ‰å°±è¡¥ä¸Š hugo new site test-pagesï¼Œä¼šå‡ºç°ç¬¬å››ä¸ªæ–‡ä»¶å¤¹test-pages æ­¤æ—¶è¿˜æ˜¯ä¸€å¼ ç™½çº¸ï¼Œæ—¢ç„¶è¦å¿«é€Ÿéƒ¨ç½²ï¼Œå°±ç›´æ¥åœ¨https://themes.gohugo.ioå¯»æ‰¾è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ åœ¨test-pages/themesç›®å½•ä¸‹cloneå¯¹åº”ä¸»é¢˜ï¼Œç…§æŠ„hugo/test-pages/themes/xxxxx/ä¸‹çš„é…ç½®æ–‡ä»¶config.tomlï¼Œé¡ºä¾¿è§£é‡Šä¸‹hogo/test_pagesç›®å½•ä¸‹çš„å‡ ä¸ªæ–‡ä»¶å¤¹çš„ä½œç”¨ config.tomlä¸ºç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œconfig.yaml``config.jsonä¹Ÿæ˜¯æ”¯æŒçš„ ./content/postå­˜æ”¾ä½ å†™çš„mdæ–‡ä»¶ï¼Œcontentæ–‡ä»¶å¤¹ä¸­ä¼šç”Ÿæˆä¸€ä¸ªabout.mdæ–‡ä»¶ï¼Œå¦‚ä¸‹ 123456789---title: About Hugo // æ ‡é¢˜date: 2014-04-09 // åˆ›å»ºæ—¥æœŸauthorbox: false // sidebar: falsemenu: main // é¡µé¢æ˜¯å¦åŠ å…¥åˆ°ä¾§è¾¹æ cover: // å°é¢å›¾åœ°å€tags:[\"Hugo\"] // æ ‡ç­¾--- ./archetypes/default.mdå¯ä»¥é¢„è®¾æ–‡ç« çš„æ¨¡æ¿ï¼Œåœ¨æ–°å»ºçš„æ–‡ç« ä¸­ä¼šç”Ÿæ•ˆ ./dataç›®å½•å­˜æ”¾æ•°æ® ./layoutså­˜æ”¾ç½‘ç«™æ¨¡æ¿ ./staticç›®å½•å­˜æ”¾å›¾ç‰‡ï¼Œæœ€å¥½å·²æ–‡ç« ååˆ†åˆ«å­˜æ”¾å›¾ç‰‡ï¼Œæ–¹ä¾¿ç®¡ç† å°†themesä¸­ä¸»é¢˜çš„contentæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹æ”¾è‡³./hugo/content/ä¸­ï¼Œä½¿ç”¨hugo serverè¿›è¡Œé¢„è§ˆï¼Œåœ¨http://localhost:1313/ä¸­è¿›è¡ŒæŸ¥çœ‹ Github Pageséƒ¨ç½²step by step new repository fusidic.github.io ä½¿ç”¨hugo -t mainroad(æ„å‘³ç€ä½¿ç”¨ä¸»é¢˜mainroadå¯¹mdæ–‡ä»¶è¿›è¡Œæ‰“åŒ…åˆ°publicæ–‡ä»¶å¤¹ä¸­)ï¼Œå†å°†hugo/test_pages/publicä¸­çš„å†…å®¹ä¸Šä¼  https://fusidic.github.io ä¸Šä¼ æ—¶é‡åˆ°äº†ä¸€ä¸ª404çš„bugï¼Œæç¤ºæ²¡æœ‰index.htmlï¼Œå¯ä»¥ç­‰10~60åˆ†é’Ÿï¼Œæˆ–åœ¨ç½‘å€ååŠ ä¸ª?å¯ä»¥è§£å†³ ä½¿ç”¨hugoæ–°å¢åœ¨test_pagesç›®å½•ä¸‹ï¼Œä½¿ç”¨hugo new post/xxxx.mdæ–°å¢ä¸€ä¸ªæ–‡æœ¬åˆ°content/postä¸­ï¼Œmdçš„æ–‡ä»¶é¦–éƒ¨æ˜¯å…³äº å¿«é€Ÿéƒ¨ç½²1234567891011121314151617181920212223242526272829303132#!/bin/bash# éƒ¨ç½²åˆ° github pages è„šæœ¬# é”™è¯¯æ—¶ç»ˆæ­¢è„šæœ¬set -e# åˆ é™¤æ‰“åŒ…æ–‡ä»¶å¤¹rm -rf public# æ‰“åŒ…ã€‚even æ˜¯ä¸»é¢˜hugo -t even # if using a theme, replace with `hugo -t &lt;YOURTHEME&gt;`# è¿›å…¥æ‰“åŒ…æ–‡ä»¶å¤¹cd public# Add changes to git.git initgit add -A# Commit changes.msg=\"building site `date`\"if [ $# -eq 1 ] then msg=\"$1\"figit commit -m \"$msg\"# æ¨é€åˆ°github # nusr.github.io åªèƒ½ä½¿ç”¨ masteråˆ†æ”¯git push -f git@github.com:nusr/nusr.github.io.git master# å›åˆ°åŸæ–‡ä»¶å¤¹cd .. é‡åˆ°çš„ä¸€äº›é—®é¢˜ é¦–å…ˆé‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œæ–‡ç« çš„summarizeå› ä¸ºæ²¡æœ‰äº†å¯Œæ–‡æœ¬çš„æ¸²æŸ“ï¼Œåœ¨é¦–é¡µæ˜¾å¾—ååˆ†ä¸‘ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­è¯´å¾—ååˆ†è¯¦ç»†ï¼Œå¥ˆä½•æ²¡æœ‰ç›¸å…³çš„å¤„ç†ç»éªŒæ ¹æœ¬ä¸çŸ¥é“åœ¨è®²ä»€ä¹ˆï¼Œå‚ç…§è¿™ç¯‡åšå®¢ç»ˆäºæœ‰äº†å¤§è‡´çš„äº†è§£ï¼Œåœ¨å®˜æ–¹è®ºå›çš„è¿™ç¯‡å¸–å­ä¸ŠåŒæ ·æœ‰äººé‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ï¼Œè¯„è®ºç»™å‡ºçš„å‡ ä¸ªè§£å†³çš„æ–¹å‘ä¹‹åå†ç ”ç©¶å§â€¦ é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œä¸­æ–‡ç¯å¢ƒä¸‹åœ¨config.tomlä¸­æ·»åŠ hasCJKLanguage = tureå¯ä»¥ä½¿summarizeå‘æŒ¥æ›´å¥½çš„æ•ˆæœï¼Œä½¿ç”¨&lt;!--more--&gt;å¯ä»¥è‡ªå®šä¹‰summarizeçš„æˆªæ­¢ã€‚ åæ€ä¹‹å‰çš„å­¦ä¹ ï¼Œå¯¹ä¸€äº›æŠ€æœ¯å’ŒçŸ¥è¯†çš„æŒæ¡å§‹ç»ˆä¸å½»åº•ï¼Œå·²ç»åšè¿‡çš„ä¸€äº›ä¸œè¥¿ç»å¸¸ä¼šéšæ—¶é—´é—å¿˜ã€‚ç°ä»Šä¹Ÿç®—æ˜¯å¤„åœ¨ä¸€ä¸ªæ–°çš„é˜¶æ®µï¼Œæœ‰äº›ä¸œè¥¿ä¸èƒ½å†å¾—è¿‡ä¸”è¿‡ï¼Œäºæ˜¯ä¾¿èŒç”Ÿäº†å†™åšå®¢çš„æƒ³æ³•ã€‚","link":"/2019/07/03/Hugo-GithubPages%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"},{"title":"[NOTE] æ„å»ºHTTPS","text":"@houè¯´äº†è®¸ä¹…ï¼Œåˆšå¥½ä¸Šæ¬¡ç”³è¯·çš„è¯ä¹¦å¿«è¿‡æœŸäº†ï¼Œè¿™æ¬¡æŠŠæ³›åŸŸåå¼€å¯HTTPSçš„ä¸€äº›æµç¨‹åŠæ³¨æ„äº‹é¡¹è®°å½•ä¸€ä¸‹ã€‚ ç›¸å…³ä¿¡æ¯ certbot 0.39.0 python 2.7 CentOS 7 urllib3 requests 2.6 1.ä½¿ç”¨certbotç”³è¯·è¯ä¹¦Certbotåˆ©ç”¨Letâ€™s encryptè‡ªåŠ¨ç”³è¯·è¯ä¹¦ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨æ›´æ–°è¯ä¹¦ã€‚ å®‰è£…Certbotç­¾ç½²é€šé…ç¬¦è¯ä¹¦éœ€è¦Certbot 0.22ä»¥ä¸Šã€‚å¦‚æœä»¥å‰å®‰è£…è¿‡certbotï¼Œä¸€èˆ¬æ˜¯ç›´æ¥yum updateå³å¯ã€‚å¦‚æœæ˜¯å…¨æ–°å®‰è£…ï¼Œåˆ™å¦‚ä¸‹ï¼šå…ˆå‡çº§ï¼š 1yum update -y æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼š 1cat /etc/centos-release CentOS Linux release 7.4.1708 (Core) å®‰è£…epelæºï¼š 1yum install epel-release -y å®‰è£…certbotï¼š 1yum install certbot -y æŸ¥çœ‹certbotç‰ˆæœ¬ï¼š 1certbot --version certbot 0.39.0 æ³¨æ„ï¼šä½¿ç”¨certbotå¯èƒ½ä¼šé‡åˆ°urllibåº“æ— æ³•è°ƒç”¨çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š 1234567pip uninstall urllib3pip uninstall requestspip uninstall chardetyum remove python-requestsyum remove python-urllib3pip install --upgrade --force-reinstall 'requests==2.6.0' urllib3yum install certbot ç”³è¯·è¯ä¹¦nuzar.topä¸*.nuzar.topæ¢æˆè‡ªå·±çš„åŸŸåï¼š 1certbot -d nuzar.top -d *.nuzar.top --manual --preferred-challenges dns-01 --server https://acme-v02.api.letsencrypt.org/directory certonly --agree-tos è¾“å…¥åº”æ€¥é‚®ç®±ï¼Œè¯ä¹¦åˆ°æœŸå‰ä¼šæœ‰é‚®ä»¶æç¤ºï¼š 12Enter email address (used for urgent renewal and security notices) (Enter 'c' tocancel): å¦‚æœæƒ³è·³è¿‡è¾“å…¥é‚®ç®±çš„æ­¥éª¤ï¼Œå¯åœ¨ç”³è¯·å‘½ä»¤åé¢åŠ ä¸Šï¼š 1--register-unsafely-without-email ä¹‹åå‡ºç°å¦‚ä¸‹æç¤ºï¼šè¦å…¬å¼€è®°å½•ç”³è¯·è¯¥è¯ä¹¦çš„IPåœ°å€ï¼Œæ˜¯å¦åŒæ„ï¼Ÿä¸åŒæ„å°±æ— æ³•ç»§ç»­ã€‚ 12345678-------------------------------------------------------------------------------NOTE: The IP of this machine will be publicly logged as having requested thiscertificate. If you're running certbot in manual mode on a machine that is notyour server, please ensure you're okay with that.Are you OK with your IP being logged?-------------------------------------------------------------------------------(Y)es/(N)o: y åŒæ„ä¹‹åï¼Œå‡ºç°å¦‚ä¸‹æç¤ºï¼Œç¬¬ä¸€ä¸ªâ€œPress Enter to Continueâ€å¤„ç›´æ¥å›è½¦ï¼Œç¬¬äºŒä¸ªâ€œPress Enter to Continueâ€ä¸è¦æŒ‰å›è½¦ï¼š 12345678910111213141516171819-------------------------------------------------------------------------------Please deploy a DNS TXT record under the name_acme-challenge.co1dawn.com with the following value:iLS0NjcdP3RR1KphB6xbbVnKS_NS2uMW-xdDRzz85OMBefore continuing, verify the record is deployed.-------------------------------------------------------------------------------Press Enter to Continue #æ­¤å¤„ç›´æ¥å›è½¦-------------------------------------------------------------------------------Please deploy a DNS TXT record under the name_acme-challenge.nuzar.top with the following value:f3V7aw5GPm5yzNsJFanQQaUFMyVQcqriUe3UjIDUHn0Before continuing, verify the record is deployed.-------------------------------------------------------------------------------Press Enter to Continue #æ­¤å¤„ä¸è¦æŒ‰å›è½¦ éªŒè¯æœåŠ¡å™¨æ¥ä¸Šæ­¥ä¸­ï¼Œéœ€è¦åœ¨åŸŸåè§£æä¸­æ·»åŠ TXTè§£æï¼Œ_acme-challenge.nuzar.topï¼Œè®°å½•å€¼ä¸ºå…¶æç¤ºçš„valueï¼Œå°†å…¶æ·»åŠ æˆåŠŸåï¼Œè¿˜éœ€è¦ç­‰å¾…ä¸€å®šæ—¶é—´ä½¿è§£ææˆåŠŸã€‚ éªŒè¯æ–¹æ³•åŒ…æ‹¬ï¼š 1host -t txt _acme-challenge.nuzar.top æˆ–ï¼š 1dig -t txt _acme-challenge.nuzar.top @8.8.8.8 éªŒè¯æˆåŠŸåï¼Œä¾¿å¯ä»¥å›è½¦äº†ï¼Œä¹‹åä¼šåœ¨ç›®å½•/etc/letsencrypt/live/nuzar.top/ä¸­ç”Ÿæˆè¯ä¹¦ã€‚ æ£€æŸ¥åŸŸåæ˜¯å¦ä¸ºæ³›åŸŸåï¼š 1openssl x509 -in /etc/letsencrypt/live/nuzar.top/fullchain.pem -noout -text 2.Nginxä½¿ç”¨è¯ä¹¦è¯ä¹¦å­˜æ”¾å¦‚æœåœ¨äºŒçº§åŸŸåçš„é…ç½®ä¸­ï¼Œä½ ä¹Ÿæ˜¯å‚ç…§æˆ‘çš„æ–‡ç« ï¼Œé‚£ä¹ˆæ­¤æ—¶åªéœ€è¦å°†è¯ä¹¦åŠ åˆ°å¯¹åº”æ–‡ä»¶å¤¹root/nginx/conf.crtä¸­ã€‚ ç”±äºcertbotå¯ä»¥è‡ªåŠ¨æ›´æ–°è¯ä¹¦ï¼Œä¸ç®¡æ˜¯ä»ä»»ä½•è§’åº¦ï¼Œæ­¤æ—¶éƒ½åº”è¯¥ä¿æŒè¯ä¹¦æ‰€åœ¨ä½ç½®ä¸å˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†/etc/letsencrypt/æ˜ å°„åˆ°{pwd}/nginx/conf.crtä¸‹ï¼Œè®©nginxå®¹å™¨ç›´æ¥è¯»å–åˆ°è¯ä¹¦æ–‡ä»¶ã€‚ è¿™æ ·ä¸€æ¥ï¼Œå½“90å¤©æœŸé™åˆ°æœŸæ—¶ï¼Œè¯ä¹¦å¯ä»¥ç›´æ¥æ›´æ–°ï¼Œè€Œä¸éœ€è¦å†è¿›è¡Œä¸€äº›é¢å¤–çš„æ“ä½œã€‚ å¦‚æˆ‘çš„æ–‡ä»¶ç»“æ„: 12345678910111213141516|-- conf.crt| |-- accounts| |-- archive| |-- keys| |-- live| | |-- nuzar.top| | | |-- cert1.pem| | | |-- chain1.pem| | | |-- fullchain1.pem| | | `-- privkey1.pem|-- conf.d| `-- default.conf|-- html| `-- index.html|-- nginx`-- nginx.conf è¿™é‡Œæ”¾åœ¨å“ªå…¶å®æ²¡æœ‰å¤ªå¤§å…³ç³»ï¼Œæ¥ä¸‹æ¥åœ¨conf.d/default.confä¸­åŠ å…¥å¯¹443ç«¯å£çš„ç›‘å¬ï¼Œå¹¶ä¸”æŒ‡æ˜è¯ä¹¦çš„ä½ç½®(æ³¨æ„æˆ‘ä»¬çš„nginxæ˜¯å®¹å™¨ç¯å¢ƒï¼Œåœ¨å­˜æ”¾è¯ä¹¦æ—¶è¦æ³¨æ„æ˜¯å¦æ”¾åœ¨äº†æŒ‚è½½å·çš„ç›®å½•ä¸‹) HTTPSå¼€å¯æ¥ä¸‹æ¥ï¼Œå°±è¦ä¿®æ”¹Nginxçš„é…ç½®æ–‡ä»¶ï¼š sudo vim /root/nginx/conf.d/default.conf 1234567891011121314151617181920212223242526server { listen 443; listen [::]:443; server_name gitlab.nuzar.top; # enable ssl ssl on; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; ssl_ciphers \"EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH EDH+aRSA !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS !RC4\"; # config ssl certificate ssl_certificate conf.crt/live/nuzar.top/fullchain.pem; ssl_certificate_key conf.crt/live/nuzar.top/privkey.pem; location ^~ /.well-known/acme-challenge/ { default_type \"text/plain\"; root /usr/share/nginx/html; } location = /.well-known/acme-challenge/ { return 404; } location / { proxy_pass http://127.0.0.1:6080; }} æ­¤æ®µé…ç½®çš„å«ä¹‰ï¼š listenï¼šä½¿Nginxç›‘å¬443ç«¯å£ï¼Œå³httpsé»˜è®¤çš„ç«¯å£ï¼› server_nameï¼šæ¥å—gitlab.nuzar.topçš„è¯·æ±‚ï¼›(æ­¤æ­¥éª¤éœ€è¦æ·»åŠ åŸŸåè§£ægitlabåˆ°ä¸»æœºåœ°å€ï¼Œå‰æ–‡ä¸­æœ‰æåˆ°) ssl_certificateï¼šæŒ‡å®šè¯ä¹¦åœ°å€ï¼Œæ³¨æ„è·¯å¾„ proxy_passï¼šå°†è¯·æ±‚è½¬å‘åˆ°http://127.0.0.1:6080 å®Œæˆæ­¤æ­¥åï¼Œç”±äºå‰æ–‡æåˆ°ï¼Œå®¹å™¨çš„æ˜ å°„ä¸ä¹‹å‰æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦å°†å®¹å™¨åˆ é™¤ docker rm -f CONTAINER_IDï¼Œå¹¶é‡æ–°è¿è¡Œä¸€ä¸ªæ–°çš„å®¹å™¨ 12345678docker run -d -p 80:80 -p 443:443 \\-v $(pwd)/nginx/conf.d:/etc/nginx/conf.d:ro \\-v /etc/letsencrypt:/etc/nginx/conf.crt:ro \\-v $(pwd)/nginx/nginx.conf:/etc/nginx/nginx.conf:ro \\-v $(pwd)/logs/nginx:/var/log/nginx \\-v $(pwd)/nginx/html:/usr/share/nginx/html \\--restart=always --name=gateway --network=host \\nginx 3.è¯ä¹¦è‡ªåŠ¨æ›´æ–°Letâ€™s Encrypt çš„ HTTPS è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰90å¤©ï¼Œéœ€è¦åœ¨å³å°†åˆ°æœŸæ—¶æ‰‹åŠ¨æ›´æ–°ï¼Œè¿™é‡Œå€ŸåŠ© Systemd.timer ä»¥åŠ Certbot è‡ªåŠ¨åˆ›å»ºçš„ Systemd æœåŠ¡è¿›è¡Œè‡ªåŠ¨æ›´æ–°ï¼ˆrenew or renewalï¼‰ æŸ¥çœ‹ certbot è‡ªåŠ¨æ›´æ–°æ˜¯å¦å¯ç”¨ 1$ systemctl is-enabled certbot-renew.timer enabled å¯ç”¨ certbot è‡ªåŠ¨æ›´æ–° 1$ systemctl enable certbot-renew.timer æŸ¥çœ‹ certbot è‡ªåŠ¨æ›´æ–°æ˜¯å¦è¿è¡Œ 1$ systemctl list-timers å¯åŠ¨ certbot è‡ªåŠ¨æ›´æ–° 1$ systemctl start certbot-renew åˆ©ç”¨è„šæœ¬è‡ªåŠ¨åŒæ­¥è¯ä¹¦åˆ°Nginxçš„ /nginx/conf.crtè·¯å¾„ä¸‹ å¾…å®Œæˆï¼Œå¯ä»¥æ‰‹åŠ¨å“¦ 4. æ›´æ–° 2020/03/31 updateï¼š ä¸Šè¿°æ— æ³•ç”Ÿæ•ˆçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨æ‰‹åŠ¨æ›´æ–°ï¼šcertbot renewï¼Œä¼šåœ¨/etc/letsencrypt/archieveä¸‹ç”Ÿæˆæ–°çš„è¯ä¹¦ï¼ˆåŸè¯ä¹¦ä¾ç„¶åœ¨ï¼‰ï¼ŒåŒæ—¶/etc/letsencrypt/liveä¸‹æœ‰æ´»è·ƒè¯ä¹¦ï¼Œè½¯é“¾æ¥æŒ‡å‘å‰è€…ã€‚ å¦‚æœåœ¨æ›´æ–°ä¸­é‡åˆ°æŠ¥é”™çš„é—®é¢˜ï¼š 123456789101112131415161718192021222324252627certbot --nginx certonlyTraceback (most recent call last): File \"/usr/bin/certbot\", line 9, in &lt;module&gt; load_entry_point('certbot==0.24.0', 'console_scripts', 'certbot')() File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 378, in load_entry_point return get_distribution(dist).load_entry_point(group, name) File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 2566, in load_entry_point return ep.load() File \"/usr/lib/python2.7/site-packages/pkg_resources.py\", line 2260, in load entry = __import__(self.module_name, globals(),globals(), ['__name__']) File \"/usr/lib/python2.7/site-packages/certbot/main.py\", line 17, in &lt;module&gt; from certbot import account File \"/usr/lib/python2.7/site-packages/certbot/account.py\", line 17, in &lt;module&gt; from acme import messages File \"/usr/lib/python2.7/site-packages/acme/messages.py\", line 7, in &lt;module&gt; from acme import challenges File \"/usr/lib/python2.7/site-packages/acme/challenges.py\", line 11, in &lt;module&gt; import requests File \"/usr/lib/python2.7/site-packages/requests/__init__.py\", line 58, in &lt;module&gt; from . import utils File \"/usr/lib/python2.7/site-packages/requests/utils.py\", line 32, in &lt;module&gt; from .exceptions import InvalidURL File \"/usr/lib/python2.7/site-packages/requests/exceptions.py\", line 10, in &lt;module&gt; from .packages.urllib3.exceptions import HTTPError as BaseHTTPError File \"/usr/lib/python2.7/site-packages/requests/packages/__init__.py\", line 95, in load_module raise ImportError(\"No module named '%s'\" % (name,))ImportError: No module named 'requests.packages.urllib3' è¿™æ˜¯ç”±äºç³»ç»Ÿæ›´æ–°æ—¶ï¼Œä¼šå°†request urllibç­‰åº“æ›´æ–°ï¼Œå¯¼è‡´certbotè„šæœ¬ä¸å¯ç”¨ï¼Œé‡æ–°å›é€€å¯è§£ï¼š 1pip2.7 install --upgrade --force-reinstall 'requests==2.6.0' urllib3 å¬è¯´ä½ æƒ³è¯·æˆ‘å–æ¯å¥¶èŒ¶ğŸ˜Šï¼Ÿ","link":"/2019/11/22/HTTPS/"},{"title":"[NOTE] Kaggle house price prediction","text":"AbstractsThis is a copycat of Comprehensive data explorationi with Python. Since I had limited time to accomplish AI project. So I preferred learn from otherâ€™s notebook. And â€˜Comprehensive data explorationi with Pythonâ€™ is apparently the most fit one for me. According to the article, the first thing we should do is look through the whole data set, and find the most important variables which matters when you buy a house. And then an important problem we must deal with is Data Cleaning. OverviewsWhile â€˜Typeâ€™ and â€˜Segmentâ€™ is just for possible future reference, the column â€˜Expectationâ€™ is important because it will help us develop a â€˜sixth senseâ€™. To fill this column, we should read the description of all the variables and, one by one, ask ourselves: Do we think about this variable when we are buying a house? (e.g. When we think about the house of our dreams, do we care about its â€˜Masonry veneer typeâ€™?). If so, how important would this variable be? (e.g. What is the impact of having â€˜Excellentâ€™ material on the exterior instead of â€˜Poorâ€™? And of having â€˜Excellentâ€™ instead of â€˜Goodâ€™?). Is this information already described in any other variable? (e.g. If â€˜LandContourâ€™ gives the flatness of the property, do we really need to know the â€˜LandSlopeâ€™?). I went through this process and concluded that the following variables can play an important role in this problem: OverallQual æ€»ä½“è´¨é‡ YearBuilt. TotalBsmtSF. åœ°ä¸‹å®¤é¢ç§¯ GrLivArea. åœ°ä¸Šå±…ä½é¢ç§¯ Hmmmâ€¦ It seems that â€˜SalePriceâ€™ and â€˜GrLivAreaâ€™ are really old friends, with a *linear relationship.*** In my opinion, this heatmap is the best way to get a quick overview of our â€˜plasma soupâ€™ and its relationships. (Thank you @seaborn!) TotalBsmtSF and 1stFlrSF GarageX According to our crystal ball, these are the variables most correlated with â€˜SalePriceâ€™. My thoughts on this: â€˜OverallQualâ€™, â€˜GrLivAreaâ€™ and â€˜TotalBsmtSFâ€™ are strongly correlated with â€˜SalePriceâ€™. Check! â€˜GarageCarsâ€™ and â€˜GarageAreaâ€™ are also some of the most strongly correlated variables. However, as we discussed in the last sub-point, the number of cars that fit into the garage is a consequence of the garage area. â€˜GarageCarsâ€™ and â€˜GarageAreaâ€™ are like twin brothers. Youâ€™ll never be able to distinguish them. Therefore, we just need one of these variables in our analysis (we can keep â€˜GarageCarsâ€™ since its correlation with â€˜SalePriceâ€™ is higher). â€˜TotalBsmtSFâ€™ and â€˜1stFloorâ€™ also seem to be twin brothers. We can keep â€˜TotalBsmtSFâ€™ just to say that our first guess was right (re-read â€˜Soâ€¦ What can we expect?â€™). â€˜FullBathâ€™?? Really? â€˜TotRmsAbvGrdâ€™ and â€˜GrLivAreaâ€™, twin brothers again. Is this dataset from Chernobyl? Ahâ€¦ â€˜YearBuiltâ€™â€¦ It seems that â€˜YearBuiltâ€™ is slightly correlated with â€˜SalePriceâ€™. Honestly, it scares me to think about â€˜YearBuiltâ€™ because I start feeling that we should do a little bit of time-series analysis to get this right. Iâ€™ll leave this as a homework for you. Letâ€™s proceed to the scatter plots. Missing dataMissing data analysisUsing script below, we can easily get the missing data. 12345#missing datatotal = df_train.isnull().sum().sort_values(ascending=False)percent = (df_train.isnull().sum()/df_train.isnull().count()).sort_values(ascending=False)missing_data = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])print(missing_data.head(20)) Total Percent PoolQC 1453 0.995205 MiscFeature 1406 0.963014 Alley 1369 0.937671 Fence 1179 0.807534 FireplaceQu 690 0.472603 LotFrontage 259 0.177397 GarageCond 81 0.055479 GarageType 81 0.055479 GarageYrBlt 81 0.055479 GarageFinish 81 0.055479 GarageQual 81 0.055479 BsmtExposure 38 0.026027 BsmtFinType2 38 0.026027 BsmtFinType1 37 0.025342 BsmtCond 37 0.025342 BsmtQual 37 0.025342 MasVnrArea 8 0.005479 MasVnrType 8 0.005479 Electrical 1 0.000685 Utilities 0 0.000000 So how to handle the missing data? Weâ€™ll consider that when more than 15% of the data is missing, we should delete the corresponding variable and pretend it never existed. So we delete â€˜PoolQCâ€™, â€˜MiscFeatureâ€™, â€˜Alleyâ€™, â€˜Fenceâ€™, â€˜FireplaceQuâ€™ and â€˜LotFrontageâ€™. As for â€˜GarageXâ€™, they all have the same number of missing data. Maybe the missing data refers to the same set of observations. Since the most important information regarding garages is expressed by â€˜GarageCarsâ€™ and considering that we are just talking about 5% of missing data, Iâ€™ll delete the mentioned â€˜GarageXâ€˜ variables. The same logic applies to â€˜BsmtXâ€˜ variables. As for â€˜MasVnrAreaâ€™(ç –çŸ³é¥°é¢é¢ç§¯) and â€˜MasVnrTypeâ€™(ç –çŸ³é¥°é¢ç§ç±»), we can consider that these variables have a strong correlation with â€˜YearBuiltâ€™ and â€˜OverallQualâ€™ which are already considered. So we delete â€˜MasVnrAreaâ€™ and â€˜MasVnrTypeâ€™. Delete missing variablesWeâ€™ll delete all the variables with missing data, except the variable â€˜Electricalâ€™. In â€˜Electricalâ€™ weâ€™ll just delete the observation with missing data. 1234#dealing with missing datadf_train = df_train.drop((missing_data[missing_data['Total'] &gt; 1]).index,1)df_train = df_train.drop(df_train.loc[df_train['Electrical'].isnull()].index)df_train.isnull().sum().max() #just checking that there's no missing data missing... If the output is â€˜0â€™, it means you have fully delete missing data. Out liarsThe primary concern here is to establish a threshold that defines an observation as an outlier. To do so, weâ€™ll standardize the data. In this context, data standardization means converting data values to have mean of 0 and a standard deviation of 1. 1è¿™é‡Œä¸»è¦å…³æ³¨çš„æ˜¯å»ºç«‹ä¸€ä¸ªå°†è§‚å¯Ÿå€¼å®šä¹‰ä¸ºå¼‚å¸¸å€¼çš„é˜ˆå€¼ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®æ ‡å‡†åŒ–æ„å‘³ç€å°†æ•°æ®å€¼è½¬æ¢ä¸ºå¹³å‡å€¼ä¸º0ä¸”æ ‡å‡†å·®ä¸º1ã€‚ 12345678#standardizing datasaleprice_scaled = StandardScaler().fit_transform(df_train['SalePrice'][:,np.newaxis]);low_range = saleprice_scaled[saleprice_scaled[:,0].argsort()][:10]high_range= saleprice_scaled[saleprice_scaled[:,0].argsort()][-10:]print('outer range (low) of the distribution:')print(low_range)print('\\nouter range (high) of the distribution:')print(high_range) è¿™ä¸€æ­¥çš„ç›®çš„åº”è¯¥æ˜¯ä¸ºäº†æ‰¾å‡ºæ•°æ®ä¸­çš„ç¦»ç¾¤å€¼ï¼Œè¿™é‡Œéœ€è¦å…³æ³¨çš„æ˜¯ä¸¤ä¸ªå¤§äº7çš„å˜é‡ã€‚ 1234567891011121314#bivariate analysis saleprice/grlivareavar = 'GrLivArea'data = pd.concat([df_train['SalePrice'], df_train[var]], axis=1)data.plot.scatter(x=var, y='SalePrice', ylim=(0,800000));#deleting pointsdf_train.sort_values(by = 'GrLivArea', ascending = False)[:2]df_train = df_train.drop(df_train[df_train['Id'] == 1299].index)df_train = df_train.drop(df_train[df_train['Id'] == 524].index)#bivariate analysis saleprice/grlivareavar = 'TotalBsmtSF'data = pd.concat([df_train['SalePrice'], df_train[var]], axis=1)data.plot.scatter(x=var, y='SalePrice', ylim=(0,800000)); å°†â€™GrlivAreaâ€™ä¸­çš„ç¦»ç¾¤å€¼åˆ é™¤ã€‚ ä¹‹åè€ƒå¯Ÿâ€™TotalBsmtSFâ€™ä¸­çš„ç¦»ç¾¤å€¼ï¼Œä½†å®ƒçš„ç¦»ç¾¤å€¼è¡¨ç°åœ¨å¯ä»¥æ¥å—çš„èŒƒå›´ä¹‹å†…ã€‚ Getting hard coreAccording to Hair et al. (2013), four assumptions should be tested: Normality: The data should look like a normal distribution. Homoscedasticity: è¿™ä¸ªç”¨è‹±æ–‡è§£é‡Šä¸å¤ªå¥½æ‡‚ï¼ŒåŒæ–¹æ€§æ˜¯å¯å–çš„ï¼Œæˆ‘ä»¬å¸Œæœ›è¯¯å·®é¡¹åœ¨è‡ªå˜é‡çš„æ‰€æœ‰å€¼ä¸Šéƒ½ç›¸åŒï¼› Linearity: æ­£å¦‚å‰æ–‡å·²ç»åšè¿‡çš„ï¼Œé€šè¿‡æ•£ç‚¹å›¾çš„æ–¹æ³•æ¥è§‚æµ‹ä¸¤ä¸ªå˜é‡ä¹‹é—´æ˜¯å¦æœ‰çº¿æ€§çš„ç›¸å…³æ€§ï¼Œå¦‚æœç›¸å…³æ€§ä¸æ˜¯çº¿æ€§çš„ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¸€å®šçš„æ•°å­¦è½¬æ¢ä½¿å…¶çº¿æ€§ç›¸å…³ï¼› Absence of correlated errors: NormalityThe point here is to test â€˜SalePriceâ€™ in a very lean way. Weâ€™ll do this paying attention to: Histogram - Kurtosis and skewness. Normal probability plot - Data distribution sould closely follow the diagonal that represents the normal distribution. 1234#histogram and normal probability plotsns.distplot(df_train['SalePrice'], fit=norm);fig = plt.figure()res = stats.probplot(df_train['SalePrice'], plot=plt) å¯¹å˜é‡å–logè½¬æ¢å¾—ï¼š 12#applying log transformationdf_train['SalePrice'] = np.log(df_train['SalePrice']) å¯ä»¥çœ‹åˆ°ï¼Œæ•£ç‚¹æ›´ä¸ºå‡åŒ€åœ°åˆ†å¸ƒåœ¨äº†ç›´çº¿çš„ä¸¤ä¾§ã€‚ ä»¥åŒæ ·çš„æ–¹æ³•å¯¹â€™GrLivAreaâ€™ä¸â€™TotalBsmtSFâ€™è¿›è¡Œå¤„ç†ã€‚ å…¶ä¸­é¢ä¸´ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜æ˜¯ï¼Œæœ‰äº›å€¼ä¸º0ï¼Œæ‰€ä»¥åœ¨è¿™äº›å€¼ä¸Šï¼Œæˆ‘ä»¬æ— æ³•å¯¹å®ƒä»¬å–logã€‚è¦åœ¨æ­¤å¤„åº”ç”¨å¯¹æ•°è½¬æ¢ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œè¯¥å˜é‡å¯ä»¥å…·æœ‰æˆ–ä¸å…·æœ‰åœ°ä¸‹å®¤çš„æ•ˆæœï¼ˆäºŒè¿›åˆ¶å˜é‡ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å¯¹æ‰€æœ‰éé›¶è§‚æµ‹å€¼è¿›è¡Œå¯¹æ•°è½¬æ¢ï¼Œè€Œå¿½ç•¥é‚£äº›å€¼ä¸ºé›¶çš„è§‚æµ‹å€¼ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è½¬æ¢æ•°æ®ï¼Œè€Œä¸ä¼šå¤±å»æŸäº›å˜é‡çš„å½±å“ã€‚ 12345678910111213#create column for new variable (one is enough because it's a binary categorical feature)#if area&gt;0 it gets 1, for area==0 it gets 0df_train['HasBsmt'] = pd.Series(len(df_train['TotalBsmtSF']), index=df_train.index)df_train['HasBsmt'] = 0 df_train.loc[df_train['TotalBsmtSF']&gt;0,'HasBsmt'] = 1transform datadf_train.loc[df_train['HasBsmt']==1,'TotalBsmtSF'] = np.log(df_train['TotalBsmtSF'])#histogram and normal probability plotsns.distplot(df_train[df_train['TotalBsmtSF']&gt;0]['TotalBsmtSF'], fit=norm);fig = plt.figure()res = stats.probplot(df_train[df_train['TotalBsmtSF']&gt;0]['TotalBsmtSF'], plot=plt) Main Variables Variable Segment Data Type Comments GrLivArea 1 0 ç”Ÿæ´»é¢ç§¯ TotalBsmtSF 1 0 åœ°ä¸‹å®¤æ€»é¢ç§¯ GarageArea/GarageCars 1 0 è½¦åº“ YearBuilt 0 1 å»ºé€ å¹´ä»½ CentralAir 0 1 ä¸­å¤®ç©ºè°ƒ OverallQual 0 1 æ€»ä½“è¯„ä»· Neighborhood 2 1 åœ°æ®µ Now we can make sure there 7 variables will participate in our model. And we have cleaned the data set. The final thing left to do is to get the PREDICTION. Model: Random forestWhy use this? Idk, otherwise the blog didnâ€™t describe the reason clearly. The code displays below. And I have little trouble understanding the Random Forest Algorithm. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859# è·å–æ•°æ®data_train = pd.read_csv('./train.csv')cols = ['OverallQual','GrLivArea', 'GarageCars','TotalBsmtSF', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt']x = data_train[cols].valuesy = data_train['SalePrice'].valuesx_scaled = preprocessing.StandardScaler().fit_transform(x)y_scaled = preprocessing.StandardScaler().fit_transform(y.reshape(-1,1))X_train,X_test, y_train, y_test = train_test_split(x_scaled, y_scaled, test_size=0.33, random_state=42)clfs = { 'svm':svm.SVR(), 'RandomForestRegressor':RandomForestRegressor(n_estimators=400), 'BayesianRidge':linear_model.BayesianRidge() }for clf in clfs: try: clfs[clf].fit(X_train, y_train) y_pred = clfs[clf].predict(X_test) print(clf + \" cost:\" + str(np.sum(y_pred-y_test)/len(y_pred)) ) except Exception as e: print(clf + \" Error:\") print(str(e))cols = ['OverallQual','GrLivArea', 'GarageCars','TotalBsmtSF', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt']x = data_train[cols].valuesy = data_train['SalePrice'].valuesX_train,X_test, y_train, y_test = train_test_split(x, y, test_size=0.33, random_state=42)clf = RandomForestRegressor(n_estimators=400)clf.fit(X_train, y_train)y_pred = clf.predict(X_test)print(y_pred)rfr = clfdata_test = pd.read_csv(\"./test.csv\")data_test[cols].isnull().sum()data_test['GarageCars'].describe()data_test['TotalBsmtSF'].describe()cols2 = ['OverallQual','GrLivArea', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt']cars = data_test['GarageCars'].fillna(1.766118)bsmt = data_test['TotalBsmtSF'].fillna(1046.117970)data_test_x = pd.concat( [data_test[cols2], cars, bsmt] ,axis=1)data_test_x.isnull().sum()x = data_test_x.valuesy_te_pred = rfr.predict(x)print(y_te_pred)print(y_te_pred.shape)print(x.shape)prediction = pd.DataFrame(y_te_pred, columns=['SalePrice'])result = pd.concat([ data_test['Id'], prediction], axis=1)# result = result.drop(resultlt.columns[0], 1)result.columns# save the predictionresult.to_csv('./Predictions.csv', index=False)","link":"/2019/12/15/Kaggle-houseprice-prediction/"},{"title":"[Kubernetes] Bootstraping with Kubeadm","text":"Make some records while installing kubernetes. 1.Before you begin ç³»ç»Ÿç¯å¢ƒ: Ubuntu 16.04+ Debian 9+ CentOS 7 Red Hat Enterprise Linux (RHEL) 7 Fedora 25+ HypriotOS v1.0.1+ Container Linux (tested with 1800.6.0) RAM &gt;= 2GB 2 CPUs or more ç¡®ä¿é›†ç¾¤ä¹‹é—´å¯ä»¥äº’ç›¸è¿é€š ç¡®ä¿hostnameã€MACåœ°å€ä¸é‡å¤ ç¡®ä¿ç«¯å£ä¸ºè¢«å ç”¨ ç¡®ä¿å…³é—­äº¤æ¢åˆ†åŒº ç¡®ä¿å¯ä»¥è¿æ¥åˆ°é•œåƒç½‘ç«™(å¤–ç½‘) ä¸è¦ä½¿ç”¨nftablesnftablesè™½å¥½ï¼Œä½†ä¸æ”¯æŒï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨iptables Debian or Ubuntu Fedora 1234sudo update-alternatives --set iptables /usr/sbin/iptables-legacysudo update-alternatives --set ip6tables /usr/sbin/ip6tables-legacysudo update-alternatives --set arptables /usr/sbin/arptables-legacysudo update-alternatives --set ebtables /usr/sbin/ebtables-legacy ç«¯å£æ£€æŸ¥ Control-plane node(s) Protocol Direction Port Range Purpose Used By TCP Inbound 6443* Kubernetes API server All TCP Inbound 2379-2380 etcd server client API kube-apiserver, etcd TCP Inbound 10250 Kubelet API Self, Control plane TCP Inbound 10251 kube-scheduler Self TCP Inbound 10252 kube-controller-manager Self Worker node(s) Protocol Direction Port Range Purpose Used By TCP Inbound 10250 Kubelet API Self, Control plane TCP Inbound 30000-32767 NodePort Services** All æ—¶é’ŸåŒæ­¥See this post. ä¿®æ”¹hostname123[root@k8s-master ~]$ vim /etc/hostname # ä¿®æ”¹hostname[root@k8s-master ~]$ vim /etc/hosts # å°†æœ¬æœºIPæŒ‡å‘hostname[root@k8s-master ~]$ reboot -h # é‡å¯(å¯ä»¥åšå®Œå…¨éƒ¨å‰æœŸå‡†å¤‡åå†é‡å¯) ä¿®æ”¹å, ä¸¤å°è™šæ‹Ÿæœºçš„é…ç½®å¦‚ä¸‹: 12345678910111213# in k8s-master[root@k8s-master ~]$ cat /etc/hostname k8s-master[root@k8s-master ~]$ cat /etc/hosts | grep k8s10.33.30.92 k8s-master10.33.30.91 k8s-worker# in k8s-worker[root@k8s-worker ~]$ cat /etc/hostname k8s-worker[root@k8s-worker ~]$ cat /etc/hosts | grep k8s10.33.30.92 k8s-master10.33.30.91 k8s-worker ç¡®è®¤MACå’Œproduct_uuidçš„å”¯ä¸€æ€§ æ–‡æ¡£é“¾æ¥: Verify the MAC address and product_uuid are unique for every node 12[root@k8s-master ~]$ ifconfig -a # æŸ¥çœ‹MAC[root@k8s-master ~]$ cat /sys/class/dmi/id/product_uuid # æŸ¥çœ‹product_uuid æ³¨: å¦‚æœä½ çš„centos7æ²¡æœ‰ifconfigå‘½ä»¤, å¯ä»¥æ‰§è¡Œyum install net-toolsè¿›è¡Œå®‰è£…. é…ç½®é˜²ç«å¢™ æ–‡æ¡£é“¾æ¥: Check required ports ç”±äºæ˜¯æœ¬åœ°å†…ç½‘æµ‹è¯•ç¯å¢ƒ, ç¬”è€…å›¾æ–¹ä¾¿, ç›´æ¥å…³é—­äº†é˜²ç«å¢™. è‹¥å®‰å…¨è¦æ±‚è¾ƒé«˜, å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£æ”¾è¡Œå¿…è¦ç«¯å£. 12[root@k8s-master ~]$ systemctl stop firewalld # å…³é—­æœåŠ¡[root@k8s-master ~]$ systemctl disable firewalld # ç¦ç”¨æœåŠ¡ ç¦ç”¨SELinux æ–‡æ¡£é“¾æ¥: coredns pods have CrashLoopBackOff or Error state ä¿®æ”¹/etc/selinux/config, è®¾ç½®SELINUX=disabled. é‡å¯æœºå™¨. 12[root@k8s-master ~]$ sestatus # æŸ¥çœ‹SELinuxçŠ¶æ€SELinux status: disabled ç¦ç”¨äº¤æ¢åˆ†åŒº æ–‡æ¡£é“¾æ¥: Before you begin Swap disabled. You MUST disable swap in order for the kubelet to work properly. ç¼–è¾‘/etc/fstab, å°†swapæ³¨é‡Šæ‰. é‡å¯æœºå™¨. 12[root@k8s-master ~]$ vim /etc/fstab #/dev/mapper/cl-swap swap swap defaults 0 0 å®‰è£…Docker æ–‡æ¡£é“¾æ¥: Get Docker Engine - Community for CentOS Dockerå®˜æ–¹æ–‡æ¡£å¯¹å®‰è£…æ­¥éª¤æè¿°å·²ç»è¶³å¤Ÿè¯¦ç»†, è¿‡ç¨‹å¹¶ä¸å¤æ‚, æœ¬æ–‡ä¾¿ä¸å†èµ˜è¿°. Dockerè¯·ä½¿ç”¨18.09, k8sæš‚ä¸æ”¯æŒDockeræœ€æ–°ç‰ˆ19.x, å®‰è£…æ—¶è¯·æŒ‰ç…§æ–‡æ¡£æè¿°çš„æ–¹å¼æ˜ç¡®æŒ‡å®šç‰ˆæœ¬å·yum install docker-ce-18.09.9-3.el7 docker-ce-cli-18.09.9-3.el7 containerd.io. è‹¥ç½‘ç»œä¸å¥½, å¯æ¢ç”¨å›½å†…æº, é˜¿é‡Œäº‘ã€ä¸­ç§‘å¤§ç­‰éƒ½å¯. æ­¤å¤„é™„ä¸Šé˜¿é‡Œäº‘æºdockerå®‰è£…æ–‡æ¡£åœ°å€: å®¹å™¨é•œåƒæœåŠ¡. å®‰è£…å®Œæ¯•å, å»ºè®®å°†dockeræºæ›¿æ¢ä¸ºå›½å†…. æ¨èé˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ, æœ‰é˜¿é‡Œäº‘è´¦å·å³å¯å…è´¹ä½¿ç”¨.é˜¿é‡Œäº‘ -&gt; å®¹å™¨é•œåƒæœåŠ¡ -&gt; é•œåƒä¸­å¿ƒ -&gt; é•œåƒåŠ é€Ÿ é…ç½®Docker æ–‡æ¡£åœ°å€: Container runtimes ä¿®æ”¹/etc/docker/daemon.jsonä¸ºå¦‚ä¸‹å†…å®¹: 123456789{ &quot;registry-mirrors&quot;: [&quot;https://xxxxxxxx.mirror.aliyuncs.com&quot;], &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;], &quot;log-driver&quot;: &quot;json-file&quot;, &quot;log-opts&quot;: { &quot;max-size&quot;: &quot;100m&quot; }, &quot;storage-driver&quot;: &quot;overlay2&quot;} å…¶ä¸­https://xxxxxxxx.mirror.aliyuncs.comä¸ºé˜¿é‡Œäº‘é•œåƒåŠ é€Ÿåœ°å€, xxxxxxxxéœ€è¦æ›¿æ¢ä¸ºè‡ªå·±è´¦æˆ·ä¸­çš„åœ°å€. å®‰è£…é…ç½®å®Œæ¯•åæ‰§è¡Œ: 12[root@k8s-master ~]$ systemctl enable docker[root@k8s-master ~]$ systemctl start docker 2.å®‰è£… kubeadm, kubelet, kubectl kubeadm: the command to bootstrap the cluster. kubelet: the component that runs on all of the machines in your cluster and does things like starting pods and containers. kubectl: the command line util to talk to your cluster. version skew 12345678sudo apt-get update &amp;&amp; sudo apt-get install -y apt-transport-https curlcurl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -cat &lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.listdeb https://apt.kubernetes.io/ kubernetes-xenial mainEOFsudo apt-get updatesudo apt-get install -y kubelet kubeadm kubectlsudo apt-mark hold kubelet kubeadm kubectl The kubelet is now restarting every few seconds, as it waits in a crashloop for kubeadm to tell it what to do. 3.å¼€å§‹å®‰è£… Run kubeadm config images pull prior to kubeadm init to verify connectivity to gcr.io registries. If you meet some trouble here, see the Troubleshooting 1 kubeadm config print init-defaults &gt; init.default.yaml cp init.default.yaml init-config.yaml vim init-config.yaml ç›¸å…³é…ç½®ä¿¡æ¯ï¼ŒæŸ¥é˜…kubeadm documents. æˆ‘ä¿®æ”¹å®Œçš„æ–‡ä»¶å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738apiVersion: kubeadm.k8s.io/v1beta2bootstrapTokens:- groups: - system:bootstrappers:kubeadm:default-node-token token: abcdef.0123456789abcdef ttl: 24h0m0s usages: - signing - authenticationkind: InitConfigurationlocalAPIEndpoint: advertiseAddress: 192.168.1.251 bindPort: 6443nodeRegistration: criSocket: /var/run/dockershim.sock name: k8s-master taints: - effect: NoSchedule key: node-role.kubernetes.io/master---apiServer: timeoutForControlPlane: 4m0sapiVersion: kubeadm.k8s.io/v1beta2certificatesDir: /etc/kubernetes/pkiclusterName: kubernetescontrollerManager: {}dns: type: CoreDNSetcd: local: dataDir: /var/lib/etcdimageRepository: registry.cn-hangzhou.aliyuncs.com/google_containerskind: ClusterConfigurationkubernetesVersion: v1.17.0networking: dnsDomain: cluster.local serviceSubnet: 10.96.0.0/12scheduler: {} kubeadm config images pullæ‹‰å–æ‰€éœ€è¦çš„é•œåƒ kubeadm init 12345678910111213141516171819202122root@openstack1:~/kubernetes# kubeadm init --config=init-config.yaml[init] Using Kubernetes version: v1.17.0[preflight] Running pre-flight checks [WARNING KubernetesVersion]: Kubernetes version is greater than kubeadm version. Please consider to upgrade kubeadm. Kubernetes version: 1.17.0. Kubeadm version: 1.16.xÂ·Â·Â·Â·Â·Â·Your Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/configYou should now deploy a pod network to the cluster.Run \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.1.251:6443 --token abcdef.0123456789abcdef \\ --discovery-token-ca-cert-hash sha256:0a77d9dc7d5fd833203211767a869324e512222540f9bbf0e70cb4bb87d981c0 ä¹‹åæŒ‰ç…§ç»™å‡ºçš„æç¤ºï¼Œmkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $ $(id -u):$(id -g) $HOME/.kube/config kubeadmåœ¨Masterä¸Šä¹Ÿå®‰è£…äº†kubeletï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹Masterä¸å‚ä¸å·¥ä½œè´Ÿè½½ï¼Œå¦‚æœä½ æ­¤æ—¶æƒ³å®‰è£…ä¸€ä¸ªAll-In-Oneçš„Kubernetesç¯å¢ƒï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤(åˆ é™¤Nodeçš„Label â€œnode-role.kubernetes.io/masterâ€), è®©Masteræˆä¸ºä¸€ä¸ªNodeï¼škubectl taint nodes --all node-role.kubernetes.io/master- 4. Installing network add-onå¿…é¡»åœ¨å®‰è£…ç½‘ç»œæ’ä»¶ä¹‹åï¼Œpodsä¹‹é—´æ‰èƒ½äº’ç›¸é€šä¿¡ã€‚ The network must be deployed before any applications. Also, CoreDNS will not start up before a network is installed. kubeadm only supports Container Network Interface (CNI) based networks (and does not support kubernet) Weave Net Set /proc/sys/net/bridge/bridge-nf-call-iptables to 1 by running sysctl net.bridge.bridge-nf-call-iptables=1 to pass bridged IPv4 traffic to iptablesâ€™ chains. This is a requirement for some CNI plugins to work, for more information please see here. The official Weave Net set-up guide is here. Weave Net works on amd64, arm, arm64 and ppc64le without any extra action required. Weave Net sets hairpin mode by default. This allows Pods to access themselves via their Service IP address if they donâ€™t know their PodIP. 1kubectl apply -f \"https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d '\\n')\" calico ä¸‹è½½æè¿°æ–‡ä»¶ 123[root@k8s-master ~]$ wget https://docs.projectcalico.org/v3.8/manifests/calico.yaml[root@k8s-master ~]$ cat kubeadm-init.yaml | grep serviceSubnet:serviceSubnet: 10.96.0.0/12 æ‰“å¼€calico.yaml, å°†192.168.0.0/16ä¿®æ”¹ä¸º10.96.0.0/12 éœ€è¦æ³¨æ„çš„æ˜¯, calico.yamlä¸­çš„IPå’Œkubeadm-init.yamléœ€è¦ä¿æŒä¸€è‡´, è¦ä¹ˆåˆå§‹åŒ–å‰ä¿®æ”¹kubeadm-init.yaml, è¦ä¹ˆåˆå§‹åŒ–åä¿®æ”¹calico.yaml. æ‰§è¡Œkubectl apply -f calico.yamlåˆå§‹åŒ–ç½‘ç»œ. æ­¤æ—¶æŸ¥çœ‹nodeä¿¡æ¯, masterçš„çŠ¶æ€å·²ç»æ˜¯Readyäº†. 123[root@k8s-master ~]$ kubectl get nodeNAME STATUS ROLES AGE VERSIONk8s-master Ready master 15m v1.17.0 æ›´å¤šæ–¹æ³• 5. Dashboard æ–‡æ¡£åœ°å€: Web UI (Dashboard) éƒ¨ç½²Dashboard æ–‡æ¡£åœ°å€: Deploying the Dashboard UI å¯ä»¥é€šè¿‡kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta8/aio/deploy/recommended.yamlæŒ‰ç…§å®˜æ–¹æ¨¡ç‰ˆåˆ›å»ºä¸€ä¸ªdashboard åˆ›å»ºç”¨æˆ· æ–‡æ¡£åœ°å€: Creating sample user ç”±äºå®‰å…¨æœºåˆ¶ï¼Œk8så¯¹ç”¨æˆ·çš„è®¿é—®ç®¡ç†ååˆ†ä¸¥æ ¼ï¼Œæ­¤å¤„çš„ç›®çš„æ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªç”¨äºç™»å½•Dashboardçš„ç”¨æˆ·ï¼Œåˆ›å»ºæ–‡ä»¶dashboard-adminuser.yamlå†…å®¹å¦‚ä¸‹: 123456789101112131415161718apiVersion: v1kind: ServiceAccountmetadata: name: admin-user namespace: kube-system---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: admin-userroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-adminsubjects:- kind: ServiceAccount name: admin-user namespace: kube-system æ‰§è¡Œå‘½ä»¤kubectl apply -f dashboard-adminuser.yaml è®¿é—®dashboard çš„æ–¹å¼ kubernetes-dashboard æœåŠ¡æš´éœ²äº† NodePortï¼Œå¯ä»¥ä½¿ç”¨ http://NodeIP:nodePort åœ°å€è®¿é—® dashboard é€šè¿‡ kubectl proxy è®¿é—® dashboard é€šè¿‡ API server è®¿é—® dashboardï¼ˆhttps 6443ç«¯å£å’Œhttp 8080ç«¯å£æ–¹å¼ï¼‰ å‰ä¸¤ç§æ–¹å¼å¯ä»¥å‚è€ƒæ­¤æ–‡ï¼Œæœ¬æ–‡ä¸»è¦è®²è¿°ç¬¬ä¸‰ç§æ–¹å¼ã€‚ åœ¨~/.kube/è·¯å¾„ä¸‹ï¼Œæ‰§è¡Œ 123grep 'client-certificate-data' ~/.kube/config | head -n 1 | awk '{print $2}' | base64 -d &gt;&gt; kubecfg.crtgrep 'client-key-data' ~/.kube/config | head -n 1 | awk '{print $2}' | base64 -d &gt;&gt; kubecfg.keyopenssl pkcs12 -export -clcerts -inkey kubecfg.key -in kubecfg.crt -out kubecfg.p12 -name \"kubernetes-client\" ç¬¬ä¸‰è¡Œå‘½ä»¤ä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼Œè®°ä½ä½ æ­¤æ—¶è¾“å…¥çš„å¯†ç ï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªkubecfg.p12æ–‡ä»¶ï¼Œå°†å…¶æ‹·è´åˆ°å°†è¦è®¿é—®dashboard çš„ä¸»æœºä¸Š(ç”¨scp)ï¼Œåœ¨è¯¥ä¸»æœºä¸Šç‚¹å‡»æ‰“å¼€è¯ä¹¦æ–‡ä»¶ï¼Œç”¨åˆšæ‰çš„å¯†ç è§£é”ï¼Œå¹¶å¯¼å…¥åˆ°è®¡ç®—æœºä¸­ã€‚ åŠ ä¸‹æ¥è®¿é—®http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ å¦‚æœç¢°åˆ°é¡µé¢æ˜¾ç¤º 1234567891011121314{\"kind\": \"Status\",\"apiVersion\": \"v1\",\"metadata\": {},\"status\": \"Failure\",\"message\": \"pods is forbidden: User \"system:anonymous\" cannot list pods in the namespace \"default\"\",\"reason\": \"Forbidden\",\"details\": {\"kind\": \"pods\"},\"code\": 403} é‚£ä¹ˆå‚è€ƒè¿™ä¸ªissueï¼Œåœ¨ä¹‹å‰ç”¨æ¥ç”Ÿæˆdashboardçš„recommend.yamlä¸­åŠ å…¥ 123456789101112131415161718192021222324252627---# ------------------- Gross Hack For anonymous auth through api proxy ------------------- ## Allows users to reach login page and other proxied dashboard URLskind: ClusterRoleapiVersion: rbac.authorization.k8s.io/v1metadata: name: kubernetes-dashboard-anonymousrules:- apiGroups: [\"\"] resources: [\"services/proxy\"] resourceNames: [\"https:kubernetes-dashboard:\"] verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]- nonResourceURLs: [\"/ui\", \"/ui/*\", \"/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/*\"] verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: kubernetes-dashboard-anonymousroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: kubernetes-dashboard-anonymoussubjects:- kind: User name: system:anonymous é€šè¿‡å‘½ä»¤é‡æ–°å¯åŠ¨dashboardï¼škubectl replace --force -f recommended.yaml ç»§ç»­æ‰“å¼€é¡µé¢https://{k8s-master-ip}:6443/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login å°†ä¼šçœ‹åˆ°ä¸‹å›¾ ![dashboard]( æ­¤æ—¶éœ€è¦ä½¿ç”¨Tokenç™»å½• ç”ŸæˆTokenæ‰§è¡Œkubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}'), è·å–Token. 6. Joining your nodes å…¶ä»–æœºå™¨åŠ å…¥cluster: æŒ‰ç…§å‰æ–‡æ­¥éª¤ï¼Œå®‰è£…kubeadm, kubelet å…³é—­swapåˆ†åŒº è¿›è¡Œ2ã€3ã€4æ­¥æ“ä½œ è¿è¡Œ: `kubeadm join 192.168.1.251:6443 â€“token abcdef.0123456789abcdef \\ --discovery-token-ca-cert-hash sha256:9c06556766e6dbf15385dc62b99e4f40d15b8412ca5bd853a79cbee1f14724f8` (æ­¤å¤„ä¸ºå‰æ–‡å‘½ä»¤æç¤ºçš„ï¼Œæ­¤tokené5ä¸­token) å¦‚æœä½ æ²¡æœ‰tokenï¼Œè¿è¡Œkubeadm token list(åœ¨masterä¸Š)ï¼Œå¯ä»¥æŸ¥çœ‹token é»˜è®¤tokenåœ¨24å°æ—¶ååˆ°æœŸï¼Œå¦‚æœtokenå·²ç»åˆ°æœŸ kubeadm token createå¾—åˆ°æ–°tokenï¼Œæˆ–ä½¿ç”¨kubeadm token listæŸ¥çœ‹token è·å–caè¯ä¹¦sha256ç¼–ç hashå€¼ 1openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //' Tear downTo undo what kubeadm did, you should first drain the node and make sure that the node is empty before shutting it down. Talking to the control-plane node with the appropriate credentials, run: 12kubectl drain &lt;node name&gt; --delete-local-data --force --ignore-daemonsetskubectl delete node &lt;node name&gt; Then, on the node being removed, reset all kubeadm installed state: 1kubeadm reset The reset process does not reset or clean up iptables rules or IPVS tables. If you wish to reset iptables, you must do so manually: 1iptables -F &amp;&amp; iptables -t nat -F &amp;&amp; iptables -t mangle -F &amp;&amp; iptables -X If you want to reset the IPVS tables, you must run the following command: 1ipvsadm -C If you wish to start over simply run kubeadm init or kubeadm join with the appropriate arguments. More options and information about the kubeadm reset command 123Failed to create pod sandbox: rpc error: code = Unknown desc = [failed to set up sandbox container \"2fd3d89066e8990021729afcb5b209dc5246ce1cbba6ee16b7242bdbef1dfc66\" network for pod \"calico-kube-controllers-778676476b-rrwsh\": networkPlugin cni failed to set up pod \"calico-kube-controllers-778676476b-rrwsh_kube-system\" network: error getting ClusterInformation: resource does not exist: ClusterInformation(default) with error: clusterinformations.crd.projectcalico.org \"default\" not found, failed to clean up sandbox container \"2fd3d89066e8990021729afcb5b209dc5246ce1cbba6ee16b7242bdbef1dfc66\" network for pod \"calico-kube-controllers-778676476b-rrwsh\": networkPlugin cni failed to teardown pod \"calico-kube-controllers-778676476b-rrwsh_kube-system\" network: error getting ClusterInformation: resource does not exist: ClusterInformation(default) with error: clusterinformations.crd.projectcalico.org \"default\" not found]Back-off restarting failed containerReadiness probe failed: Failed to read status file status.json: open status.json: no such file or directory","link":"/2019/12/23/KubernetesKubeadm/"},{"title":"Linuxæ­å»ºTimeMachineå¤‡ä»½æœåŠ¡å™¨","text":"ä¸Šäº†pddçš„è½¦ï¼Œæœ€ç»ˆè¿˜æ˜¯å…¥æ‰‹äº†ä¸€å°ä¸ç‰ˆmbpï¼Œ256Gçš„å­˜å‚¨ç©ºé—´ä½¿ç”¨èµ·æ¥è®©äººå¿ƒç–¼ï¼ŒTime Machineæœ¬æ¥æ˜¯ä¸€æ¬¾å¾ˆä¸é”™çš„å¤‡ä»½å·¥å…·ï¼Œç„¶è€Œæœ‰é™çš„ç©ºé—´ç»ä¸èµ·å®ƒæ— æ­¢å¢ƒæ‰©å¤§çš„å¤‡ä»½ç­–ç•¥çš„æŠ˜è…¾äº†ã€‚å¤‡ä»½ä¸åšï¼Œåæ¶ä¸èµ¦ï¼Œå¥½åœ¨å®éªŒå®¤çš„æœåŠ¡å™¨æœ€è¿‘ä¸€ç›´é—²ç½®ï¼Œåœ¨ç½‘ä¸Šçœ‹äº†å‡ å¥—æ–¹æ¡ˆä¹‹åå°±å‡†å¤‡å¼€å§‹äº†ã€‚ å¼€å§‹ä¹‹å‰åœ¨å¼€å§‹ä¹‹å‰ï¼Œé¦–å…ˆæœ€å¥½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„è´¦æˆ·ç™»å½•ä¸»æœºï¼Œè¿™ä¸ªè´¦æˆ·å°†åœ¨ä¹‹åè¢«ç”¨æ¥è¿›è¡Œè¿œç¨‹ç™»å½•è·å–æœåŠ¡ã€‚ å®‰è£…Netatalkå’ŒAvahiNetatalkæ˜¯ä¸€ä¸ªå¼€æºçš„åè®®ï¼Œæ”¯æŒç±»Unixç³»ç»Ÿä¸ºMacæä¾›æ–‡ä»¶æœåŠ¡ï¼Œå®‰è£…Netatalkï¼š sudo apt install Netatalk Avahiå…è®¸ç¨‹åºåœ¨æœ¬åœ°ç½‘ç»œç¯å¢ƒä¸­åˆ†å‘ä¸æä¾›æœåŠ¡ï¼ŒåŒæ ·é€šè¿‡aptå®‰è£…Avahiï¼š sudo apt avahi åˆ›å»ºæ–‡ä»¶ /etc/avahi/services/afpd.serviceæ¥é…ç½® avahiï¼Œå†™å…¥å¦‚ä¸‹å†…å®¹ï¼š 123456789101112&lt;service-group&gt;&lt;name replace-wildcards=&quot;yes&quot;&gt;%h&lt;/name&gt;&lt;service&gt;&lt;type&gt;_afpovertcp._tcp&lt;/type&gt;&lt;port&gt;548&lt;/port&gt;&lt;/service&gt;&lt;service&gt;&lt;type&gt;_device-info._tcp&lt;/type&gt;&lt;port&gt;0&lt;/port&gt;&lt;txt-record&gt;model=Xserve&lt;/txt-record&gt;&lt;/service&gt;&lt;/service-group&gt; æŒ‚è½½ç¡¬ç›˜å‚è€ƒåšå®¢çš„ä½œè€…é‡‡ç”¨äº†HFS+æ¥å¯¹ç¡¬ç›˜è¿›è¡Œå¤„ç†(æ ¼å¼åŒ–ï¼Ÿ)ï¼Œé€šè¿‡apt install hfspluså³å¯æˆåŠŸå®‰è£…ï¼Œåšå®¢ä¸­ç”±äºæ˜¯å®‰è£…çš„ç²¾ç®€ç³»ç»Ÿï¼Œåœ¨ä½¿ç”¨modprobe hfsplusä¹‹åæŠ¥é”™ï¼Œéœ€è¦æ‰“å®˜æ–¹è¡¥ä¸æ‰èƒ½è§£å†³è¿™ä¸ªå‘ï¼Œè€Œæˆ‘ä»¬ä¸éœ€è¦ã€‚ ç”±äºåœ¨å½“åˆå®‰è£…192.168.1.253æœºå™¨çš„æ—¶å€™ï¼Œå°†Samsung 970 evo 1Tå•ç‹¬æ”¾åœ¨ä¸€è¾¹ï¼Œæœªåœ¨å…¶ä¸­åˆå§‹åŒ–åˆ†åŒºï¼Œå› æ­¤è¿™å—ç¡¬ç›˜ä¸Šè¿˜æ˜¯windowsçš„åˆ†åŒºæ ¼å¼ï¼Œé€šè¿‡fdisk -læŸ¥è¯¢åˆ°è¿™å—ç¡¬ç›˜çš„åç§°ä¸º/dev/nvme0n1ï¼Œå°†å®ƒæ ¼å¼åŒ–ä¸ºext4 sudo mkfs.ext4 /dev/nvme0n1 ä¸çŸ¥é“ä»å“ªçœ‹çš„è§„çŸ©ï¼Œè¯´æ˜¯æŒ‚åœ¨ç¡¬ç›˜è¦æ”¾åœ¨/mediaä¸‹ï¼Œä¸è¿‡è¿™ä¹Ÿæ— å…³ç´§è¦ï¼Œmkdir /media/nvme0n1ï¼Œå†å°†ç¡¬ç›˜æŒ‚è½½åˆ°è¯¥ç›®å½•ä¸Š: mount -t hfsplus -o force,rw /dev/nvme0n1 /media/nvme0n1 ç”±äºmountå‘½ä»¤åœ¨é‡å¯æœåŠ¡å™¨ä¹‹åä¼šå¤±æ•ˆï¼Œæ‰€ä»¥å°†åˆ†åŒºä¿¡æ¯å†™å…¥æ–‡ä»¶ä¸­ï¼š sudo vi /etc/fstab 1/dev/nvme0n1 /media/nvme0n1 ext4 defaults 0 2 è¿™å¥ä¸­2ä»£è¡¨åœ¨ç³»ç»Ÿå¼€æœºæ—¶ä¼šå¯¹è¯¥åˆ†åŒºè¿›è¡Œå¿«é€Ÿæ£€æµ‹ï¼Œå¦‚æœä½ ä¸å¸Œæœ›è¿™ä¹ˆåšï¼Œå¯ä»¥æŠŠå®ƒæ”¹æˆ0è·³è¿‡å¼€æœºæ£€æµ‹ã€‚ æƒé™é—®é¢˜å¦‚æœæ˜¯æŒ‰ç…§é¡ºåºæ¥çš„è¯ï¼Œåº”è¯¥æ­¤å¤„ä¸ä¼šé‡åˆ°æƒé™é—®é¢˜ï¼Œä½†æˆ‘å½“æ—¶æ²¡æœ‰ã€‚ æ¯”è¾ƒä¸¥è°¨çš„æ–¹æ³•æŒ‚è½½æˆåŠŸåä½ çš„é root ç”¨æˆ·å¯èƒ½æ˜¯æ— æ³•å†™å…¥çš„ï¼Œè¿™æ˜¯ç”±äºç£ç›˜å†…å®¹è‡ªæœ‰ç”¨æˆ·é€ æˆçš„ï¼Œæœ€ç®€å•çš„åŠæ³•å¯èƒ½å°±æ˜¯æ¬ºéª—æ–‡ä»¶è®©å®ƒä»¥ä¸ºä½ è¿˜æ˜¯åŸæ¥çš„ç”¨æˆ·ã€‚mac ä¸­é»˜è®¤ç”¨æˆ· UID æ˜¯ 501ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠè·‘ netatalk çš„ç”¨æˆ·idæ”¹ä¸º 501: 123sudo groupadd admin //åˆ›å»ºç®¡ç†ç»„sudo useradd -d /home/tempuser -m -s /bin/bash -G admin tempuser //åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç”¨æˆ·sudo passwd tempuser //ç»™ç”¨æˆ·ä¸€ä¸ªå¯†ç ï¼Œåˆ«å¿˜è®°äº† åšå®Œä¹‹åé€€å‡ºå½“å‰ç”¨æˆ·ï¼Œç„¶åç”¨è¿™ä¸ªä¸´æ—¶ç”¨æˆ·è¿›å»ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ sshï¼Œé‚£ä¹ˆå°±é€€å‡ºæ¥ï¼Œç”¨ ssh tempuser@xxx.xxx.xxx.xxx é‡æ–°ç™»å½•ã€‚ç™»å½•ä¹‹åç»§ç»­ï¼š 1sudo usermod --uid 501 yourusername //æ”¹ä½ åˆšæ‰ç”¨æˆ·çš„uid è¿™æ—¶å€™ä½ å¯èƒ½ä¼šæ”¶åˆ°æç¤ºè¯´è¿˜æœ‰è¿›ç¨‹åœ¨å ç”¨ï¼Œä¸èƒ½æ”¹ã€‚è¿™å¾ˆå¥½åŠï¼Œæ ¹æ®æç¤ºçš„pidï¼Œå¹²æ‰é‚£ä¸ªè¿›ç¨‹å³å¯ï¼š sudo kill &lt;pid&gt; ç„¶åé‡å¤æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œæ²¡å…³ç³»ï¼Œæœ‰å¤šå°‘ä¸ªå ç”¨å°±å¹²å¤šå°‘ä¸ªâ€¦â€¦ 12sudo chown -R 501:yourusername /home/yourusername //ä¸Šè¾¹è¿™è¡Œä¸¤å¤„éƒ½è¦æ”¹æˆä½ è‡ªå·±çš„ç”¨æˆ·åï¼Œè¿™ä¸ªæ˜¯æ”¹ç›®å½•æ‰€æœ‰æƒçš„ æ¥ä¸‹æ¥ï¼Œä½ å°±å¯ä»¥é€€å‡ºç„¶åç”¨ä½ åŸæ¥çš„ç”¨æˆ·ç™»å½•äº†ï¼Œè¿™æ—¶å€™å†å»æŒ‚è½½çš„ç›®å½•çœ‹çœ‹ï¼Œå·²ç»å¯å†™ã€‚åˆ«å¿˜äº†åˆ é™¤é‚£ä¸ªä¸´æ—¶ç”¨æˆ·ï¼š 1sudo userdel -r tempuser æ¯”è¾ƒç²—æš´çš„æ–¹æ³•ä¹‹åç”¨å“ªä¸ªç”¨æˆ·ç™»å½•ï¼Œç›´æ¥æŠŠå¯¹åº”æ–‡ä»¶å¤¹åŠå­æ–‡ä»¶çš„æ‰€æœ‰è€…å…¨æ”¹äº† 1chown -R username:usergroup /media/ ç®€å•ç²—æš´ï¼Œé…åˆæ›´é«˜æƒé™çš„ç”¨æˆ·ï¼Œå…ˆè§£å†³é—®é¢˜å†è¯´ï¼Œåæ­£åªæ˜¯å†…ç½‘ã€‚ é…ç½®Netatalkåˆ›å»ºTime Machineçš„å¤‡ä»½æ–‡ä»¶å¤¹ï¼š 123mkdir /media/nvme0n1/TimeMachinesudo vi /etc/netatalk/AppleVolumes.default å¤§å†™Gç›´æ¥è·³åˆ°æ–‡ä»¶æœ«å°¾ï¼ŒåŠ ä¸Šï¼š 123456# The line below sets some DEFAULT, starting with Netatalk 2.1.:DEFAULT: options:upriv,usedots/media/nvme0n1/TimeMachine &quot;TimeMachine&quot; options:tm/media/nvme0n1/NAS &quot;NAS&quot;# By default all users have access to their home directories.#~/ &quot;Home Directory&quot; é‡ç‚¹å°±æ˜¯ç¬¬ä¸‰è¡Œæœ«å°¾çš„ options:tm æ ‡è®°è¿™ä¸€å¥è®©å¯¹åº”çš„ç›®å½•å¯¹ TimeMachine å¯è§ã€‚ æœ€åï¼Œæˆ‘ä»¬é‡å¯å¯¹åº”çš„æœåŠ¡ï¼š 12sudo service netatalk restartsudo service avahi-daemon restart Macç«¯è®¾ç½®åœ¨Macç»ˆç«¯ä¸­æ‰§è¡Œè¿™æ¡å‘½ä»¤è®©tmå‘ç°ç½‘ç»œå¤‡ä»½ä½ç½®ï¼š 1defaults write com.apple.systempreferences TMShowUnsupportedNetworkVolumes 1 è¿™ä¸‹ä½ å°±åº”è¯¥å·²ç»èƒ½å¤Ÿåœ¨ tm é…ç½®ä¸­å‘ç°ä½ çš„ç½‘ç»œä½ç½®äº†ï¼ ç»™æœåŠ¡å™¨æ·»åŠ  windows å…±äº«win ä½¿ç”¨çš„å…±äº«åè®®å«åš sambaï¼Œåè®®çš„åå­—å« smbï¼Œmacå…¶å®èƒ½å¤Ÿæ”¯æŒsmbï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥è®© tm èµ° afpï¼Œå¦å¤–æ¥ä¸€ä¸ªç›®å½•ä¸“é—¨è·‘ smbï¼Œç”¨æ¥ mac å’Œ win å…±äº«æ–‡ä»¶äº†ã€‚ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥å®‰è£… sambaï¼š 123sudo apt-get install sambasudo apt-get install smbclient # Linuxå®¢æˆ·ç«¯æµ‹è¯•ç”¨ å¤‡ä»½åŸé…ç½®æ–‡ä»¶: 1sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š vim /etc/samba/smb.confï¼Œåœ¨æœ«å°¾è¿½åŠ å¦‚ä¸‹å†…å®¹ï¼š 123456[share] path = /home/share browseable = yes writable = yes comment = smb share test public = no //é¿å…åŒ¿åç™»å½• è¿™ä¸ªshareå°±æ˜¯ä¹‹åçš„åœ°å€äº†ï¼Œè¿™é‡Œç­‰äºåšäº†ä¸ªåœ°å€æ˜ å°„ã€‚ç„¶åä¸º samba åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·å¿…é¡»æ˜¯å·²ç»å­˜åœ¨çš„ç”¨æˆ·ï¼š 1sudo smbpasswd -a smbuser åˆ›å»ºçš„å¯†ç å°±æ˜¯ä½ è¦ç™»å½• samba çš„å¯†ç ï¼Œåˆ«è®°é”™äº†ã€‚æœ€åé‡å¯æœåŠ¡ï¼š 1sudo service smbd restart ä¹‹åwindowsä¸Šè¿æ¥åˆ°æœåŠ¡å™¨å°±åªéœ€è¦åœ¨ç½‘ç»œæ˜ å°„é…ç½®ä¸­åŠ ä¸Š\\\\192.168.1.253\\shareï¼Œå†è¾“å…¥å¯¹åº”å¯†ç ï¼Œå°±å¯ä»¥åƒè®¿é—®æœ¬åœ°ç£ç›˜ä¸€æ ·è®¿é—®æœåŠ¡å™¨ä¸Šçš„ç£ç›˜äº†ã€‚","link":"/2019/07/26/Linux%E6%90%AD%E5%BB%BATimeMachine%E5%A4%87%E4%BB%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"title":"Linuxæ–‡ä»¶ç³»ç»Ÿæ¶æ„","text":"æœ¬æ–‡å°†ä»‹ç»ç±»Unixç³»ç»Ÿä¸­ä¸€ç³»åˆ—æ–‡ä»¶ç›®å½•å­˜æ”¾çš„åŸºæœ¬åŸåˆ™ä¸æ ‡å‡†ã€‚è¿™ç¯‡å‘å¯¼æ—¨åœ¨ä¸ºç³»ç»Ÿçš„äº¤äº’æ€§ã€ç³»ç»Ÿçš„ç®¡ç†å·¥å…·ã€å¼€å‘å·¥å…·ã€è„šæœ¬æä¾›æ”¯æŒï¼Œä½¿å…¶åœ¨æ‰€æœ‰ç³»ç»Ÿä¸­æ›´åŠ ç»Ÿä¸€ã€‚æœ¬æ–‡å‚è€ƒ 1.ä»‹ç»è¿™ç¯‡æ ‡å‡†ä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©è½¯ä»¶é¢„æµ‹å°†è¦å®‰è£…çš„ç›®å½•å’Œè·¯å¾„ï¼Œä»¥åŠå¸®åŠ©ç”¨æˆ·å®šä½å·²å®‰è£…çš„æ–‡ä»¶è·¯å¾„ã€‚æœ¬æ–‡ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„æ¯ä¸ªåŒºåŸŸæä¾›æŒ‡å¯¼åŸåˆ™ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ—ä¸¾ä¸è¢«åŒ…æ‹¬åœ¨è¿™ä¸ªåŸåˆ™ä¸­çš„ä¸€äº›æƒ…å†µåŠä¸€äº›å†å²å†²çªæ¡ˆä¾‹ã€‚ 2.æ–‡ä»¶ç³»ç»Ÿè¿™ç¯‡æ ‡å‡†å‡å®šæ“ä½œç³»ç»Ÿæ˜¯åº•å±‚æ˜¯å…¼å®¹æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„æ ‡å‡†(Filesystem Hierarchy Standard, FHS)ï¼Œå¹¶ä¸”éµå¾ªå¤§å¤šæ•°UNIXæ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬å®‰å…¨æ ‡å‡†ã€‚ æ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡ä¸­æ˜ç¡®ä¸¤ä¸ªé‡è¦çš„åŒºåˆ«ï¼šå¯åˆ†äº«ä¸ä¸å¯åˆ†äº«ã€é™æ€ä¸åŠ¨æ€ã€‚å¤§ä½“ä¸Šæ–‡ä»¶å°†åŸºäºè¿™ä¸¤ä¸ªåŒºåˆ«æ¥å†³å®šå®ƒåº”è¯¥å­˜æ”¾äºå“ªä¸ªç›®å½•ã€‚ å¯åˆ†äº«ï¼šå­˜å‚¨åœ¨ä¸€å°ä¸»æœºä¸­çš„æ–‡ä»¶å¯ä»¥è¢«å…¶ä»–ä¸»æœºä½¿ç”¨ï¼› ä¸å¯åˆ†äº«ï¼šå³ä¸å¯åˆ†äº«çš„æ–‡ä»¶ï¼› é™æ€ï¼šåŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶ã€åº“æ–‡ä»¶ã€æ–‡æ¡£æ–‡ä»¶å’Œå…¶ä»–åœ¨æ²¡æœ‰ç®¡ç†å‘˜å¹²é¢„ä¸‹æ— æ³•æ”¹åŠ¨çš„æ–‡ä»¶ï¼› åŠ¨æ€ï¼šå³éé™æ€çš„ã€‚ ç›¸å…³è¯´æ˜ï¼š å¯åˆ†äº«æ–‡ä»¶å¯ä»¥è¢«å…¶ä»–ä¸»æœºä½¿ç”¨ï¼Œç„¶è€Œå¹¶ä¸æ˜¯æ‰€ç”¨æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡æ¶æ„ä¸­çš„æ–‡ä»¶éƒ½æ˜¯å¯åˆ†äº«çš„ï¼Œå³ç³»ç»Ÿéƒ½æ˜¯æœ‰ä¸€äº›æœ¬åœ°å­˜å‚¨åŒ…æ‹¬åœ¨ä¸å¯åˆ†äº«æ–‡ä»¶ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ‰€éœ€è¦çš„æ–‡ä»¶éƒ½å­˜å‚¨åœ¨å¦ä¸€å°ä¸»æœºä¸­ï¼Œé€šè¿‡æŒ‚è½½åœ¨æœ¬æœºä¸­æŒ‚è½½å‡ ä¸ªç›®å½•å°†ä½¿å¾—è®¿é—®è¿™äº›æ–‡ä»¶å˜å¾—æä¸ºæ–¹ä¾¿ã€‚ é™æ€æ–‡ä»¶ä¸åŠ¨æ€æ–‡ä»¶å¿…é¡»è¦åšå‡ºéš”ç¦»ï¼Œå› ä¸ºé™æ€æ–‡ä»¶ä¸åƒæ˜¯åŠ¨æ€æ–‡ä»¶ï¼Œå®ƒå¯ä»¥å·²åªè¯»çš„å½¢å¼è¢«å­˜å‚¨åœ¨åª’ä»‹ä¸Šï¼Œå¹¶ä¸”ä¸éœ€è¦åƒåŠ¨æ€æ–‡ä»¶ä¸€æ ·å®šæœŸçš„è¿›è¡Œå¤‡ä»½ã€‚ ä»¥ä¸‹æ˜¯éµå¾ªæ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡æ¶æ„æ ‡å‡†çš„ç¤ºä¾‹ï¼š Shareable Unshareable static /usr /etc /opt /boot variable /var/mail /var/run /var/spool/news /var/lock 3.æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•","link":"/2019/07/08/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/"},{"title":"Linuxç”¨æˆ·æƒé™ç®¡ç†","text":"æŒ‡ä»¤ æ·»åŠ ç”¨æˆ· useradd -d /home/test test -mï¼Œåˆ›å»ºç”¨æˆ·test(è‡ªåŠ¨ç”Ÿæˆç›®å½•)ï¼Œè¯¥ç”¨æˆ·å±äºtestç”¨æˆ·ç»„ useradd -d /home/a a -g test -mï¼Œåˆ›å»ºç”¨æˆ·aï¼Œå±äºtestç”¨æˆ·ç»„ -dï¼šæŒ‡å®šç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶çš„ä¸»ç›®å½• -mï¼šè‡ªåŠ¨å»ºç«‹ç›®å½• -gï¼šæŒ‡å®šç»„åç§° è®¾ç½®å¯†ç  passwd test åˆ é™¤ç”¨æˆ· userdel teståˆ é™¤testç”¨æˆ·ï¼Œä½†å¹¶ä¸åˆ é™¤/home/test userdel -r teståˆ é™¤testç”¨æˆ·ä¸å…¶ç›®å½• åˆ‡æ¢ç”¨æˆ· su æŸ¥çœ‹å½“å‰ç”¨æˆ·ç»„ cat /etc/group groupmod+ä¸‰æ¬¡tabé”® ç»„è´¦å·æ“ä½œ æ·»åŠ ç»„ï¼šgroupadd åˆ é™¤ç»„ï¼šgroupdel æŸ¥çœ‹ç»„ï¼šcat /etc/group ä¿®æ”¹ç”¨æˆ·æ‰€åœ¨ç»„ï¼šusermod -g group_name user_name æŸ¥çœ‹ç”¨æˆ·ç»„æˆå‘˜ groups group_name ä¸ºæ–°ç”¨æˆ·æ·»åŠ sudoæƒé™ sudo usermod -a -G adm user_name sudo usermod -a -G sudo user_name å®ä¾‹ï¼š linuxç¯å¢ƒä¸‹åˆ›å»ºæ–°ç”¨æˆ·åœ¨ä½¿ç”¨dockerä¸­ä¼šé‡åˆ°permission deniedçš„é—®é¢˜ï¼Œè¿™æ˜¯ç”±äºdockerå¯åŠ¨å®ˆæŠ¤è¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šé»˜è®¤èµ‹äºˆdockerç”¨æˆ·ç»„çš„æˆå‘˜è¯»å†™unix socketçš„æƒé™ï¼Œå› æ­¤ï¼Œå°†æ–°ç”¨æˆ·åŠ å…¥åˆ°dockerç”¨æˆ·ç»„ä¸­ï¼Œé—®é¢˜å°±å¯ä»¥è§£å†³äº†ï¼š sudo usermod -a -G docker zjs ä¹‹åéœ€è¦æ›´æ–°ç”¨æˆ·ç»„newgrp docker ä¿®æ”¹æ–‡ä»¶æƒé™ å­—æ¯æ³•ï¼šchmod u/g/o/a +/-/= rwx file_name æ‰€æœ‰è€… å«ä¹‰ u user g group o other a all + - = å«ä¹‰ + å¢åŠ æƒé™ - æ’¤é”€æƒé™ = è®¾å®šæƒé™ r w x å«ä¹‰ r read w write x excute æ•°å­—æ³•ï¼š chomod 777 test/ -R -Rè¡¨ç¤ºçº§è”æˆæƒ 777ï¼šæ‰€æœ‰è€…ç”¨æˆ·/ç»„å†…å…¶ä»–ç”¨æˆ·/å…¶ä»–ç»„ç”¨æˆ· = rwx/rwx/rwx ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€… chown user_name file_name ä¿®æ”¹æ–‡ä»¶æ‰€å±ç»„ chgrp group_name file_name æ“ä½œæ·»åŠ ç”¨æˆ·èµ‹äºˆæƒé™ï¼š sudo vi /etc/sudoers åœ¨root ALL=(ALL) ALLä¸‹æ·»åŠ ä¸€è¡Œtest ALL=(ALL) ALL","link":"/2019/07/08/Linux%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/"},{"title":"[NOTE] Linuxé˜²ç«å¢™","text":"CentOS firewalldFirewalld is installed on CentOS 7 as default. Here comes some operations of it. Check firewall status: sudo firewall-cmd --state Disable firewalld: sudo systemctl disable firewalld(ç¦æ­¢å¼€æœºå¯åŠ¨) Stop firewalld: sudo systemctl stop firewalld Ubuntu 18.04 ufw check a current firewall status:sudo ufw status for more verbose:sudo ufw status verbose enable firewall:sudo ufw enable disable firewall:sudo ufw disable åŸºæ“ï¼š sudo ufw default deny incoming sudo ufw default allow outgoing sudo ufw allow ssh or sudo ufw allow 22 sudo ufw allow 2222 sudo ufw allow http or sudo ufw allow 80 sudo ufw allow https or sudo ufw allow 443 sudo ufw allow 6000:6003/tcp sudo ufw allow 6000:6003/udp","link":"/2019/07/08/Linux%E9%98%B2%E7%81%AB%E5%A2%99/"},{"title":"Poker2é”®ç›˜è¯´æ˜ä¹¦(é˜²é—å¤±)","text":"ç¼–ç¨‹è¯´æ˜ æŒ‰PModeï¼ˆFN+å³CTRLï¼‰è¿›å…¥ç¼–ç¨‹æ¨¡å¼ï¼ˆç©ºæ ¼å³ç¯é—ªçƒï¼‰ æŒ‰æƒ³è¦å¯¹å…¶ç¼–ç¨‹çš„å»ºï¼ˆç©ºæ ¼å³ç¯é•¿äº®ï¼‰ é”®å…¥ç¼–ç¨‹å†…å®¹ç„¶åæŒ‰PNï¼ˆç©ºæ ¼å³ç¯å†æ¬¡é—ªçƒï¼‰\\ é‡å¤æ­¥éª¤2å’Œæ­¥éª¤3å¯ç¼–ç¨‹å…¶ä»–é”® æŒ‰PModeï¼ˆFN+å³CTRLï¼‰é€€å‡ºç¼–ç¨‹æ¨¡å¼ï¼ˆç©ºæ ¼å³ç¯ç†„ç­ï¼‰ å¤‡æ³¨ï¼š æ”¯æŒFNå±‚ç¼–ç¨‹ï¼Œåœ¨é€‰é”®çŠ¶æ€æ—¶å¯ä»¥å¯¹FNç»„åˆé”®ï¼ˆä¾‹å¦‚ï¼šFN+Aï¼‰ç¼–ç¨‹ åœ¨é€‰é”®çŠ¶æ€ï¼ˆæ­¥éª¤1ï¼‰æ‰“å¼€æ–‡ä¹¦è½¯ä»¶ï¼ˆæ¯”å¦‚.txtå‹æ–‡æœ¬æ–‡æ¡£ï¼‰å¹¶æŒ‰PN+ä»»æ„é”®å¯è‡ªåŠ¨åˆ†å±‚æ˜¾ç¤ºå…¶ç¼–ç¨‹å†…å®¹ å¯ä»¥åŠ å»¶æ—¶ï¼Œæ¯æŒ‰15smé”®ï¼ˆFN+Fï¼‰ä¸€æ¬¡å»¶æ—¶15msï¼Œæ¯æŒ‰0.1sé”®ï¼ˆFN+Gï¼‰ä¸€æ¬¡å»¶æ—¶0.1sï¼Œæ¯æŒ‰0.5sé”®ï¼ˆFN+Hï¼‰ä¸€æ¬¡å»¶æ—¶0.5sï¼Œè¿ç»­å¤šæ¬¡å»¶æ—¶åªè®¡ä¸€ä¸ªæŒ‰é”®ä½†æ—¶é—´ç´¯åŠ  æ¯ä¸ªé”®æœ€å¤šå¯ä»¥ç¼–ç¨‹14ä¸ªé”®åœ¨ç¼–ç¨‹æ¨¡å¼15ç§’å†…æ²¡æŒ‰ä»»ä½•é”®ä¼šè‡ªåŠ¨é€€å‡º åŠŸèƒ½è¡¨æ ¼","link":"/2019/07/05/Poker2%E9%94%AE%E7%9B%98%E8%AF%B4%E6%98%8E%E4%B9%A6-%E9%98%B2%E9%81%97%E5%A4%B1/"},{"title":"[Script] è„šæœ¬ä¹±å†™I","text":"Shellè„šæœ¬ä¹±å†™ï¼ˆä¸€ï¼‰1. è‡ªåŠ¨æ–°å¢ç”¨æˆ·å¹¶é…ç½®æƒé™è¦å®ç°ï¼š è¯»å–å‚æ•°ï¼šé€‰å®šè¿è¡Œä¸»æœºã€ç”¨æˆ·å æ–°å»ºç”¨æˆ·åˆ°ç»„ usreadd -G ä¸ºç”¨æˆ·é…ç½®é»˜è®¤å¯†ç ï¼šcentosä¸­ä¸ºç”¨æˆ·é…ç½®é»˜è®¤å¯†ç å¯ä»¥ä½¿ç”¨passwd --stdin USERNAMEï¼Œåœ¨è„šæœ¬ä¸­å¯ä»¥ä½¿ç”¨echo &quot;PASSWORD&quot; ï½œ passwd --stdin USERNAMEï¼Œä½†åœ¨Ubuntuä¸­passwdå¹¶ä¸æ”¯æŒ--stdinï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨echo USERNAME:PASSWORD | chpasswd äº‹å…ˆå°†ç”¨æˆ·ç»„åŠ å…¥åˆ°/etc/sudoersä¸­ ç”¨æˆ·é¦–æ¬¡ç™»é™†æ—¶æç¤ºéœ€è¦ä¿®æ”¹å¯†ç ï¼Œç”¨æˆ·æ¿€æ´»æ—¶é™ä¸º2å¹´ chage 123456789101112131415#!/bin/bash# Program:# Grand a new user with ROOT privileges.## History:# 2019/11/9 Fusidic First releaseecho \"Please input username\"read usernamepath='/root/bin/hosts'cat /root/bin/hosts | while read line;do echo $line ssh -n $line \"useradd ${username} -m -G AWG &amp;\" ssh -n $line \"echo \"${username}:nuaacs204\" | chpasswd &amp;\"# ssh -n $line \"chage -d 0 ${username} &amp;\"done é‡åˆ°çš„é—®é¢˜ï¼š whileå¾ªç¯åªæ‰§è¡Œä¸€æ¬¡ï¼Œåæ·»åŠ äº†-nå‚æ•° æ–°å»ºç”¨æˆ·ä¿®æ”¹æƒé™å¤±è´¥passwd: Authentication token manipulation error passwd: password unchangedï¼Œè¿™æ˜¯ç”±äºæœ‰æƒé™æ”¹/etc/passwdè€Œæ— æƒé™ä¿®æ”¹/etc/shadow æœªè§£å†³ï¼šä½¿ç”¨chageä¿®æ”¹ç”¨æˆ·æœ‰æ•ˆæ—¶é—´ï¼Œä»¥æ­¤è¾¾åˆ°è®©ç”¨æˆ·ç™»é™†è´¦æˆ·ç«‹å³å¼ºåˆ¶æ”¹å¯†ç å­˜åœ¨é—®é¢˜ï¼Œæ”¹å¯†ç æ— æ•ˆï¼Œå¯èƒ½æ˜¯æƒé™é—®é¢˜ã€‚","link":"/2019/11/11/Shell%E8%84%9A%E6%9C%AC%E4%B9%B1%E5%86%991/"},{"title":"[SpringCloud] ç¬”è®°(ä¸€)","text":"power by æ¥ å“¥æ•™ä½ å­¦Java å•ä½“åº”ç”¨å­˜åœ¨çš„é—®é¢˜ éšç€ä¸šåŠ¡çš„å‘å±•ï¼Œå¼€å‘å˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚ ä¿®æ”¹ã€æ–°å¢æŸä¸ªåŠŸèƒ½ï¼Œéœ€è¦å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œæµ‹è¯•ã€é‡æ–°éƒ¨ç½²ã€‚ ä¸€ä¸ªæ¨¡å—å‡ºç°é—®é¢˜ï¼Œå¾ˆå¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚ å¤šä¸ªå¼€å‘å›¢é˜ŸåŒæ—¶å¯¹æ•°æ®è¿›è¡Œç®¡ç†ï¼Œå®¹æ˜“äº§ç”Ÿå®‰å…¨æ¼æ´ã€‚ å„ä¸ªæ¨¡å—ä½¿ç”¨åŒä¸€ç§æŠ€æœ¯è¿›è¡Œå¼€å‘ï¼Œå„ä¸ªæ¨¡å—å¾ˆéš¾æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©æ›´åˆé€‚çš„æŠ€æœ¯æ¡†æ¶ï¼Œå±€é™æ€§å¾ˆå¤§ã€‚ æ¨¡å—å†…å®¹è¿‡äºå¤æ‚ï¼Œå¦‚æœå‘˜å·¥ç¦»èŒï¼Œå¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆå·¥ä½œäº¤æ¥ã€‚ åˆ†å¸ƒå¼ã€é›†ç¾¤ é›†ç¾¤ï¼šä¸€å°æœåŠ¡å™¨æ— æ³•è´Ÿè·é«˜å¹¶å‘çš„æ•°æ®è®¿é—®é‡ï¼Œé‚£ä¹ˆå°±è®¾ç½®åå°æœåŠ¡å™¨ä¸€èµ·åˆ†æ‹…å‹åŠ›ï¼Œåå°ä¸è¡Œå°±è®¾ç½®ä¸€ç™¾å°ï¼ˆç‰©ç†å±‚é¢ï¼‰ã€‚å¾ˆå¤šäººå¹²åŒä¸€ä»¶äº‹æƒ…ï¼Œæ¥åˆ†æ‘Šå‹åŠ›ã€‚ åˆ†å¸ƒå¼ï¼šå°†ä¸€ä¸ªå¤æ‚é—®é¢˜æ‹†åˆ†æˆè‹¥å¹²ä¸ªç®€å•çš„å°é—®é¢˜ï¼Œå°†ä¸€ä¸ªå¤§å‹çš„é¡¹ç›®æ¶æ„æ‹†åˆ†æˆè‹¥å¹²ä¸ªå¾®æœåŠ¡æ¥ååŒå®Œæˆã€‚ï¼ˆè½¯ä»¶è®¾è®¡å±‚é¢ï¼‰ã€‚å°†ä¸€ä¸ªåºå¤§çš„å·¥ä½œæ‹†åˆ†æˆè‹¥å¹²ä¸ªå°æ­¥éª¤ï¼Œåˆ†åˆ«ç”±ä¸åŒçš„äººå®Œæˆè¿™äº›å°æ­¥éª¤ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„ç»“æœè¿›è¡Œæ•´åˆå®ç°å¤§çš„éœ€æ±‚ã€‚ æœåŠ¡æ²»ç†çš„æ ¸å¿ƒåˆä¸‰éƒ¨åˆ†ç»„æˆï¼šæœåŠ¡æä¾›è€…ã€æœåŠ¡æ¶ˆè´¹è€…ã€æ³¨å†Œä¸­å¿ƒã€‚ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ï¼Œæ¯ä¸ªå¾®æœåŠ¡åœ¨å¯åŠ¨æ—¶ï¼Œå°†è‡ªå·±çš„ä¿¡æ¯å­˜å‚¨åœ¨æ³¨å†Œä¸­å¿ƒï¼Œå«åšæœåŠ¡æ³¨å†Œã€‚ æœåŠ¡æ¶ˆè´¹è€…ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æä¾›è€…çš„ç½‘ç»œä¿¡æ¯ï¼Œé€šè¿‡è¯¥ä¿¡æ¯è°ƒç”¨æœåŠ¡ï¼Œå«åšæœåŠ¡å‘ç°ã€‚ Spring Cloud çš„æœåŠ¡æ²»ç†ä½¿ç”¨ Eureka æ¥å®ç°ï¼ŒEureka æ˜¯ Netflix å¼€æºçš„åŸºäº REST çš„æœåŠ¡æ²»ç†è§£å†³æ–¹æ¡ˆï¼ŒSpring Cloud é›†æˆäº† Eurekaï¼Œæä¾›æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°çš„åŠŸèƒ½ï¼Œå¯ä»¥å’ŒåŸºäº Spring Boot æ­å»ºçš„å¾®æœåŠ¡åº”ç”¨è½»æ¾å®Œæˆæ•´åˆï¼Œå¼€ç®±å³ç”¨ï¼ŒSpring Cloud Eurekaã€‚ Spring Cloud Eureka Eureka Serverï¼Œæ³¨å†Œä¸­å¿ƒ Eureka Clientï¼Œæ‰€æœ‰è¦è¿›è¡Œæ³¨å†Œçš„å¾®æœåŠ¡é€šè¿‡ Eureka Client è¿æ¥åˆ° Eureka Serverï¼Œå®Œæˆæ³¨å†Œã€‚ Eureka Serverä»£ç å®ç° åˆ›å»ºçˆ¶å·¥ç¨‹ï¼Œpom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.7.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- è§£å†³ JDK 9 ä»¥ä¸Šæ²¡æœ‰ JAXB API çš„é—®é¢˜ --&gt; &lt;dependency&gt; &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt; &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt; &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt; &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.activation&lt;/groupId&gt; &lt;artifactId&gt;activation&lt;/artifactId&gt; &lt;version&gt;1.1.1&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.SR2&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; åœ¨çˆ¶å·¥ç¨‹ä¸‹åˆ›å»º Moduleï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.ymlï¼Œæ·»åŠ  Eureka Server ç›¸å…³é…ç½®ã€‚ 12345678server: port: 8761eureka: client: register-with-eureka: false fetch-registry: false service-url: defaultZone: http://localhost:8761/eureka/ å±æ€§è¯´æ˜ server.portï¼šå½“å‰ Eureka Server æœåŠ¡ç«¯å£ã€‚ eureka.client.register-with-eurekaï¼šæ˜¯å¦å°†å½“å‰çš„ Eureka Server æœåŠ¡ä½œä¸ºå®¢æˆ·ç«¯è¿›è¡Œæ³¨å†Œã€‚ eureka.client.fetch-fegistryï¼šæ˜¯å¦è·å–å…¶ä»– Eureka Server æœåŠ¡çš„æ•°æ®ã€‚ eureka.client.service-url.defaultZoneï¼šæ³¨å†Œä¸­å¿ƒçš„è®¿é—®åœ°å€ã€‚ åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args) { SpringApplication.run(EurekaServerApplication.class,args); }} æ³¨è§£è¯´æ˜ï¼š @SpringBootApplicationï¼šå£°æ˜è¯¥ç±»æ˜¯ Spring Boot æœåŠ¡çš„å…¥å£ã€‚ @EnableEurekaServerï¼šå£°æ˜è¯¥ç±»æ˜¯ä¸€ä¸ª Eureka Server å¾®æœåŠ¡ï¼Œæä¾›æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°åŠŸèƒ½ï¼Œå³æ³¨å†Œä¸­å¿ƒã€‚ Eureka Client ä»£ç å®ç° åˆ›å»º Module ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.ymlï¼Œæ·»åŠ  Eureka Client ç›¸å…³é…ç½® 1234567891011server: port: 8010spring: application: name: providereureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: true å±æ€§è¯´æ˜ï¼š spring.application.nameï¼šå½“å‰æœåŠ¡æ³¨å†Œåœ¨ Eureka Server ä¸Šçš„åç§°ã€‚ eureka.client.service-url.defaultZoneï¼šæ³¨å†Œä¸­å¿ƒçš„è®¿é—®åœ°å€ã€‚ eureka.instance.prefer-ip-addressï¼šæ˜¯å¦å°†å½“å‰æœåŠ¡çš„ IP æ³¨å†Œåˆ° Eureka Serverã€‚ åˆ›å»ºå¯åŠ¨ç±» 1234567891011package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class,args); }} å®ä½“ç±» 1234567891011121314package com.southwind.entity;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;@Data@AllArgsConstructor@NoArgsConstructorpublic class Student { private long id; private String name; private int age;} Repository 123456789101112package com.southwind.repository;import com.southwind.entity.Student;import java.util.Collection;public interface StudentRepository { public Collection&lt;Student&gt; findAll(); public Student findById(long id); public void saveOrUpdate(Student student); public void deleteById(long id);} RepositoryImpl 123456789101112131415161718192021222324252627282930313233343536373839404142package com.southwind.repository.impl;import com.southwind.entity.Student;import com.southwind.repository.StudentRepository;import org.springframework.stereotype.Repository;import java.util.Collection;import java.util.HashMap;import java.util.Map;@Repositorypublic class StudentRepositoryImpl implements StudentRepository { private static Map&lt;Long,Student&gt; studentMap; static { studentMap = new HashMap&lt;&gt;(); studentMap.put(1L,new Student(1L,\"å¼ ä¸‰\",22)); studentMap.put(2L,new Student(2L,\"æå››\",23)); studentMap.put(3L,new Student(3L,\"ç‹äº”\",24)); } @Override public Collection&lt;Student&gt; findAll() { return studentMap.values(); } @Override public Student findById(long id) { return studentMap.get(id); } @Override public void saveOrUpdate(Student student) { studentMap.put(student.getId(),student); } @Override public void deleteById(long id) { studentMap.remove(id); }} Handler 12345678910111213141516171819202122232425262728293031323334353637383940package com.southwind.controller;import com.southwind.entity.Student;import com.southwind.repository.StudentRepository;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import java.util.Collection;@RestController@RequestMapping(\"/student\")public class StudentHandler { @Autowired private StudentRepository studentRepository; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return studentRepository.findAll(); } @GetMapping(\"/findById/{id}\") public Student findById(@PathVariable(\"id\") long id){ return studentRepository.findById(id); } @PostMapping(\"/save\") public void save(@RequestBody Student student){ studentRepository.saveOrUpdate(student); } @PutMapping(\"/update\") public void update(@RequestBody Student student){ studentRepository.saveOrUpdate(student); } @DeleteMapping(\"/deleteById/{id}\") public void deleteById(@PathVariable(\"id\") long id){ studentRepository.deleteById(id); }} RestTemplate çš„ä½¿ç”¨ ä»€ä¹ˆæ˜¯ RestTemplateï¼Ÿ RestTemplate æ˜¯ Spring æ¡†æ¶æä¾›çš„åŸºäº REST çš„æœåŠ¡ç»„ä»¶ï¼Œåº•å±‚æ˜¯å¯¹ HTTP è¯·æ±‚åŠå“åº”è¿›è¡Œäº†å°è£…ï¼Œæä¾›äº†å¾ˆå¤šè®¿é—® RETS æœåŠ¡çš„æ–¹æ³•ï¼Œå¯ä»¥ç®€åŒ–ä»£ç å¼€å‘ã€‚ å¦‚ä½•ä½¿ç”¨ RestTemplateï¼Ÿ 1ã€åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xmlã€‚ 2ã€åˆ›å»ºå®ä½“ç±» 1234567891011121314package com.southwind.entity;import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor;@Data@AllArgsConstructor@NoArgsConstructorpublic class Student { private long id; private String name; private int age;} 3ã€Handler 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455package com.southwind.controller;import com.southwind.entity.Student;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import org.springframework.web.client.RestTemplate;import java.util.Collection;@RestController@RequestMapping(\"/rest\")public class RestHandler { @Autowired private RestTemplate restTemplate; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return restTemplate.getForEntity(\"http://localhost:8010/student/findAll\",Collection.class).getBody(); } @GetMapping(\"/findAll2\") public Collection&lt;Student&gt; findAll2(){ return restTemplate.getForObject(\"http://localhost:8010/student/findAll\",Collection.class); } @GetMapping(\"/findById/{id}\") public Student findById(@PathVariable(\"id\") long id){ return restTemplate.getForEntity(\"http://localhost:8010/student/findById/{id}\",Student.class,id).getBody(); } @GetMapping(\"/findById2/{id}\") public Student findById2(@PathVariable(\"id\") long id){ return restTemplate.getForObject(\"http://localhost:8010/student/findById/{id}\",Student.class,id); } @PostMapping(\"/save\") public void save(@RequestBody Student student){ restTemplate.postForEntity(\"http://localhost:8010/student/save\",student,null).getBody(); } @PostMapping(\"/save2\") public void save2(@RequestBody Student student){ restTemplate.postForObject(\"http://localhost:8010/student/save\",student,null); } @PutMapping(\"/update\") public void update(@RequestBody Student student){ restTemplate.put(\"http://localhost:8010/student/update\",student); } @DeleteMapping(\"/deleteById/{id}\") public void deleteById(@PathVariable(\"id\") long id){ restTemplate.delete(\"http://localhost:8010/student/deleteById/{id}\",id); }} 4ã€å¯åŠ¨ç±» 123456789101112131415161718package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.context.annotation.Bean;import org.springframework.web.client.RestTemplate;@SpringBootApplicationpublic class RestTemplateApplication { public static void main(String[] args) { SpringApplication.run(RestTemplateApplication.class,args); } @Bean public RestTemplate restTemplate(){ return new RestTemplate(); }} æœåŠ¡æ¶ˆè´¹è€… consumer åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 1234567891011server: port: 8020spring: application: name: consumereureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: true åˆ›å»ºå¯åŠ¨ç±» 123456789101112131415161718package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.context.annotation.Bean;import org.springframework.web.client.RestTemplate;@SpringBootApplicationpublic class ConsumerApplication { public static void main(String[] args) { SpringApplication.run(ConsumerApplication.class,args); } @Bean public RestTemplate restTemplate(){ return new RestTemplate(); }} Handler 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455package com.southwind.controller;import com.southwind.entity.Student;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import org.springframework.web.client.RestTemplate;import java.util.Collection;@RestController@RequestMapping(\"/consumer\")public class ConsumerHandler { @Autowired private RestTemplate restTemplate; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return restTemplate.getForEntity(\"http://localhost:8010/student/findAll\",Collection.class).getBody(); } @GetMapping(\"/findAll2\") public Collection&lt;Student&gt; findAll2(){ return restTemplate.getForObject(\"http://localhost:8010/student/findAll\",Collection.class); } @GetMapping(\"/findById/{id}\") public Student findById(@PathVariable(\"id\") long id){ return restTemplate.getForEntity(\"http://localhost:8010/student/findById/{id}\",Student.class,id).getBody(); } @GetMapping(\"/findById2/{id}\") public Student findById2(@PathVariable(\"id\") long id){ return restTemplate.getForObject(\"http://localhost:8010/student/findById/{id}\",Student.class,id); } @PostMapping(\"/save\") public void save(@RequestBody Student student){ restTemplate.postForEntity(\"http://localhost:8010/student/save\",student,null).getBody(); } @PostMapping(\"/save2\") public void save2(@RequestBody Student student){ restTemplate.postForObject(\"http://localhost:8010/student/save\",student,null); } @PutMapping(\"/update\") public void update(@RequestBody Student student){ restTemplate.put(\"http://localhost:8010/student/update\",student); } @DeleteMapping(\"/deleteById/{id}\") public void deleteById(@PathVariable(\"id\") long id){ restTemplate.delete(\"http://localhost:8010/student/deleteById/{id}\",id); }} æœåŠ¡ç½‘å…³Spring Cloud é›†æˆäº† Zuul ç»„ä»¶ï¼Œå®ç°æœåŠ¡ç½‘å…³ã€‚ ä»€ä¹ˆæ˜¯ Zuulï¼Ÿ Zuul æ˜¯ Netflix æä¾›çš„ä¸€ä¸ªå¼€æºçš„ API ç½‘å…³æœåŠ¡å™¨ï¼Œæ˜¯å®¢æˆ·ç«¯å’Œç½‘ç«™åç«¯æ‰€æœ‰è¯·æ±‚çš„ä¸­é—´å±‚ï¼Œå¯¹å¤–å¼€æ”¾ä¸€ä¸ª APIï¼Œå°†æ‰€æœ‰è¯·æ±‚å¯¼å…¥ç»Ÿä¸€çš„å…¥å£ï¼Œå±è”½äº†æœåŠ¡ç«¯çš„å…·ä½“å®ç°é€»è¾‘ï¼ŒZuul å¯ä»¥å®ç°åå‘ä»£ç†çš„åŠŸèƒ½ï¼Œåœ¨ç½‘å…³å†…éƒ¨å®ç°åŠ¨æ€è·¯ç”±ã€èº«ä»½è®¤è¯ã€IP è¿‡æ»¤ã€æ•°æ®ç›‘æ§ç­‰ã€‚ åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 12345678910111213&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 123456789101112server: port: 8030spring: application: name: gatewayeureka: client: service-url: defaultZone: http://localhost:8761/eureka/zuul: routes: provider: /p/** å±æ€§è¯´æ˜ï¼š zuul.routes.providerï¼šç»™æœåŠ¡æä¾›è€… provider è®¾ç½®æ˜ å°„ åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.EnableAutoConfiguration;import org.springframework.cloud.netflix.zuul.EnableZuulProxy;@EnableZuulProxy@EnableAutoConfigurationpublic class ZuulApplication { public static void main(String[] args) { SpringApplication.run(ZuulApplication.class,args); }} æ³¨è§£è¯´æ˜ï¼š @EnableZuulProxyï¼šåŒ…å«äº† @EnableZuulServerï¼Œè®¾ç½®è¯¥ç±»æ˜¯ç½‘å…³çš„å¯åŠ¨ç±»ã€‚ @EnableAutoConfigurationï¼šå¯ä»¥å¸®åŠ© Spring Boot åº”ç”¨å°†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ @Configuration é…ç½®åŠ è½½åˆ°å½“å‰ Spring Boot åˆ›å»ºå¹¶ä½¿ç”¨çš„ IoC å®¹å™¨ä¸­ã€‚ Zuul è‡ªå¸¦äº†è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œä¿®æ”¹ provider çš„ä»£ç ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package com.southwind.controller;import com.southwind.entity.Student;import com.southwind.repository.StudentRepository;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.*;import java.util.Collection;@RestController@RequestMapping(\"/student\")public class StudentHandler { @Autowired private StudentRepository studentRepository; @Value(\"${server.port}\") private String port; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return studentRepository.findAll(); } @GetMapping(\"/findById/{id}\") public Student findById(@PathVariable(\"id\") long id){ return studentRepository.findById(id); } @PostMapping(\"/save\") public void save(@RequestBody Student student){ studentRepository.saveOrUpdate(student); } @PutMapping(\"/update\") public void update(@RequestBody Student student){ studentRepository.saveOrUpdate(student); } @DeleteMapping(\"/deleteById/{id}\") public void deleteById(@PathVariable(\"id\") long id){ studentRepository.deleteById(id); } @GetMapping(\"/index\") public String index(){ return \"å½“å‰ç«¯å£ï¼š\"+this.port; }} Ribbon è´Ÿè½½å‡è¡¡ ä»€ä¹ˆæ˜¯ Ribbonï¼Ÿ Spring Cloud Ribbon æ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆï¼ŒRibbon æ˜¯ Netflix å‘å¸ƒçš„è´Ÿè½½å‡è¡¡å™¨ï¼ŒSpring Cloud Ribbon æ˜¯åŸºäº Netflix Ribbon å®ç°çš„ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå¯¹ HTTP è¯·æ±‚è¿›è¡Œæ§åˆ¶çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ã€‚ åœ¨æ³¨å†Œä¸­å¿ƒå¯¹ Ribbon è¿›è¡Œæ³¨å†Œä¹‹åï¼ŒRibbon å°±å¯ä»¥åŸºäºæŸç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¦‚è½®è¯¢ã€éšæœºã€åŠ æƒè½®è¯¢ã€åŠ æƒéšæœºç­‰è‡ªåŠ¨å¸®åŠ©æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨æ¥å£ï¼Œå¼€å‘è€…ä¹Ÿå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è‡ªå®šä¹‰ Ribbon è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚å®é™…å¼€å‘ä¸­ï¼ŒSpring Cloud Ribbon éœ€è¦ç»“åˆ Spring Cloud Eureka æ¥ä½¿ç”¨ï¼ŒEureka Server æä¾›æ‰€æœ‰å¯ä»¥è°ƒç”¨çš„æœåŠ¡æä¾›è€…åˆ—è¡¨ï¼ŒRibbon åŸºäºç‰¹å®šçš„è´Ÿè½½å‡è¡¡ç®—æ³•ä»è¿™äº›æœåŠ¡æä¾›è€…ä¸­é€‰æ‹©è¦è°ƒç”¨çš„å…·ä½“å®ä¾‹ã€‚ åˆ›å»º Moduleï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 1234567891011server: port: 8040spring: application: name: ribboneureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: true åˆ›å»ºå¯åŠ¨ç±» 1234567891011121314151617181920package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.client.loadbalancer.LoadBalanced;import org.springframework.context.annotation.Bean;import org.springframework.web.client.RestTemplate;@SpringBootApplicationpublic class RibbonApplication { public static void main(String[] args) { SpringApplication.run(RibbonApplication.class,args); } @Bean @LoadBalanced public RestTemplate restTemplate(){ return new RestTemplate(); }} @LoadBalancedï¼šå£°æ˜ä¸€ä¸ªåŸºäº Ribbon çš„è´Ÿè½½å‡è¡¡ã€‚ Handler 123456789101112131415161718192021222324252627package com.southwind.controller;import com.southwind.entity.Student;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import org.springframework.web.client.RestTemplate;import java.util.Collection;@RestController@RequestMapping(\"/ribbon\")public class RibbonHandler { @Autowired private RestTemplate restTemplate; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return restTemplate.getForObject(\"http://provider/student/findAll\",Collection.class); } @GetMapping(\"/index\") public String index(){ return restTemplate.getForObject(\"http://provider/student/index\",String.class); }} Feign ä»€ä¹ˆæ˜¯ Feignï¼Ÿ ä¸ Ribbon ä¸€æ ·ï¼ŒFeign ä¹Ÿæ˜¯ç”± Netflix æä¾›çš„ï¼ŒFeign æ˜¯ä¸€ä¸ªå£°æ˜å¼ã€æ¨¡ç‰ˆåŒ–çš„ Web Service å®¢æˆ·ç«¯ï¼Œå®ƒç®€åŒ–äº†å¼€å‘è€…ç¼–å†™ Web æœåŠ¡å®¢æˆ·ç«¯çš„æ“ä½œï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡ç®€å•çš„æ¥å£å’Œæ³¨è§£æ¥è°ƒç”¨ HTTP APIï¼ŒSpring Cloud Feignï¼Œå®ƒæ•´åˆäº† Ribbon å’Œ Hystrixï¼Œå…·æœ‰å¯æ’æ‹”ã€åŸºäºæ³¨è§£ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡ç†”æ–­ç­‰ä¸€ç³»åˆ—ä¾¿æ·åŠŸèƒ½ã€‚ ç›¸æ¯”è¾ƒäº Ribbon + RestTemplate çš„æ–¹å¼ï¼ŒFeign å¤§å¤§ç®€åŒ–äº†ä»£ç çš„å¼€å‘ï¼ŒFeign æ”¯æŒå¤šç§æ³¨è§£ï¼ŒåŒ…æ‹¬ Feign æ³¨è§£ã€JAX-RS æ³¨è§£ã€Spring MVC æ³¨è§£ç­‰ï¼ŒSpring Cloud å¯¹ Feing è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæ•´åˆäº† Ribbon å’Œ Eurekaï¼Œä»è€Œè®© Feign çš„ä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚ Ribbon å’Œ Feign çš„åŒºåˆ« Ribbon æ˜¯ä¸€ä¸ªé€šç”¨çš„ HTTP å®¢æˆ·ç«¯å·¥å…·ï¼ŒFeign æ˜¯åŸºäº Ribbon å®ç°çš„ã€‚ Feign çš„tedian 1ã€Feign æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„ Web Service å®¢æˆ·ç«¯ã€‚ 2ã€æ”¯æŒ Feign æ³¨è§£ã€Spring MVC æ³¨è§£ã€JAX-RS æ³¨è§£ã€‚ 3ã€Feign åŸºäº Ribbon å®ç°ï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç®€å•ã€‚ 4ã€Feign é›†æˆäº† Hystrixï¼Œå…·å¤‡æœåŠ¡ç†”æ–­çš„åŠŸèƒ½ã€‚ åˆ›å»º Moduleï¼Œpom.xml 12345678910111213&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 1234567891011server: port: 8050spring: application: name: feigneureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: true åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.openfeign.EnableFeignClients;@SpringBootApplication@EnableFeignClientspublic class FeignApplication { public static void main(String[] args) { SpringApplication.run(FeignApplication.class,args); }} åˆ›å»ºå£°æ˜å¼æ¥å£ 12345678910111213141516package com.southwind.feign;import com.southwind.entity.Student;import org.springframework.cloud.openfeign.FeignClient;import org.springframework.web.bind.annotation.GetMapping;import java.util.Collection;@FeignClient(value = \"provider\")public interface FeignProviderClient { @GetMapping(\"/student/findAll\") public Collection&lt;Student&gt; findAll(); @GetMapping(\"/student/index\") public String index();} Handler 12345678910111213141516171819202122232425262728package com.southwind.controller;import com.southwind.entity.Student;import com.southwind.feign.FeignProviderClient;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import java.util.Collection;@RestController@RequestMapping(\"/feign\")public class FeignHandler { @Autowired private FeignProviderClient feignProviderClient; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return feignProviderClient.findAll(); } @GetMapping(\"/index\") public String index(){ return feignProviderClient.index(); }} æœåŠ¡ç†”æ–­ï¼Œapplication.yml æ·»åŠ ç†”æ–­æœºåˆ¶ã€‚ 1234567891011121314server: port: 8050spring: application: name: feigneureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: truefeign: hystrix: enabled: true feign.hystrix.enabledï¼šæ˜¯å¦å¼€å¯ç†”æ–­å™¨ã€‚ åˆ›å»º FeignProviderClient æ¥å£çš„å®ç°ç±» FeignErrorï¼Œå®šä¹‰å®¹é”™å¤„ç†é€»è¾‘ï¼Œé€šè¿‡ @Component æ³¨è§£å°† FeignError å®ä¾‹æ³¨å…¥ IoC å®¹å™¨ä¸­ã€‚ 1234567891011121314151617181920package com.southwind.feign.impl;import com.southwind.entity.Student;import com.southwind.feign.FeignProviderClient;import org.springframework.stereotype.Component;import java.util.Collection;@Componentpublic class FeignError implements FeignProviderClient { @Override public Collection&lt;Student&gt; findAll() { return null; } @Override public String index() { return \"æœåŠ¡å™¨ç»´æŠ¤ä¸­......\"; }} åœ¨ FeignProviderClient å®šä¹‰å¤„é€šè¿‡ @FeignClient çš„ fallback å±æ€§è®¾ç½®æ˜ å°„ã€‚ 1234567891011121314151617package com.southwind.feign;import com.southwind.entity.Student;import com.southwind.feign.impl.FeignError;import org.springframework.cloud.openfeign.FeignClient;import org.springframework.web.bind.annotation.GetMapping;import java.util.Collection;@FeignClient(value = \"provider\",fallback = FeignError.class)public interface FeignProviderClient { @GetMapping(\"/student/findAll\") public Collection&lt;Student&gt; findAll(); @GetMapping(\"/student/index\") public String index();} Hystrix å®¹é”™æœºåˆ¶åœ¨ä¸æ”¹å˜å„ä¸ªå¾®æœåŠ¡è°ƒç”¨å…³ç³»çš„å‰æä¸‹ï¼Œé’ˆå¯¹é”™è¯¯æƒ…å†µè¿›è¡Œé¢„å…ˆå¤„ç†ã€‚ è®¾è®¡åŸåˆ™ 1ã€æœåŠ¡éš”ç¦»æœºåˆ¶ 2ã€æœåŠ¡é™çº§æœºåˆ¶ 3ã€ç†”æ–­æœºåˆ¶ 4ã€æä¾›å®æ—¶çš„ç›‘æ§å’ŒæŠ¥è­¦åŠŸèƒ½ 5ã€æä¾›å®æ—¶çš„é…ç½®ä¿®æ”¹åŠŸèƒ½ Hystrix æ•°æ®ç›‘æ§éœ€è¦ç»“åˆ Spring Boot Actuator æ¥ä½¿ç”¨ï¼ŒActuator æä¾›äº†å¯¹æœåŠ¡çš„å¥åº·å¥åº·ã€æ•°æ®ç»Ÿè®¡ï¼Œå¯ä»¥é€šè¿‡ hystrix.stream èŠ‚ç‚¹è·å–ç›‘æ§çš„è¯·æ±‚æ•°æ®ï¼Œæä¾›äº†å¯è§†åŒ–çš„ç›‘æ§ç•Œé¢ã€‚ åˆ›å»º Mavenï¼Œpom.xml 12345678910111213141516171819202122232425262728293031&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;version&gt;2.0.7.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 12345678910111213141516171819server: port: 8060spring: application: name: hystrixeureka: client: service-url: defaultZone: http://localhost:8761/eureka/ instance: prefer-ip-address: truefeign: hystrix: enabled: truemanagement: endpoints: web: exposure: include: 'hystrix.stream' åˆ›å»ºå¯åŠ¨ç±» 1234567891011121314151617package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.client.circuitbreaker.EnableCircuitBreaker;import org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;import org.springframework.cloud.openfeign.EnableFeignClients;@SpringBootApplication@EnableFeignClients@EnableCircuitBreaker@EnableHystrixDashboardpublic class HystrixApplication { public static void main(String[] args) { SpringApplication.run(HystrixApplication.class,args); }} æ³¨è§£è¯´æ˜ï¼š @EnableCircuitBreakerï¼šå£°æ˜å¯ç”¨æ•°æ®ç›‘æ§ @EnableHystrixDashboardï¼šå£°æ˜å¯ç”¨å¯è§†åŒ–æ•°æ®ç›‘æ§ Handler 123456789101112131415161718192021222324252627package com.southwind.controller;import com.southwind.entity.Student;import com.southwind.feign.FeignProviderClient;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import java.util.Collection;@RestController@RequestMapping(\"/hystrix\")public class HystrixHandler { @Autowired private FeignProviderClient feignProviderClient; @GetMapping(\"/findAll\") public Collection&lt;Student&gt; findAll(){ return feignProviderClient.findAll(); } @GetMapping(\"/index\") public String index(){ return feignProviderClient.index(); }} å¯åŠ¨æˆåŠŸä¹‹åï¼Œè®¿é—® http://localhost:8060/actuator/hystrix.stream å¯ä»¥ç›‘æ§åˆ°è¯·æ±‚æ•°æ®ï¼Œ è®¿é—® http://localhost:8060/hystrixï¼Œå¯ä»¥çœ‹åˆ°å¯è§†åŒ–çš„ç›‘æ§ç•Œé¢ï¼Œè¾“å…¥è¦ç›‘æ§çš„åœ°å€èŠ‚ç‚¹å³å¯çœ‹åˆ°è¯¥èŠ‚ç‚¹çš„å¯è§†åŒ–æ•°æ®ç›‘æ§ã€‚ Spring Cloud é…ç½®ä¸­å¿ƒSpring Cloud Configï¼Œé€šè¿‡æœåŠ¡ç«¯å¯ä»¥ä¸ºå¤šä¸ªå®¢æˆ·ç«¯æä¾›é…ç½®æœåŠ¡ã€‚Spring Cloud Config å¯ä»¥å°†é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥å°†é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨è¿œç¨‹ Git ä»“åº“ï¼Œåˆ›å»º Config Serverï¼Œé€šè¿‡å®ƒç®¡ç†æ‰€æœ‰çš„é…ç½®æ–‡ä»¶ã€‚ æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º application.yml 123456789101112server: port: 8762spring: application: name: nativeconfigserver profiles: active: native cloud: config: server: native: search-locations: classpath:/shared æ³¨è§£è¯´æ˜ profiles.activeï¼šé…ç½®æ–‡ä»¶çš„è·å–æ–¹å¼ cloud.config.server.native.search-locationsï¼šæœ¬åœ°é…ç½®æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„ resources è·¯å¾„ä¸‹åˆ›å»º shared æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ­¤è·¯å¾„ä¸‹åˆ›å»º configclient-dev.ymlã€‚ 123server: port: 8070foo: foo version 1 åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.config.server.EnableConfigServer;@SpringBootApplication@EnableConfigServerpublic class NativeConfigServerApplication { public static void main(String[] args) { SpringApplication.run(NativeConfigServerApplication.class,args); }} æ³¨è§£è¯´æ˜ @EnableConfigServerï¼šå£°æ˜é…ç½®ä¸­å¿ƒã€‚ åˆ›å»ºå®¢æˆ·ç«¯è¯»å–æœ¬åœ°é…ç½®ä¸­å¿ƒçš„é…ç½®æ–‡ä»¶ åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º bootstrap.ymlï¼Œé…ç½®è¯»å–æœ¬åœ°é…ç½®ä¸­å¿ƒçš„ç›¸å…³ä¿¡æ¯ã€‚ 123456789spring: application: name: configclient profiles: active: dev cloud: config: uri: http://localhost:8762 fail-fast: true æ³¨è§£è¯´æ˜ cloud.config.uriï¼šæœ¬åœ° Config Server çš„è®¿é—®è·¯å¾„ cloud.config.fail-faseï¼šè®¾ç½®å®¢æˆ·ç«¯ä¼˜å…ˆåˆ¤æ–­ Config Server è·å–æ˜¯å¦æ­£å¸¸ã€‚ é€šè¿‡spring.application.name ç»“åˆspring.profiles.activeæ‹¼æ¥ç›®æ ‡é…ç½®æ–‡ä»¶åï¼Œconfigclient-dev.ymlï¼Œå» Config Server ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶ã€‚ åˆ›å»ºå¯åŠ¨ç±» 1234567891011package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class NativeConfigClientApplication { public static void main(String[] args) { SpringApplication.run(NativeConfigClientApplication.class,args); }} Handler 12345678910111213141516171819202122package com.southwind.controller;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(\"/native\")public class NativeConfigHandler { @Value(\"${server.port}\") private String port; @Value(\"${foo}\") private String foo; @GetMapping(\"/index\") public String index(){ return this.port+\"-\"+this.foo; }} Spring Cloud Config è¿œç¨‹é…ç½® åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œä¸Šä¼ è‡³ GitHub 123456789server: port: 8070eureka: client: serviceUrl: defaultZone: http://localhost:8761/eureka/spring: application: name: configclient åˆ›å»º Config Serverï¼Œæ–°å»º Maven å·¥ç¨‹ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 123456789101112131415161718server: port: 8888spring: application: name: configserver cloud: config: server: git: uri: https://github.com/southwind9801/aispringcloud.git searchPaths: config username: root password: root label: mastereureka: client: serviceUrl: defaultZone: http://localhost:8761/eureka/ åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.config.server.EnableConfigServer;@SpringBootApplication@EnableConfigServerpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class,args); }} åˆ›å»º Config Client åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 12345678910111213&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º bootstrap.yml 123456789101112spring: cloud: config: name: configclient label: master discovery: enabled: true service-id: configservereureka: client: service-url: defaultZone: http://localhost:8761/eureka/ æ³¨è§£è¯´æ˜ spring.cloud.config.nameï¼šå½“å‰æœåŠ¡æ³¨å†Œåœ¨ Eureka Server ä¸Šçš„åç§°ï¼Œä¸è¿œç¨‹ä»“åº“çš„é…ç½®æ–‡ä»¶åå¯¹åº”ã€‚ spring.cloud.config.labelï¼šGit Repository çš„åˆ†æ”¯ã€‚ spring.cloud.config.discovery.enabledï¼šæ˜¯å¦å¼€å¯ Config æœåŠ¡å‘ç°æ”¯æŒã€‚ spring.cloud.config.discovery.service-idï¼šé…ç½®ä¸­å¿ƒåœ¨ Eureka Server ä¸Šæ³¨å†Œçš„åç§°ã€‚ åˆ›å»ºå¯åŠ¨ç±» 1234567891011package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class,args); }} Handler 12345678910111213141516171819package com.southwind.controller;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(\"/hello\")public class HelloHandler { @Value(\"${server.port}\") private String port; @GetMapping(\"/index\") public String index(){ return this.port; }} æœåŠ¡è·Ÿè¸ªSpring Cloud Zipkin Zipkin æ˜¯ä¸€ä¸ªå¯ä»¥é‡‡é›†å¹¶ä¸”è·Ÿè¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¯·æ±‚æ•°æ®çš„ç»„ä»¶ï¼Œè®©å¼€å‘è€…å¯ä»¥æ›´åŠ ç›´è§‚çš„ç›‘æ§åˆ°è¯·æ±‚åœ¨å„ä¸ªå¾®æœåŠ¡æ‰€è€—è´¹çš„æ—¶é—´ç­‰ï¼ŒZipkinï¼šZipkin Serverã€Zipkin Clientã€‚ ####åˆ›å»º Zipkin Server åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 12345678910111213141516&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.zipkin.java&lt;/groupId&gt; &lt;artifactId&gt;zipkin-server&lt;/artifactId&gt; &lt;version&gt;2.9.4&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.zipkin.java&lt;/groupId&gt; &lt;artifactId&gt;zipkin-autoconfigure-ui&lt;/artifactId&gt; &lt;version&gt;2.9.4&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 12server: port: 9090 åˆ›å»ºå¯åŠ¨ç±» 12345678910111213package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import zipkin.server.internal.EnableZipkinServer;@SpringBootApplication@EnableZipkinServerpublic class ZipkinApplication { public static void main(String[] args) { SpringApplication.run(ZipkinApplication.class,args); }} æ³¨è§£è¯´æ˜ @EnableZipkinServerï¼šå£°æ˜å¯åŠ¨ Zipkin Server åˆ›å»º Zipkin Client åˆ›å»º Maven å·¥ç¨‹ï¼Œpom.xml 1234567&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé…ç½®æ–‡ä»¶ application.yml 1234567891011121314151617server: port: 8090spring: application: name: zipkinclient sleuth: web: client: enabled: true sampler: probability: 1.0 zipkin: base-url: http://localhost:9090/eureka: client: service-url: defaultZone: http://localhost:8761/eureka/ å±æ€§è¯´æ˜ spring.sleuth.web.client.enabledï¼šè®¾ç½®å¼€å¯è¯·æ±‚è·Ÿè¸ª spring.sleuth.sampler.probabilityï¼šè®¾ç½®é‡‡æ ·æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯ 1.0 srping.zipkin.base-urlï¼šZipkin Server åœ°å€ åˆ›å»ºå¯åŠ¨ç±» 1234567891011package com.southwind;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class ZipkinClientApplication { public static void main(String[] args) { SpringApplication.run(ZipkinClientApplication.class,args); }} Handler 12345678910111213141516171819package com.southwind.controller;import org.springframework.beans.factory.annotation.Value;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping(\"/zipkin\")public class ZipkinHandler { @Value(\"${server.port}\") private String port; @GetMapping(\"/index\") public String index(){ return this.port; }}","link":"/2019/10/27/SpringCloud%E7%AC%94%E8%AE%B0-%E4%B8%80/"},{"title":"[Kubernetes] Kubeadm Troubleshooting","text":"Troubleshooting for kubeadm. T1 å‰ç½®å‡†å¤‡é—®é¢˜Run kubeadm config images pull 12345678I1216 10:31:32.821965 25588 version.go:251] remote version is much newer: v1.17.0; falling back to: stable-1.16[init] Using Kubernetes version: v1.16.4[preflight] Running pre-flight checks [WARNING SystemVerification]: this Docker version is not on the list of validated versions: 19.03.5. Latest validated version: 18.09error execution phase preflight: [preflight] Some fatal errors occurred: [ERROR Swap]: running with swap on is not supported. Please disable swap[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`To see the stack trace of this error execute with --v=5 or higher ä¾ç…§é¡ºåºï¼š kubeadm config print init-defaults &gt; init.default.yamlå¾—åˆ°é»˜è®¤çš„åˆå§‹é…ç½®ï¼Œå¯¹ç”Ÿæˆçš„æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼Œå¯ä»¥æŒ‰éœ€ç”Ÿæˆåˆé€‚çš„é…ç½®ã€‚å¦‚ï¼š å°†advertiseAddress: 1.2.3.4ä¿®æ”¹ä¸ºæœ¬æœºåœ°å€ å¦‚æœä½¿ç”¨å›½å†…çš„dockeré•œåƒæºï¼Œéœ€è¦å°†imageRepository: k8s.gcr.ioä¿®æ”¹ä¸ºå¯¹åº”çš„é•œåƒæºåœ°å€ å®šåˆ¶é•œåƒä»“åº“åœ°å€ï¼šimageRepository: docker.io/dustise kubernetesç‰ˆæœ¬ï¼škubernetesVersion: v1.17.0 Podåœ°å€èŒƒå›´ï¼š 12networking: podSubnet: \"192.168.0.0/16\" ä¿®æ”¹dockerç‰ˆæœ¬ Disable swap sudo swapoff -a #å…³é—­äº¤æ¢åˆ†åŒº sudo free -m # æŸ¥çœ‹äº¤æ¢åˆ†åŒºçŠ¶æ€ sudo chmod +w /etc/fstab # ä¿®æ”¹fstabæ–‡ä»¶çš„æƒé™ vi /etc/fstab # å°†swapè¡Œæ³¨é‡Šæ‰ï¼Œæ³¨æ„å…ˆå¤‡ä»½ï¼Œæ­¤æ­¥æ˜¯ä¸ºäº†æ°¸ä¹…å…³é—­swapåˆ†åŒº T2 Dashboardæ— æ³•è®¿é—®ç¢°åˆ°é¡µé¢æ˜¾ç¤º 1234567891011121314{\"kind\": \"Status\",\"apiVersion\": \"v1\",\"metadata\": {},\"status\": \"Failure\",\"message\": \"pods is forbidden: User \"system:anonymous\" cannot list pods in the namespace \"default\"\",\"reason\": \"Forbidden\",\"details\": {\"kind\": \"pods\"},\"code\": 403} é‚£ä¹ˆå‚è€ƒè¿™ä¸ªissueï¼Œåœ¨ä¹‹å‰ç”¨æ¥ç”Ÿæˆdashboardçš„recommend.yamlä¸­åŠ å…¥ 123456789101112131415161718192021222324252627---# ------------------- Gross Hack For anonymous auth through api proxy ------------------- ## Allows users to reach login page and other proxied dashboard URLskind: ClusterRoleapiVersion: rbac.authorization.k8s.io/v1metadata: name: kubernetes-dashboard-anonymousrules:- apiGroups: [\"\"] resources: [\"services/proxy\"] resourceNames: [\"https:kubernetes-dashboard:\"] verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]- nonResourceURLs: [\"/ui\", \"/ui/*\", \"/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/*\"] verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: kubernetes-dashboard-anonymousroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: kubernetes-dashboard-anonymoussubjects:- kind: User name: system:anonymous é€šè¿‡å‘½ä»¤é‡æ–°å¯åŠ¨dashboardï¼škubectl replace --force -f recommended.yaml T3 é…ç½®ç½‘ç»œé—®é¢˜1.ä½¿ç”¨calicoæœªå‘ç°æ­£å¸¸ç½‘å¡é”™è¯¯ä¿¡æ¯ï¼š 1:Readiness probe failed: caliconode is not ready: BIRD is not ready: BGP not established with 10.117.150.23 è§£å†³æ–¹æ³•ï¼š ç¼–è¾‘calicol.yamlï¼Œæ·»åŠ  12- name: IP_AUTODETECTION_METHOD value: \"interface=enp09s\" # å®é™…æ¥é€šå…¶ä»–é›†ç¾¤çš„ç½‘å¡ 2.ä½¿ç”¨å…¶ä»–ç½‘ç»œé…ç½®çš„æ®‹ç•™ç”±äºæ­¤å‰æ“ä½œæœ‰é”™è¯¯ï¼Œéœ€ç§»é™¤ä¹‹å‰çš„ç½‘ç»œé…ç½®ï¼Œé‡æ–°å®‰è£…ã€‚ ä½†æ˜¯æ­¤å‰çš„ç½‘ç»œé…ç½®æœªç§»é™¤å¹²å‡€ï¼Œä¼šé€ æˆä¸€äº›é—®é¢˜ï¼š ip linkï¼Œä¾‹å¦‚æ­¤å‰ä½¿ç”¨è¿‡weaveå¯¹åº”çš„ç½‘å¡weaveã€calicoå¯¹åº”çš„ç½‘å¡tunl0ï¼Œéœ€è¦ä½¿ç”¨ip link delete {name}æ¥è¿›è¡Œç§»é™¤ã€‚ æ›´ä¸ºæœ‰æ•ˆçš„æ–¹æ³•(é’ˆå¯¹weave)ï¼š 12sudo curl -L git.io/weave -o /usr/local/bin/weavesudo chmod a+x /usr/local/bin/weave then 1weave reset CNIçš„é…ç½®æ–‡ä»¶åœ¨ä½¿ç”¨kubeadm resetåå¹¶ä¸ä¼šè¢«åˆ é™¤:rm -rf /etc/cni/net.d T4 é¡½å›ºçš„swap (UPDATE 2020/03/31)ä¸çŸ¥é“å‡ºäºä»€ä¹ˆåŸå› ï¼Œæ¯æ¬¡å®éªŒå®¤æœåŠ¡å™¨é‡å¯ä¹‹åï¼Œäº¤æ¢åˆ†åŒºéƒ½ä¼šè¢«é‡æ–°å¯ç”¨ï¼ˆ/etc/fstabç”šè‡³éƒ½æ˜¯disableçš„çŠ¶æ€ï¼‰ æš‚æ—¶çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œæ¯æ¬¡æœåŠ¡å™¨ä¸å¾—ä¸éœ€è¦é‡å¯æ—¶ï¼Œå…ˆåœæ­¢æ‰€æœ‰å®¹å™¨ï¼ˆä¸å¤ªå¯èƒ½ï¼‰ï¼Œé‡å¯åswapoff -a +systemctl restart kubeletï¼Œä¸¤å¥—è¿æ‹›ï¼Œæš‚ä¸”å°†å°±ç”¨ç”¨ã€‚","link":"/2019/12/23/TbSt4kubeadm/"},{"title":"[Debug] VMwareä¸­Ubuntué‡å¯Freeze","text":"The issue is with Wayland. While Ubuntu defaults to an X11 session, for some reason they left it enabled for GDM. You can certainly replace GDM with LightDM, but an easier option would be to: 1sudo nano /etc/gdm3/custom.conf Then change the line: 1#WaylandEnable=false to 1WaylandEnable=false Press Ctrl+O and then Ctrl+X and reboot. [edit] If you donâ€™t wish to reboot you can do sudo systemctl restart gdm which will restart your windows session (this assume ssh into the box to fix as above). Or you cannot use ssh to your ubuntu, just hold shift on start up, and select recovery mode, root shell, follow instructions above, and reboot.","link":"/2019/07/12/VMware%E4%B8%ADUbuntu%E9%87%8D%E5%90%AFFreeze/"},{"title":"[Debug] VMwareé‡å¯åè™šæ‹Ÿæœºæ— æ³•è”ç½‘é—®é¢˜è§£å†³","text":"Edit the file /etc/network/interfaces 123# The primary network interfaceauto ens33iface ens33 inet dhcp","link":"/2019/07/05/VMware%E9%87%8D%E5%90%AF%E5%90%8E%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%97%A0%E6%B3%95%E8%81%94%E7%BD%91%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"},{"title":"[NOTE] Vmvareé™æ€åœ°å€ç›¸å…³é—®é¢˜","text":"VMwareé…ç½®é›†ç¾¤çš„è¿‡ç¨‹ä¸­ï¼Œé›†ç¾¤æœºå™¨é‡å¯ä¹‹åå¾€å¾€ä¼šé‡æ–°åˆ†é…ipï¼Œè§£å†³å¦‚ä¸‹ã€‚ CentOSyum install net-tools NATæ¨¡å¼ å­ç½‘åœ°å€ å­ç½‘æ©ç  ç½‘å…³åœ°å€ è¿›å…¥è™šæ‹Ÿæœºvi /etc/sysconfig/network-scripts/ifcfg-eth0ä¹Ÿå¯èƒ½æ˜¯ens33 é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112DEVICE=&quot;eth0&quot;BOOTPROTO=&quot;static&quot;HWADDR=&quot;00:0C:29:F4:7E:C9&quot;IPV6INIT=&quot;yes&quot;NM_CONTROLLED=&quot;yes&quot;ONBOOT=&quot;yes&quot;TYPE=&quot;Ethernet&quot;UUID=&quot;2a76c2f8-cd47-44af-936d-11559b3a498d&quot;IPADDR=&quot;192.168.73.100&quot;NETMASK=&quot;255.255.255.0&quot;GATEWAY=&quot;192.168.73.2&quot; è‹¥æ— æ³•è¿æ¥å¤–ç½‘ï¼ŒåŠ å…¥ç½‘å…³åœ°å€xxx.xxx.xxx.2ï¼Œå…±äº«ç‰©ç†æœºç½‘ç»œï¼Œæˆ–ç”¨114.114.114.114 systemctl restart network.service Ubuntustep by step sudo vi /etc/network/interfaces edit the configurations 123456auto ens33iface ens33 inet staticaddress 192.168.81.137netmask 255.255.255.0gateway 192.168.81.2dns-nameservers 10.0.208.1 sudo ip addr flush ens33 sudo systemctl restart networking.service æˆ– sudo /etc/init.d/networking restart å‘: ç½‘å…³ä¸º.2ï¼Œæœ‰çš„åšå®¢å†™çš„æ˜¯.1ï¼Œå®æµ‹ä¸è¡Œ dns 114.114.114.114æˆ–42.120.21.30 ä¸è¦å¼€æœ¬åœ°dhcpè‡ªåŠ¨åˆ†å‘åœ°å€ é…ç½®è‡ªå·±ç½‘æ®µDNS sudo vi /etc/resolv.conf è¿·å¹»ï¼ æš‚æ—¶æ²¡å•¥å¥½æ–¹æ³•æå®šè¿™ä¸ªï¼Œæ–°å»ºä¸ªresolv.confåœ¨ä¸€ä¸ªå®‰å…¨çš„ç›®å½•ï¼Œå¡«ä¸Šï¼š 123nameserver 114.114.114.114nameserver 8.8.8.8nameserver 8.8.4.4 ç¢°åˆ°é—®é¢˜äº†å°±ç›´æ¥cat ./resolv.conf &gt; /etc/resolv.conf ç„¶åsystemctl restart networking.service å°±æ˜¯è¿™ä¹ˆæš´åŠ› è§£å†³æ–¹æ³• Ubuntu 18 LTS server /etc/netplan/50-cloud-init.yaml 123456789network: ethernets: ens33: addresses: [192.168.1.197/24] gateway4: 192.168.1.1 nameservers: addresses: [192.168.1.1] dhcp4: no optional: true netplan apply","link":"/2019/07/03/Vmvare%E9%9D%99%E6%80%81%E5%9C%B0%E5%9D%80%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/"},{"title":"[NOTE] ZSHå®‰è£…","text":"ä¹ æƒ¯äº†Hyper+WSL+zshçš„ç»„åˆï¼Œåœ¨centosä¸­ä¹Ÿå¾—å®‰æ’ä¸Šï¼Œå¤‡æŸ¥ã€‚ Step 1: Install &amp; Configure ZSHCentOS 7ï¼š yum install zsh Ubuntu: apt install zsh Step 2: ZSH SettingsCentOS 7: chsh -s /bin/zsh root Ubuntu: which zsh Log in again and check the current shell by: echo $SHELL Step 3: Install &amp; Configutre Oh my zshCentOS 7: yum install wget git Ubuntu: apt install wget git Download the installer script and run it by: wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | zsh And this will meets a problem if the system is the simplified. It will be refused by githubusercontent.com for the lack of ca-certificates. And there are two ways to deal with it: wget --no-check-certificate https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | zsh or do it once: yum install ca-certificates -y or yum install ssl-cert After we have installed Oh my zsh in ~/.on-my-zsh, we just need to copy it in .zshrc and apply the configuration. cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc source ~/.zshrc Try this: sh -c &quot;$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)&quot; Oh my zsh Theme Settingsé»˜è®¤çš„å°±å¾ˆå¥½ç”¨äº†ï¼Œæœ‰é—®é¢˜google","link":"/2019/07/05/ZSH%E5%AE%89%E8%A3%85/"},{"title":"[NOTE] FrpåŸç†æ·±å…¥å®è·µã€Nginxå®¹å™¨å®è·µ","text":"è¿‘æœŸå°†é˜¿é‡Œäº‘ä¸Šçš„åšå®¢æœåŠ¡è¿ç§»åˆ°äº†æœ¬åœ°æœºæˆ¿æœåŠ¡å™¨ï¼ŒåŒæ—¶ojå¹³å°çš„æ­å»ºä¹Ÿå¼€å§‹å¯åŠ¨ï¼Œç›®å‰å¤šä¸ªæœåŠ¡é€šè¿‡ä¸åŒç«¯å£è®¿é—®çš„æ–¹å¼æ˜¾å¾—å¤ªè¿‡ç²—ç³™ï¼Œæœ¬æ–‡å°†é€šè¿‡frpã€Nginxã€dockerç­‰å·¥å…·ä»¥å®ç°é˜¿é‡Œäº‘ä¸»æœºå¯¹å¤šä¸ªæœ¬åœ°æœåŠ¡çš„åå‘ä»£ç†ï¼Œå¯¹æ¯ä¸ªæœåŠ¡éƒ½åˆ†å‡ºå¯¹åº”çš„äºŒçº§åŸŸåã€‚ åœ¨frpçš„ä½¿ç”¨ä¸Šï¼Œæœ¬æ–‡ç›¸è¾ƒä¹‹å‰çš„æ–‡ç« æ›´åŠ æ·±å…¥ï¼Œå¯¹frpçš„å¤šä¸ªåŠŸèƒ½ä½œå‡ºæ›´å¤šçš„æ¢ç´¢ã€‚å¦å¤–ï¼Œä¹Ÿå°†åˆæ­¥åœ°å­¦ä¹ å®è·µNginxå¼•æ“ã€‚ ä¸€ã€ç›¸å…³è¯´æ˜æœ¬æ–‡æ¶‰åŠåˆ°çš„ç¯å¢ƒï¼š Ubuntu Server 18LTS (local) CentOS 7.3 (Aliyun) frp 0.28.0 go 1.10.4 äºŒã€frpåŸç†å†…ç½‘ç©¿é€çš„åŸç†åœ¨å‰æ–‡ä¸­å·²æœ‰è¯´æ˜ï¼Œä½†åŸºäºéœ€æ±‚çš„å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨frpæ›´å¤šçš„ç‰¹æ€§ï¼Œäº†è§£ç›¸å…³çš„åŸç†æœ‰åŠ©äºå‡å°‘åœ¨å®ç°è¿‡ç¨‹ä¸­çš„é”™è¯¯ã€‚ ç¬¬ä¸€æ­¥ï¼šé…ç½®æ— è¯¯çš„æƒ…å†µä¸‹ï¼ŒfrpæœåŠ¡ç«¯å’Œfrpå®¢æˆ·ç«¯å…ˆåå¯åŠ¨ï¼Œå»ºç«‹é€šä¿¡éš§é“ï¼Œå…¶ä¸­ï¼š frpæœåŠ¡ç«¯ç›‘å¬http 7071ç«¯å£ï¼ˆæ­¤ç«¯å£å¯è‡ªå®šä¹‰ï¼‰ï¼Œæ¥æ”¶æ­¤ç«¯å£ä¸‹æ‰€æœ‰å¤–ç½‘ç”¨æˆ·è¯·æ±‚ï¼Œæ³¨æ„æ­¤å¤„çš„7071ç«¯å£è¦å’Œé€šä¿¡éš§é“æ‰€ç”¨çš„ç«¯å£7000ä½œå‡ºåŒºåˆ« frpå®¢æˆ·ç«¯ä»£ç†æœ¬åœ°æƒ³è¦æš´éœ²ç»™å¤–ç½‘çš„webæœåŠ¡ç«¯å£ï¼Œæœ¬æ–‡ä»¥80, 8080ç«¯å£ä¸ºä¾‹ ç¬¬äºŒæ­¥ï¼šé€šè¿‡é…ç½®nginxåå‘ä»£ç†ï¼Œå°†æŒ‡å‘æœ¬å°å…¬ç½‘æœåŠ¡å™¨çš„nuzar.topä¸‹çš„å­åŸŸåï¼Œæ˜ å°„åˆ°æœåŠ¡å™¨çš„7071ç«¯å£ï¼Œä¹Ÿå°±æ˜¯frpç›‘å¬çš„é‚£ä¸ªç«¯å£ã€‚ å¤–ç½‘ç”¨æˆ·è®¿é—®gitlab.nuzar.topã€wordpress.nuzar.topä¸‹çš„å­åŸŸåï¼Œä¾‹å¦‚ ï¼š gitlab.nuzar.top wordpress.nuzar.top ç­‰åŒäºè®¿é—®nuzar.topï¼š7071ï¼Œä¼šè§¦å‘frpæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„äº’åŠ¨ï¼Œä»è€Œhttpè¯·æ±‚ç”±frpæœåŠ¡ç«¯ä¼ é€’åˆ°frpå®¢æˆ·ç«¯ ç¬¬ä¸‰æ­¥ï¼šfrpå®¢æˆ·ç«¯æ”¶åˆ°httpè¯·æ±‚åï¼ŒåŸºäºè‡ªå®šä¹‰é…ç½®ï¼Œåˆ™åšå¦‚ä¸‹å¤„ç†ï¼š ç›‘å¬åˆ°httpè¯·æ±‚ä¸­çš„åŸŸåä¸º gitlab.nuzar.topï¼Œåˆ™å°†è¯·æ±‚è½¬å‘åˆ°æˆ‘æœ¬åœ°çš„8585webæœåŠ¡ç«¯å£ ç›‘å¬åˆ°httpè¯·æ±‚ä¸­çš„åŸŸåä¸º wordpress.nuzar.topï¼Œåˆ™å°†è¯·æ±‚è½¬å‘åˆ°æˆ‘æœ¬åœ°çš„8686webæœåŠ¡ç«¯å£ ç¬¬å››æ­¥ï¼šæœ¬åœ°çš„webæœåŠ¡æ”¶åˆ°httpè¯·æ±‚åï¼Œå¯¹è¯·æ±‚åšå¤„ç†ï¼Œå¹¶å®Œæˆå“åº” ç¬¬äº”æ­¥ï¼šfrpå®¢æˆ·ç«¯å°†å“åº”ç»“æœå›ä¼ ç»™frpçš„æœåŠ¡ç«¯ã€‚æœåŠ¡ç«¯æœ€ç»ˆå°†å“åº”å›ä¼ ç»™å¤–ç½‘ç”¨æˆ· ç¬¬å…­æ­¥ï¼šæœ€ç»ˆçš„å®æµ‹æ•ˆæœä¸ºï¼š è®¿é—® gitlab.nuzar.topï¼Œç­‰åŒäºè®¿é—®æˆ‘æœ¬åœ°çš„192.168.1.253:80 è®¿é—® wordpress.nuzar.topï¼Œç­‰åŒäºè®¿é—®æˆ‘æœ¬åœ°çš„192.168.1.253:8080 ä¸‰ã€Configurationè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šé…ç½®ä¿¡æ¯ï¼Œç›¸å…³çš„å±æ€§ä¼šåˆ†åˆ«è¿›è¡Œè¯´æ˜ã€‚ 1.frps.ini 1234[common]bind_port = 7000vhost_http_port = 7071subdomain_host = nuzar.top bind_portä¸ºfrpæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´é€šè®¯çš„ç«¯å£ï¼Œä¸ºäº‹å®ä¸Šæ•°æ®ä¼ è¾“çš„ç«¯å£ï¼› vhost_http_portä¸ºhttpæœåŠ¡çš„ä»£ç†ç«¯å£ï¼Œä»£ç†æ‰€æœ‰å‘å¾€7071ç«¯å£çš„httpè¯·æ±‚ï¼Œä¹‹åé€šè¿‡bind_portå°†åŒ…è£…åçš„è¯·æ±‚å‘é€ç»™bing_portç›¸è¿æ¥çš„æœåŠ¡å™¨ï¼› subdomain_hostæŒ‡å®šçˆ¶åŸŸåï¼Œä¾¿äºåˆ’åˆ†å­ç½‘(ä½†äº‹å®ä¸Šæœ€åè¿˜æ˜¯é€šè¿‡nginxæ¥åˆ’åˆ†çš„å­ç½‘ï¼Œä¸€ç›´åˆ°éƒ½å¼„å®Œä¹‹åï¼Œæ‰å‘ç°å‰é¢å¤šæ‰“äº†ä¸ªdï¼Œå‰é¢frpæ–¹æ¡ˆèµ°ä¸é€šï¼Œææ€•æ˜¯è¿™ä¸ªçš„é”…)ã€‚ ä¸ºäº†ä¾¿äºè°ƒè¯•ï¼Œä½ ä¹Ÿå¼€å¯frpçš„dashboardç•Œé¢ï¼Œå‚ç…§å®˜ç½‘Dashboardï¼Œåœ¨frps.iniä¸­åŠ å…¥: 12345[common]dashboard_port = 7500# dashboard's username and password are both optionalï¼Œif not set, default is admin.dashboard_user = admindashboard_pwd = admin å¦‚æœä½ ä¹‹å‰æœ‰é€šè¿‡systemctlå°†frpsåŠ å…¥åˆ°ç³»ç»ŸæœåŠ¡ä¸­çš„è¯ï¼Œé‚£ä¹ˆæ­¤æ—¶é€šè¿‡systemctl restart frpså°±å¯ä»¥è®©æ–°é…ç½®ç”Ÿæ•ˆäº†ã€‚ dashboardçš„æ•ˆæœå›¾å¦‚ä¸‹ï¼š é€šè¿‡dashboardé¢æ¿ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„è§‚å¯Ÿåˆ°è‡ªå·±çš„é…ç½®æ˜¯å¦ç”Ÿæ•ˆã€‚ â€‹ 2.frpc.ini123456789101112131415161718192021222324252627282930313233[common]server_addr = REMOTE_IPADDRserver_port = 7000[http-OJ]type = tcplocal_ip = 192.168.1.252local_port = 8080remote_port = 28080[ssh]type = tcplocal_ip = 192.168.1.253local_port = 26remote_port = 6000[ssh-gitlab]type = tcplocal_ip = 192.168.1.253local_port = 26remote_port = 8082[http-gitlab]type = tcplocal_ip = 192.168.1.253local_port = 80remote_port = 6080[http-nextcloud]type = tcplocal_ip = 192.168.1.253local_port = 40080remote_port = 40080 frpc.inié…ç½®æ–‡ä»¶ï¼Œè§åçŸ¥ä¹‰ã€‚éœ€è¦æ³¨æ„çš„ä¸¤ç‚¹ï¼š1.é…ç½®æ–‡ä»¶ä¸­ä¸è¦å‡ºç°ç›¸åŒçš„åç§°ï¼Œä¸­æ‹¬å·ä¸­çš„åç§°åªä½œä»£ç§°ï¼Œå¹¶ä¸å…·æœ‰å®é™…çš„æ„ä¹‰ï¼›2.è‚¯å®šæœ‰äººä¼šå¥‡æ€ªä¸ºä»€ä¹ˆæ˜æ˜æ˜¯ä½¿ç”¨çš„httpåè®®ï¼Œä½†ç±»å‹å´æ ‡æ³¨çš„type = tcpï¼ŒåŸå› æ˜¯å®˜æ–¹å¹¶æ²¡æœ‰æä¾›å¤šwebæœåŠ¡çš„ç©¿é€ï¼Œåœ¨ä¸€äº›issueä¸­æœ‰äººå‘ç°ä½¿ç”¨tcpå¯ä»¥ç»•è¿‡å•ä¸ªwebç©¿é€çš„é™åˆ¶ï¼Œæœ€ç»ˆè¾¾åˆ°ç†æƒ³çš„æ•ˆæœï¼Œå…·ä½“çš„è®¨è®ºå¯ä»¥å‰å¾€#914 (comment). 3.nginxæœ¬æ–‡ä¸­nginxé‡‡ç”¨dockerçš„æ–¹å¼è¿›è¡Œéƒ¨ç½²ï¼Œç”±äºnginxåœ¨å¯åŠ¨æ—¶ä¼šåŠ è½½ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼Œå› æ­¤åœ¨éƒ¨ç½²å‰éœ€è¦åœ¨ç›¸åº”è·¯å¾„(ä¹‹åæŒ‚è½½åˆ°å®¹å™¨ä¸­)ç¼–å†™ä¸€äº›é…ç½®æ–‡ä»¶ã€‚ /root/nginx/nginx.conf 1234567891011121314151617181920user nginx;worker_processes auto;error_log /var/log/nginx/error.log warn;pid /var/run/nginx.pid;events { worker_connections 2048;}http { include /etc/nginx/mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; client_max_body_size 10M; include /etc/nginx/conf.d/*.conf;} nginx.confå¸¸è§„é…ç½®æ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ /root/nginx/conf.d/default.conf 12345678910111213141516171819202122server { listen 80; listen [::]:80; server_name nuzar.top; location / { proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $http_host; proxy_pass http://nuzar.top:8080; }}server { listen 80; listen [::]:80; server_name gitlab.nuzar.top; location / { proxy_set_header X-Real-IP $remote_addr; proxy_set_header Host $http_host; proxy_pass http://127.0.0.1:6080; }} nginxç›‘å¬80ç«¯å£ï¼Œå°†å¯¹åº”çš„æœåŠ¡è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„ç«¯å£ï¼Œç”±äºç›®å‰æˆ‘ä¸ªäººå¯¹äºnginxä¹Ÿæ˜¯ä¸ªæ‹¿æ¥å³ç”¨çš„çŠ¶æ€ï¼Œäº†è§£ä¸å¤šã€‚ å››ã€æ·»åŠ åŸŸåè§£æå¦‚æœä½ ä¹Ÿæ˜¯ä½¿ç”¨çš„é˜¿é‡Œäº‘çš„äº‘æœåŠ¡ï¼Œå¯ä»¥ç›´æ¥ç™»å½•åŸŸåè§£æç®¡ç†é¡µé¢ã€‚ ä»¥æœ¬æ–‡ä¸­çš„gitlab.nuzar.topä¸ºä¾‹ï¼š æ·»åŠ è®°å½•ï¼šA ä¸»æœºè®°å½•ï¼šgitlab è§£æè·¯çº¿ï¼šé»˜è®¤ è®°å½•å€¼ï¼šSERVER_IP_ADDR å¦‚æœä½¿ç”¨çš„å…¶ä»–å‚å•†çš„ä¸»æœºï¼Œä¹Ÿæœ‰ç›¸åº”çš„æ“ä½œå¯ä»¥å®ç°ã€‚ äº”ã€éƒ¨ç½²nginxå®¹å™¨nginxéƒ¨ç½²çš„æ–¹å¼è¿˜æ˜¯é‡‡ç”¨docker runï¼Œåœ¨éƒ¨ç½²æ—¶éœ€è¦å°†å®¿ä¸»æœºçš„ä¸€äº›è·¯å¾„æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„å¯¹åº”è·¯å¾„ï¼Œå› æ­¤ï¼Œå¯ä»¥å‚è€ƒä¸‹æˆ‘çš„æ–‡ä»¶æ ‘ï¼š 1234567|-- conf.crt|-- conf.d| `-- default.conf|-- html| `-- index.html|-- nginx`-- nginx.conf conf.crtç”¨äºå­˜æ”¾è¯ä¹¦ï¼Œè¿™ä¸ªæš‚æ—¶ä¸ä¼šç”¨åˆ°ï¼› nginx.confä¸ºnginxé…ç½®æ–‡ä»¶ï¼› default.confä¸ºé…ç½®æ–‡ä»¶çš„è¡¥å……æ–‡ä»¶ï¼Œå¯¹äºnginxä¸»è¦çš„é…ç½®å·¥ä½œä¹Ÿæ˜¯é›†ä¸­åœ¨è¿™ä¸ªæ–‡ä»¶ä¹‹ä¸­ï¼› index.htmlé¡¾åæ€ä¹‰ï¼Œä¸€ä¸ªæ™®é€šçš„é¡µé¢ï¼Œä¹‹åç”¨certbotæ¥ç”³è¯·è¯ä¹¦çš„æ—¶å€™éœ€è¦ç”¨åˆ°è¿™ä¸ªé¡µé¢ã€‚ 12345678docker run -d -p 80:80 -p 443:443 \\-v $(pwd)/nginx/conf.d:/etc/nginx/conf.d:ro \\-v $(pwd)/nginx/conf.crt:/etc/nginx/conf.crt:ro \\-v $(pwd)/nginx/nginx.conf:/etc/nginx/nginx.conf:ro \\-v $(pwd)/logs/nginx:/var/log/nginx \\-v $(pwd)/nginx/html:/usr/share/nginx/html \\--restart=always --name=gateway --network=host \\nginx éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ ‡æ³¨--network=hoståï¼Œnginxå®¹å™¨æ‰æœ‰èƒ½åŠ›ä»£ç†ä¸»æœºçš„è¯·æ±‚ï¼Œå¦åˆ™nginxåªåœ¨å®¹å™¨å†…éƒ¨æœ‰æ•ˆï¼Œhostè¡¨ç¤ºå®¹å™¨ç½‘ç»œä¸ºä¸»æœºæ¨¡å¼ï¼› roè¡¨ç¤ºæŒ‚è½½çš„æ–‡ä»¶ä¸ºåªè¯»çŠ¶æ€ï¼Œå¦å¤–åœ¨dockerç¤¾åŒºä¸­ï¼Œæ–‡ä»¶çº§åˆ«çš„æŒ‚è½½å¥½åƒæ˜¯ä¸å¤ªæ¨èçš„ï¼Œä½†è¿å®˜ç½‘ä¸Šå¯¹nginxçš„ç¤ºä¾‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥å°±å…ˆè¿™æ ·ç”¨äº†ã€‚ äº”ã€æ€»ç»“å¯¹äºäºŒçº§åŸŸåçš„é…ç½®ï¼Œæ€»çš„æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ€»çš„æ¥è¯´å­˜åœ¨ä¸¤å¥—æ–¹æ¡ˆï¼šä¸€è€…æ˜¯ç›´æ¥é€šè¿‡frpæä¾›çš„subdomainè¿›è¡Œé…ç½®ï¼Œä½†å‰æ–‡ä¹Ÿæåˆ°ï¼Œç”±äºåæ¥æ‰å‘ç°çš„ä¸€äº›é”™è¯¯ï¼Œå¯¼è‡´æˆ‘è¿‡æ—©åœ°è®¤ä¸ºè¿™å¥—æ–¹æ¡ˆä¸é€‚ç”¨ï¼›äºŒæ˜¯åœ¨frpå®ç°å†…ç©¿çš„åŸºç¡€ä¹‹ä¸Šï¼Œé€šè¿‡ä¸€ä¸ªnginxå¼•æ“æ¥å®Œæˆä¸€ä¸ªç±»ä¼¼åå‘ä»£ç†çš„å·¥ä½œï¼Œè¿™å±‚nginxåœ¨ç°åœ¨çœ‹æ¥æœ‰äº›å¤šä½™ï¼Œä½†å‡ºäºç†Ÿæ‚‰nginxå’Œä¹‹ååŠ å…¥httpsæ”¯æŒçš„ç›®çš„ï¼Œæˆ‘å°†äºŒçº§åŸŸååˆ°æŒ‡å®šç«¯å£çš„å·¥ä½œäº¤ç”±nginxæ¥å®Œæˆäº†ã€‚ å¦å¤–ï¼Œfrpçš„åŠŸèƒ½è¿œä¸æ­¢å¦‚æ­¤ï¼Œç›®å‰é¡¹ç›®æ¯”è¾ƒæ´»è·ƒï¼ŒåŠ ä¹‹ä¹Ÿæ˜¯ç”±Golangç¼–å†™ï¼Œå€¼å¾—æŒç»­è·Ÿè¿›ã€‚","link":"/2019/09/08/frp%E5%8E%9F%E7%90%86%E6%B7%B1%E5%85%A5%E5%AE%9E%E8%B7%B5%E3%80%81Nginx%E5%AE%B9%E5%99%A8%E5%AE%9E%E8%B7%B5/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2019/07/13/hello-world/"},{"title":"[Script] Hugoè‡ªåŠ¨éƒ¨ç½²è„šæœ¬æ›´æ–°","text":"ä¹‹å‰ä½¿ç”¨çš„è„šæœ¬åŸºæœ¬å¯ä»¥å®Œæˆhugoçš„è‡ªåŠ¨ç¼–è¯‘å’Œpushï¼Œä½†æˆ‘çš„ç¬”è®°åŸºæœ¬éƒ½æ”¾åœ¨äº†ç§»åŠ¨ç¡¬ç›˜ä¸­ï¼Œå› æ­¤éœ€è¦è„šæœ¬å¯¹ç§»åŠ¨ç¡¬ç›˜ä¸­çš„ç¬”è®°è¿›è¡Œæ‰«æï¼Œå¢é‡åœ°è¿›è¡Œæ›´æ–°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445#!/bin/bash# this is a script for hugo deployment# the occurrence of error will stop the scriptset -e# æ£€æŸ¥/h/backup/notes/æ–‡ä»¶å¤¹çš„æ–°æ–‡ä»¶ï¼Œå¹¶åŠ å…¥hugoä¸­path='/h/backup/notes/'files=$(ls $path)# å¯¹notesæ–‡ä»¶å¤¹ä¸­çš„ç¬”è®°è¿›è¡Œéå†ï¼Œè·å–æ–‡ä»¶åfor filename in $filesdo echo \"------------------------------------------------------\" echo $filename # è‹¥å­˜åœ¨æ–°å¢çš„æ–‡ä»¶ï¼Œæ·»åŠ åˆ°hugoä¸­ if [ ! -f \"./content/post/${filename}\" ] then echo \"add ${filename} to hugo\" hugo new post/${filename} # å› hugoç”Ÿæˆçš„æ–‡ä»¶æœ‰å¿…è¦çš„å¤´ï¼Œæ‰€ä»¥è¿½åŠ å†…å®¹è¿›å» cat ${path}${filename} &gt;&gt; ./content/post/${filename} else echo \"${filename} exists\" fidone# åˆ é™¤æ‰“åŒ…æ–‡ä»¶rm -rf publichugo -t mainroad# è¿›å…¥æ‰“åŒ…æ–‡ä»¶å¤¹cd public# git operationsgit initgit add -Amsg=\"building sit 'data'\"# $#æ£€æŸ¥æ‰§è¡Œå‘½ä»¤æ—¶æ‰€å¸¦å‚æ•°ä¸ªæ•°æ˜¯å¦ä¸º1,å‚æ•°å³ä¸ºcommitif [ $# -eq 1 ] then msg=\"$1\"figit commit -m \"$msg\"git push -f git@github.com:fusidic/fusidic.github.io.git mastercd ..","link":"/2019/07/05/hugo%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC%E6%9B%B4%E6%96%B0/"},{"title":"[Leetcode] Q5æœ€é•¿å›æ–‡ä¸²","text":"è¾¹ç•Œé—®é¢˜ Q5: Longest Palindromic SubstringGiven a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000. Example 1: 123Input: &quot;babad&quot;Output: &quot;bab&quot;Note: &quot;aba&quot; is also a valid answer. Example 2: 12Input: &quot;cbbd&quot;Output: &quot;bb&quot; æœ€æš´åŠ›çš„æ‰‹æ®µå½“ç„¶å°±æ˜¯æŠŠæ‰€æœ‰çš„å­ä¸²å…¨éƒ¨åˆ—å‡ºæ¥ï¼Œå¹¶é€ä¸ªåˆ¤æ–­æ˜¯å¦ç¬¦åˆâ€œpalindromeâ€å›æ–‡æ•°çš„æ ‡å‡†ï¼Œå…‰æ˜¯æƒ³ä¸€æƒ³å°±è§‰å¾—å¾ˆéº»çƒ¦ã€‚ æ­¤æ—¶æœ‰ä¸€ä¸ªæ›´ç¬¦åˆç›´è§‰çš„æƒ³æ³•ï¼šå°†å­—ç¬¦ä¸²å€’è¿‡æ¥ï¼Œè¿™æ ·å°±å°†â€œå¯»æ‰¾æœ€å¤§å›æ–‡ä¸²â€è½¬å˜æˆäº†â€œå¯»æ‰¾å…¬å…±å­ä¸²â€çš„é—®é¢˜ï¼Œå½“ç„¶äºŒè€…è¿˜æ˜¯æœ‰ä¸€äº›å°å°çš„åŒºåˆ«çš„ï¼Œä¸”çœ‹åæ–‡ã€‚ &nbsp;&nbsp; è§£æ³•1ï¼šå€’åº+æœ€å¤§å…¬å…±å­ä¸²æ­¤æ—¶ä¸å¦¨ä»¥babadä¸ºä¾‹ï¼Œä»¥å­—ç¬¦ä¸²origin_strå’Œå€’åºå­—ç¬¦ä¸²reverse_stræ„å»ºä¸€ä¸ªäºŒç»´æ•°ç»„(è„‘åŠ›ä¸å¤Ÿï¼Œçº¸ç¬”æ¥å‡‘)ï¼š æ¯å½“å‡ºç°å­—ç¬¦ç›¸ç­‰çš„æƒ…å†µï¼šarray[i][j] = array[i-1][j-1] + 1 å­—ç¬¦ä¸æƒ³ç­‰çš„æƒ…å†µï¼šarray[i][j] = 0 æ­¤æ—¶æ•°ç»„ä¸­è®°å½•çš„æœ€å¤§æ•°å€¼ï¼Œå³ä¸ºæœ€é•¿çš„å…¬å…±å­ä¸²çš„é•¿åº¦ã€‚ å½“ç„¶è¿˜æœ‰å‡ ä¸ªç»†èŠ‚éœ€è¦è€ƒè™‘ï¼š å­˜åœ¨maxLen = arr[i][j]æ˜¾ç¤ºå‡ºé•¿åº¦ï¼ŒåŒæ—¶[i][j]ä¹Ÿå¯ä»¥æŒ‡æ˜â€œåæ ‡â€ï¼Œé€šè¿‡åç§»é‡ç›´æ¥ç”¨åˆ‡ç‰‡è·å–ç›®æ ‡å­—ç¬¦ä¸²ï¼› è¾¹ç•Œæƒ…å†µï¼š i==0æˆ–j==0çš„æƒ…å†µä¸‹ï¼Œç›´æ¥å°†ç¬¦åˆå­—ç¬¦ç›¸ç­‰æƒ…å†µçš„ä½ç½®æ ‡è®° 1 å­—ç¬¦å‡ºå’Œé€†åºå­—ç¬¦ä¸²å¯èƒ½å­˜åœ¨â€œé”™ä½ç›¸ç­‰â€çš„æƒ…å†µï¼Œä»¥æ ‡è®°æœ€å¤§é•¿åº¦çš„ç‚¹ï¼Œåˆ¤æ–­â€œå€’åºåçš„åæ ‡â€å’Œâ€œåŸåæ ‡â€æ˜¯å¦ç›¸ç¬¦ &nbsp;&nbsp; ä»£ç éƒ¨åˆ†ï¼š 1234567891011121314151617181920212223242526272829303132func longestPalindrome(s string) string { reverse := leetutils.Reverse(s) maxLen := 0 index := 0 l := len(s) mtx := make([][]int, l) for i := 0; i &lt; l; i++ { // åˆå§‹åŒ–ï¼Œé»˜è®¤å€¼éƒ½ä¸º0 mtx[i] = make([]int, l) for j := 0; j &lt; l; j++ { // å­—ç¬¦ç›¸åŒ if s[i] == reverse[j] { // è¾¹ç•Œå¤„ç† if i == 0 || j == 0 { mtx[i][j] = 1 } else { mtx[i][j] = mtx[i-1][j-1] + 1 } } // æ›´æ–°maxLen if mtx[i][j] &gt; maxLen { // åˆ¤æ–­æœ«å°¾å…ƒç´ åœ¨så’Œreverseä¸­æ˜¯å¦æ˜¯åŒä¸€ä¸ªå…ƒç´  if (l - 1 - j + mtx[i][j] - 1) == i { maxLen = mtx[i][j] index = i - maxLen + 1 } } } } return s[index : index+maxLen]} æœ€åæ›´æ–°maxLençš„åˆ¤æ–­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹æ³•ï¼šå¯¹æ¯”â€œç›®æ ‡å­ä¸²â€æ˜¯å¦å›æ–‡ï¼ˆæ„Ÿè§‰ä¼šå¼•æ¥æ›´å¤šçš„è¾¹ç•Œï¼‰ è¿™ç§æ€è·¯æ€»çš„æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒè‡ªç„¶ä¸”ç®€å•çš„ï¼Œä¸»è¦çš„éº»çƒ¦é›†ä¸­åœ¨å‡ ä¸ªè¾¹ç•Œé—®é¢˜çš„å¤„ç†ä¸Šã€‚å½“ç„¶å› ä¸ºæ€è·¯æ¯”è¾ƒç®€å•ï¼Œå¯¼è‡´ä¸ç®¡æ˜¯æ—¶é—´å¤æ‚åº¦O(n^2) è¿˜æ˜¯ç©ºé—´å¤æ‚åº¦O(n^2)éƒ½æ˜¯æ¯”è¾ƒé«˜çš„ã€‚ è§£æ³•2ï¼šä¸­å¿ƒæ‰©å±•ä¸­å¿ƒæ‰©å±•å…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå›æ–‡ä¸²è‚¯å®šæ˜¯å¯¹ç§°çš„ï¼Œåœ¨ä¸€æ¬¡éå†ä¸­ï¼Œå¯¹å­—ç¬¦å‘ä¸¤è¾¹è¿›è¡Œæ‰©å±•ï¼Œç¢°åˆ°å·¦å³ç›¸åŒæ—¶å°±ç»§ç»­ï¼Œä¸åŒæ—¶é€€å‡ºã€‚ è¾¹ç•Œé—®é¢˜ï¼š å›æ–‡ä¸²çš„é•¿åº¦â€œå¥‡æ•°/å¶æ•°â€éœ€è¦åˆ†åˆ«è€ƒè™‘ æ‰©å±•â€œç¢°å£â€æ—¶çš„å¤„ç† &nbsp;&nbsp; ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142func longestPalindrome(s string) string { i := 0 l := \"\" temp := \"\" for i &lt; len(s) { // å¥‡æ•° temp = getPalindrome(s, i, i) if len(l) &lt; len(temp) { l = temp } // åˆ¤æ–­æ˜¯å¦ä¼šè¶Šç•Œ if i+1 &lt; len(s) { // å¶æ•° temp = getPalindrome(s, i, i+1) if len(l) &lt; len(temp) { l = temp } } i++ } return l}// getPalindrome å‘ä¸¤è¾¹å»¶ä¼¸æ‰¾åˆ°æœ€å¤§å›æ–‡ä¸²func getPalindrome(s string, left int, right int) string { for left &gt;= 0 &amp;&amp; right &lt; len(s) { if s[left] == s[right] { left-- right++ } else { // å·¦å³ä¸ç›¸åŒï¼Œå›é€€ left++ right-- break } } // ç¢°åˆ°å­—ç¬¦ä¸²è¾¹ç•Œçš„å¤„ç† if left &lt; 0 || right &gt;= len(s) { return s[left+1 : right] } return s[left : right+1]} ç»“åˆä¸Šé¢çš„å›¾ç‰‡å’Œä»£ç ä¸­çš„æ³¨é‡Šï¼Œè¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œåœ¨å­—ç¬¦ä¸²é—®é¢˜è§£é¢˜è¿‡ç¨‹ä¸­ç»å¸¸é‡åˆ°çš„å°±æ˜¯â€œè¶Šç•Œâ€ï¼Œå› æ­¤åœ¨å†™ä»£ç çš„æ—¶å€™è¦æ—¶åˆ»æ³¨æ„åˆ¤æ–­ã€‚ ä¸­å¿ƒæ‰©å±•æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯O(1)ï¼Œå°±æäº¤çš„æƒ…å†µæ¥çœ‹ï¼Œæ€§èƒ½ä¼šè¿œé«˜äºç¬¬ä¸€ä¸ªç®—æ³•ã€‚ &nbsp;&nbsp; è§£æ³•3ï¼šManacherâ€™s AlgorithmManacherç®—æ³•ç†è®ºä¸Šå¯ä»¥å°†ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™åˆ°O(n)ï¼Œäº‹å®ä¸Šå°±æ˜¯åœ¨â€œä¸­å¿ƒæ‰©å±•â€ç®—æ³•åŸºç¡€ä¸Šè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå‡å°‘äº†è®¡ç®—â€œå›æ–‡ä¸²â€çš„æ¬¡æ•°ã€‚ é¢„å¤„ç†ï¼šæ’å…¥#ä¸ºäº†è§£å†³å¥‡æ•°å¶æ•°å¤„ç†é€»è¾‘ä¸ä¸€æ ·çš„é—®é¢˜ï¼Œè¿™é‡Œæœ‰ä¸ªå·§å¦™çš„æ–¹æ³•ï¼šåœ¨æ¯ä¸ªå­—ç¬¦é—´æ’å…¥#ï¼Œå¹¶åœ¨å¼€å¤´ç»“å°¾åˆ†åˆ«æ’å…¥^# #$ï¼Œè¿™æ—¶ä½ ä¼šå‘ç°å­—ç¬¦ä¸²çš„é•¿åº¦ä¸€å®šæ˜¯ä¸€ä¸ªå¥‡æ•°ã€‚è¿™æ ·åœ¨è¿›è¡Œä¸­å¿ƒæ‰©å±•çš„æ—¶å€™ï¼Œå¤„ç†çš„æ°¸è¿œæ˜¯å¥‡æ•°é•¿åº¦çš„å­—ç¬¦ä¸²äº†ã€‚ æ±‚P[i]å¯¹æ¯ä¸ªä½ç½®ä¸ºiçš„ç‚¹ï¼Œä»¥å…¶ä¸ºå¯¹ç§°ä¸­å¿ƒï¼Œå·¦å³å¯¹ç§°ç‚¹çš„ä¸ªæ•°å³ä¸ºP[i]ï¼ˆåŒ…æ‹¬#ï¼Œåæ–‡æˆ‘ä»¬ç§°P[i]ä¸ºå›æ–‡åŠå¾„ï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸Šå›¾ä¸­çš„C(center)ï¼Œä¾¿æ˜¯è®¡ç®—çš„ä¸­å¿ƒï¼Œå¦‚æœå°†Cä»å¤´åˆ°å°¾éå†ä¸€æ¬¡ï¼Œé‚£å°±æ˜¯â€œä¸­å¿ƒæ‰©å±•â€ç®—æ³•äº†ï¼ŒManacherçš„æ ¸å¿ƒå°±æ˜¯è·³è¿‡ä¸å¿…è¦çš„Cï¼Œä»¥æ­¤æé«˜è®¡ç®—çš„æ•ˆç‡ã€‚ ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼ŒCä¸ºå¯¹ç§°ä¸­å¿ƒï¼Œå¯¹ç§°åŠå¾„ä¸º5ï¼Œé‚£ä¹ˆå¯ä»¥åˆ¤å®šå¤„äºT[6-5 : 6+5]å³T[1 : 11]å†…çš„æ‰€æœ‰å¯¹ç§°ç‚¹(iä¸i_mirror)éƒ½å…·æœ‰ç›¸åŒçš„å±æ€§. iä»Cçš„ä¸´è¿‘å‡ºé€æ¸è¿œç¦»ï¼ŒP[i]çš„ä½œç”¨æ˜¯é¢„å…ˆç¡®å®šå›æ–‡åŠå¾„ï¼Œå› æ­¤æˆ‘ä»¬è‡³å°‘å¯ä»¥åˆ¤å®šiæ‰€æŒ‡çš„P[i]è‡³å°‘ä¸º3ï¼Œå½“iå¤„å¼€å§‹ä¸­å¿ƒæ‰©å±•æ—¶ï¼Œå°±å¯ä»¥ä»3å¼€å§‹ï¼ŒèŠ‚çœäº†æ—¶é—´ã€‚ â€‹ ä¾ç„¶å¾ˆé‡è¦çš„è¾¹ç•Œé—®é¢˜ : P[i]å—åˆ°P[i_mirror]ä¸è¾¹ç•ŒRçš„é™åˆ¶ï¼Œä¸ºå…¶ä¸­çš„è¾ƒå°å€¼ï¼ŒåŸå› æ˜¯å½“i+P[i_mirror]å¯èƒ½ä¼šè¶…å‡ºè¾¹ç•ŒRï¼Œè¶…å‡ºè¾¹ç•Œæ—¶ï¼Œå°±éœ€è¦æ›´æ–°ä¸­å¿ƒCä¸è¾¹ç•ŒRï¼› åœ¨iå‘å³ä¾§å±•å¼€æ—¶ï¼Œä¾ç„¶è¦å¯¹æ¯ä¸ªç‚¹è¿›è¡Œâ€œä¸­å¿ƒå±•å¼€â€ï¼Œä½†ç”±äºP[i_mirror]å¯ä»¥ä¸€å®šç¨‹åº¦é¿å…é‡å¤è®¡ç®—ï¼› â€‹ æå–ç›®æ ‡å›æ–‡ä¸²å¯ä»¥å‘ç°iå‡å»P [ i ]ï¼Œå†é™¤ä»¥ 2ï¼Œå°±æ˜¯åŸå­—ç¬¦ä¸²çš„å¼€å¤´ä¸‹æ ‡äº†ï¼Œæ‰€ä»¥åˆ©ç”¨æœ€å¤§çš„P[i]ä¸å…¶ä½ç½®iï¼Œå°±å¯ä»¥ä»åŸå­—ç¬¦ä¸²ä¸­æå–å‡ºç›®æ ‡å›æ–‡ä¸²ã€‚ ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263func longestPalindrome3(s string) string { origin := s s = pretreatment(s) len := len(s) // p[] å­˜å‚¨å„ä¸ªç‚¹ä¸Šçš„ä¸­å¿ƒæ‰©å±•(å›æ–‡)å€¼ p := make([]int, len) var center, bound, maxLen, centerIndex int p[0] = 0 p[1] = 0 center = 1 // å¯¹rightç‚¹ ç¡®å®šp[right] for right := 1; right &lt; len-1; right++ { left := 2*center - right // è¶…å‡ºè¾¹ç•Œ if right &gt; bound { p[right] = 0 } else { // å–leftï¼Œbound-i (åˆ°è¾¹ç•Œçš„è·ç¦»)ï¼Œp[left] (é•œåƒä½ç½®) p[right] = int(math.Min(float64(bound-right), float64(p[left]))) } // å¯¹æ­£åœ¨å¤„ç†çš„rightç‚¹ï¼Œå°è¯•ä¸­å¿ƒæ‰©å±• for s[right+1+p[right]] == s[right-1-p[right]] { p[right]++ } // è¶…å‡ºç•Œé™, æ›´æ–° center å’Œ bound if (right + p[right]) &gt; bound { center = right bound = right + p[right] } } for i := 1; i &lt; len-1; i++ { if p[i] &gt; maxLen { maxLen = p[i] centerIndex = i } } startIndex := (centerIndex - maxLen) / 2 return origin[startIndex : startIndex+maxLen]}func pretreatment(s string) string { len := len(s) if len == 0 { return \"^$\" } cue := []rune(\"^#$\") var res []rune runes := []rune(s) res = append(res, cue[0]) for i := 0; i &lt; len; i++ { res = append(res, cue[1], runes[i]) } res = append(res, cue[1], cue[2]) return string(res)}","link":"/2020/04/03/leetcodeQ5/"},{"title":"[Python] å˜é‡ä½œç”¨åŸŸç›¸å…³","text":"pythonä½œç”¨åŸŸé¦–å…ˆå…ˆè¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯pythonçš„å˜é‡ä½œç”¨åŸŸåˆ†ä¸ºï¼šloca, nonlocal, global, builtin å˜é‡çš„æŸ¥æ‰¾é¡ºåºæ˜¯ç”±å†…åˆ°å¤–çš„ã€‚ 1234567891011121314151617# å—çº§ä½œç”¨åŸŸif 1 == 1ï¼š name = 'zjs' print(name)for i in range(10): age = i print(age)# å±€éƒ¨ä½œç”¨åŸŸdef func(): name = 'zjs' print(name) ä½œç”¨åŸŸé“¾è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šç»ˆæç‰ˆ 12345678910name = 'zjs'def f1(): print(name) def f2(): name = 'eric' f1() f2() æœ€ç»ˆçš„è¾“å‡ºæ˜¯â€™zjsâ€™ è¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œå‡½æ•°åœ¨æœªæ‰§è¡Œä¹‹å‰ï¼Œä½œç”¨åŸŸå°±å·²ç»å½¢æˆäº†","link":"/2019/07/05/python%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9B%B8%E5%85%B3/"},{"title":"[NOTE] sshå…å¯†ç™»é™†é…ç½®","text":"ç¬¬næ¬¡å¿˜è®° ç”Ÿæˆå…¬é’¥ssh-keygen -t rsa scp -p id_rsa.pub hadoop@slave1:~/.ssh/id_rsa_master.pub æ£€æŸ¥æ˜¯å¦å­˜åœ¨touch authorized_keysï¼Œå¹¶chmod 600 authorized_keys cat ~/.ssh/id_rsa_master.pub &gt;&gt; authorized_keyJ","link":"/2019/07/05/ssh%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86%E9%85%8D%E7%BD%AE/"},{"title":"[Golang] ç®€å•å¹¶å‘telnetæœåŠ¡å™¨","text":"ä¸€ä¸ªå°demoï¼Œé€šè¿‡goroutineç®€å•é«˜æ•ˆåœ°å®ç°å¹¶å‘çš„æ“ä½œã€‚ goroutineç±»ä¼¼Pythonã€C#ä¸­çš„coroutineï¼Œéƒ½å¯ä»¥ä½¿å‡½æ•°åœ¨ç‹¬ç«‹çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œä¸ä¹‹ä¸åŒçš„æ˜¯ï¼ŒgoroutineæŸç§ç¨‹åº¦ä¸Šæ¥è¯´æ›´ä¸ºå¼ºå¤§ä¸€äº›ï¼Œå®ƒå…è®¸å¹¶è¡Œæ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡channelè¿›è¡Œè¿›ç¨‹é—´çš„é€šä¿¡ã€‚ å½“ç„¶ï¼Œå…¶ä»–çš„åŒºåˆ«ä¹Ÿæœ‰å¾ˆå¤šï¼Œä½†ä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´ä¹‹å†…ï¼Œä¹‹åä¼šå°†è¿™æ–¹é¢çš„çŸ¥è¯†å½’çº³æ€»ç»“ä¸€æ¬¡ã€‚ 1.ç¨‹åºåˆ†æç¨‹åºä¸­éœ€è¦å®ç°ä¸€ä¸ªç®€å•çš„telnetæœåŠ¡å™¨ï¼Œå¯¹åœ°å€ç«¯å£è¿›è¡Œç›‘å¬ï¼Œå¹¶å°†ä¼ é€æ¥çš„ä¿¡æ¯â€œå®Œç’§å½’èµµâ€ã€‚ ä¸»æ–¹æ³•ä¸­ä¸»è¦è´Ÿè´£å¼€å¯server(address string, exitChan chan int)çº¿ç¨‹ï¼ŒexitChané€šé“ä¸­åœ¨æ²¡æœ‰ä¼ æ¥serverä¿¡æ¯ä¹‹å‰ï¼Œä¼šä¸€ç›´é˜»å¡ä¸»æ–¹æ³•ã€‚ server()ä¸­å¯¹æŒ‡å®šåœ°å€ç«¯å£æŒç»­ç›‘å¬(å‡ºç°é—®é¢˜å‘exitChanä¸­ä¼ å…¥éæ­£å¸¸é€€å‡ºçš„ä¿¡å·)ï¼Œå½“æœ‰è¯·æ±‚ä¼ æ¥æ—¶ï¼ŒAcceptå¹¶å¼€å¯ä¸€ä¸ªå¤„ç†ä¼šè¯çš„çº¿ç¨‹handleSession(conn net.Conn, exitChan)ï¼ŒhandlerSession()ä¸»è¦å¯¹ä¼ æ¥çš„ä¿¡æ¯è¿›è¡Œè§£æï¼šå­—èŠ‚ç è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶åˆ¤æ–­å‰ç¼€æ˜¯å¦æœ‰æŒ‡ä»¤ï¼Œæ ¹æ®ä¼ æ¥çš„ä¿¡æ¯ä¸åŒï¼Œæ‰§è¡Œä¸åŒçš„å“åº”ã€‚ è¯¥ç¨‹åºçš„ä¸»è¦å¤„ç†è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š 1.1 server.go123456789101112131415161718192021222324package mainimport ( \"fmt\" \"net\")func server(address string, exitChan chan int) { l, err := net.Listen(\"tcp\", address) if err != nil { fmt.Println(err.Error()) exitChan &lt;- 1 } fmt.Println(\"listen:\" + address) defer l.Close() for { conn, err := l.Accept() if err != nil { fmt.Printf(err.Error()) continue } go handleSession(conn, exitChan) }} æ³¨æ„ä½¿ç”¨deferï¼Œå°†ç›‘å¬å…³é—­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 1.2 session.go12345678910111213141516171819202122232425262728293031package mainimport ( \"bufio\" \"fmt\" \"net\" \"strings\")func handleSession(conn net.Conn, exitChan chan int) { fmt.Println(\"Session started:\") reader := bufio.NewReader(conn) for { str, err := reader.ReadString('\\n') if err == nil { str = strings.TrimSpace(str) if !processTelnetCommand(str, exitChan) { conn.Close() break } // Echo with the same string conn.Write([]byte(str + \"\\r\\n\")) } else { // Error fmt.Println(\"Session closed by mistake\") fmt.Println(err.Error()) conn.Close() break } }} ä¸»è¦æ³¨æ„ç½‘ç»œè¯·æ±‚çš„å¤„ç†æ–¹æ³•ã€æ­¥éª¤ã€‚ 1.3 telnet.go12345678910111213141516171819package mainimport ( \"fmt\" \"strings\")func processTelnetCommand(str string, exitChan chan int) bool { if strings.HasPrefix(str, \"@close\") { fmt.Println(\"Session closed\") return false } else if strings.HasPrefix(str, \"@shutdown\") { fmt.Printf(\"Server shutdown\") exitChan &lt;- 0 return false } fmt.Println(str) return true} 1.4 main.go12345678910package mainimport \"os\"func main() { exitChan := make(chan int) go server(\"192.168.1.4:60001\", exitChan) code := &lt;-exitChan os.Exit(code)} exitChançš„ä½¿ç”¨ã€‚","link":"/2020/03/13/telnet-server/"},{"title":"[æ°´] ä¸ªäººåšå®¢çš„æ„ä¹‰","text":"ä¹‹å‰ä¸€ç›´åœ¨æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä½œä¸ºä¸€ä¸ªå°ç™½ï¼Œæ—¢ä¸èƒ½åœ¨æŠ€æœ¯æ·±åº¦ä¸Šæœ‰æ‰€å»ºæ ‘ï¼Œä¹Ÿæ— æ³•åœ¨çŸ¥è¯†èŒƒå›´ä¸Šè¶…è¶Šæ—äººï¼Œé‚£ä¹ˆæˆ‘å†™åšå®¢çš„æ„ä¹‰åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ä¸€äº›è¯´æ³•æ°å¥½å‰æ—¥åœ¨v2exä¸Šçœ‹åˆ°ä¸€ä¸ªæé—®ï¼Œæé—®è€…ä¹Ÿå¤§æ¦‚æ˜¯é‡åˆ°äº†è·Ÿæˆ‘å·®ä¸å¤šçš„é—®é¢˜ï¼Œåº•ä¸‹çš„å›ç­”ä¹Ÿç®—æ˜¯è®©æˆ‘äº†è§£äº†å…¶ä»–äººçš„ä¸€äº›æƒ³æ³•ã€‚ å…¶ä¸­æœ‰ä¸ªè¯´æ³•å¾ˆæœ‰æ„æ€ï¼šå¤§éƒ¨åˆ†ä¸ªäººåšå®¢éƒ½å¤­æŠ˜åœ¨äº†â€œå¦‚ä½•ä½¿ç”¨xxæ­å»ºä¸€ä¸ªåšå®¢å¹³å°â€ä¸Šï¼Œå¥½ä¸€ç‚¹çš„è¯ï¼Œ30ç¯‡å·¦å³çš„æ–‡ç« å·®ä¸å¤šä¹Ÿæ˜¯å¤§å¤šæ•°ä¸ªäººåšå®¢çš„ç»ˆç‚¹äº†ã€‚æ•°äº†æ•°è‡ªå·±åšå®¢æ–‡ç« çš„æ•°é‡ï¼Œå¤§æ¦‚æ˜¯è¿˜æ²¡æœ‰æ´»è¿‡æ—©å¤­æœŸã€‚ ä¹Ÿä¸å¥½å¤¸ä¸‹æµ·å£è‡ªå·±çš„ä¸ªäººåšå®¢èƒ½æ´»å¤šä¹…ï¼Œèƒ½æœ‰å¤šå°‘äº§å‡ºï¼Œå› ä¸ºè¿™åˆæ¶‰åŠåˆ°äº†å¦ä¸€ä¸ªæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„é—®é¢˜ï¼šæ–‡ç« æ˜¯å¦æœ‰ä»·å€¼ã€‚ æœ‰äº›äººä¹ æƒ¯å°†æµé‡ä½œä¸ºè¡¡é‡åšå®¢ç½‘ç«™ä»·å€¼çš„æ ‡å‡†ä¹‹ä¸€ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¤ªç†è§£ä»–ä»¬çš„ä¸€äº›æƒ³æ³•ï¼Œå¯èƒ½æ˜¯æŸç§â€œç«™é•¿æ€ç»´â€å§ã€‚å°±æˆ‘ç›®å‰çš„æ°´å¹³è€Œè¨€ï¼Œæˆ‘çš„åšå®¢ä¸­å¤§å¤šæ•°çš„æ–‡ç« éƒ½æ˜¯è®°å½•çš„è‡ªå·±åœ¨å®è·µè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ä»¥åŠç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œæœ‰äº›é—®é¢˜å…·æœ‰ç‰¹å¼‚æ€§ï¼Œæœ‰äº›é—®é¢˜åƒç¯‡ä¸€å¾‹ï¼Œå› æ­¤æˆ‘ä¹Ÿæ˜¯ä¸å¤ªå¸Œæœ›æˆ‘çš„åšå®¢è¢«è®¿å®¢ä»¬çœ‹åˆ°ï¼Œé¢‡æœ‰ç§é²é±¼ä¹‹è‚†çš„é„™è–„ä¹‹æ„Ÿã€‚ å°±ç°é˜¶æ®µè€Œè¨€ï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒèµåŒä¸€äº›äººçš„æ„è§ï¼šä¸ç®¡æ˜¯æˆä¸ºåšå®¢è¿˜æ˜¯ç¬”è®°ï¼Œåœ¨æˆ‘å†™å°±ä¹‹åˆï¼Œå…¶å®é’ˆå¯¹çš„åªæ˜¯æˆ‘ä¸€ä¸ªäººï¼Œæ—¢ä½œä¸ºé”»ç‚¼è‡ªå·±è¯­è¨€ç»„ç»‡èƒ½åŠ›çš„ä¸€ç§æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä»¥åé‡åˆ°ç›¸åŒé—®é¢˜çš„ä¸€ä¸ªé€ŸæŸ¥ä¸å¤‡å¿˜ã€‚ ä¸€äº›å±•æœ› ä¸Šæ–‡ä¹Ÿæåˆ°äº†ï¼Œåšå®¢çš„ç›®æ ‡ç”¨æˆ·å°±æ˜¯æˆ‘è‡ªå·±ï¼Œæ‰€ä»¥åœ¨ä¸€äº›æ–‡ç« çš„è¡¨è¿°ä¸­å¤šæœ‰ç•¥å†™ï¼Œæœ‰å‡ æ¬¡åˆ†äº«ç»™åŒå­¦çœ‹çš„æ—¶å€™ï¼Œå¾€å¾€éƒ½ä¼šè¢«è¯´å†™å¾—ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œç”šè‡³æœ‰æ—¶å€™æˆ‘å›å¤´è‡ªå·±çœ‹çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦ç»è¿‡ä¸€ç•ªå›å¿†ã€‚å¸Œæœ›ä¹‹åçš„æ–‡ç« èƒ½å°†è¯­è¨€ç»„ç»‡çš„æ›´å¥½ï¼ŒåŒæ—¶åœ¨å¿…è¦çš„åœ°æ–¹èƒ½å¤šäº›ç¬”å¢¨ã€‚ ä¹‹å‰ä¹Ÿçœ‹è¿‡ä¸€äº›ä¼˜ç§€çš„åšå®¢ï¼Œä¸”ä¸è®ºå‰è¾ˆçš„æŠ€æœ¯æ°´å¹³è¶³ä»¥å½¢æˆç¢¾å‹ä¹‹åŠ¿ï¼Œåœ¨å…¶ä»–æ–¹é¢ä¹Ÿé¢‡æœ‰äº›é€¼æ ¼ã€‚å¦‚æˆ‘æ‰€è§åˆ°çš„å‡ ä½æ¸…åçš„åšä¸»ï¼Œåšå®¢ä¸­çŠ¹å–œæ¬¢ç”¨è‹±æ–‡ç”šè‡³ç¹ä½“ä¸­æ–‡ï¼Œè¿˜æœ‰äº›åœ¨æ‘„å½±æ–¹é¢æœ‰æ‰€é•¿çš„ï¼Œåœ¨æ—…æ¸¸æ–¹é¢é¢‡æœ‰äº›ç»å†çš„ï¼Œä»–ä»¬çš„åšå®¢éƒ½ä»¤æˆ‘å¿ƒå‘å¾€ä¹‹ã€‚æ‰€ä»¥ï¼Œä¸ç®¡æ˜¯ä½œä¸ºä¸€ä¸ªæŠ€æœ¯åšå®¢è¿˜æ˜¯è®°å½•ç”Ÿæ´»çš„å¹³å°ï¼Œå¸Œæœ›ä¹‹åéƒ½èƒ½å½¢æˆæˆ‘è‡ªå·±çš„é£æ ¼ï¼Œå˜å¾—æœ‰æ„æ€ä¸€äº›ã€‚ åœ¨æ–‡ç« æ·±åº¦æ–¹é¢ï¼Œå¸Œæœ›ä¸ä»…ä»…åªæ˜¯äº›â€å¤ç°â€œä»–äººåšå®¢çš„æ–‡ç« ã€‚","link":"/2019/08/15/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%84%8F%E4%B9%89/"},{"title":"[NOTE] å†…ç½‘ç©¿é€","text":"åœ¨å¼€äº†ä¸€å°å…·æœ‰å…¬ç½‘IPçš„äº‘ä¸»æœºä¹‹åï¼Œåˆ©ç”¨ä»£ç†æœåŠ¡å™¨æ¥å®ç°æœ¬åœ°æœåŠ¡å™¨å†…ç½‘ç©¿é€çš„è®¡åˆ’ç»ˆäºå¯ä»¥å¼€å§‹äº†ã€‚ ngrokå®ç°å†…ç½‘ç©¿é€ä¸€ã€ç›¸å…³åŸç†1.æ­£å‘ä»£ç† æ­£å‘ä»£ç†ä¸­ï¼Œclientçš„ç›®çš„åœ°å€æ˜¯ç›®æ ‡æœåŠ¡å™¨ï¼Œä½†ç”±äºç§ç§åŸå› ï¼Œä¸ç›®æ ‡æœåŠ¡å™¨ä¹‹é—´è¿æ¥æ…¢æˆ–è€…æ— è¿æ¥ï¼Œå› æ­¤ï¼Œä½¿ç”¨äº†ä¸€ä¸ªä¸­é—´åª’ä»‹â€”â€”ä»£ç†æœåŠ¡å™¨æ¥æ‰¿æ‹…ä¸€ä¸ªä¸­ä»‹çš„åŠŸèƒ½ã€‚ 2.åå‘ä»£ç† åå‘ä»£ç†ä¸æ­£å‘ä»£ç†ä¸åŒï¼ŒClientçš„ç›®çš„åœ°å€å°±æ˜¯ProxyæœåŠ¡å™¨ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯å‘ç»™Proxyï¼Œæœ‰Proxyåˆ†é…ç»™å®ƒä¹‹åçš„æœåŠ¡å™¨æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶è¿”å›ç»“æœã€‚åå‘ä»£ç†ä¸»è¦ç‰¹ç‚¹ï¼š ä¿æŠ¤å’Œéšè—åŸå§‹èµ„æºæœåŠ¡å™¨ åŠ å¯†å’ŒSSLåŠ é€Ÿ è´Ÿè½½å‡è¡¡ ç¼“å­˜é™æ€å†…å®¹ å‹ç¼© å‡é€Ÿä¸Šä¼  å®‰å…¨ å¤–ç½‘å‘å¸ƒ 3.å†…ç½‘ç©¿é€Ngrokäº‹å®ä¸Šæ˜¯ä¸€ä¸ªéš§é“ï¼Œå³å»ºç«‹å®‰å…¨é€šé“ä»å…¬å…±ç«¯ç‚¹åˆ°æœ¬åœ°è¿è¡Œçš„ç½‘ç»œæœåŠ¡ï¼ŒåŒæ—¶æ•æ‰æ£€æŸ¥å’Œé‡æ’­æ‰€æœ‰æµé‡çš„åå‘ä»£ç†ã€‚ ç®€å•æ¥è¯´ï¼Œä»–å¯ä»¥ä»£ç†ä½ æœ¬åœ°çš„æ•°æ®ï¼Œå¹¶å°†å…¶è½¬å‘åˆ°å¤–ç½‘ï¼Œæµç¨‹å¦‚ä¸‹ï¼š 123451. æœ¬åœ°å†…ç½‘ä¸»æœºå’ŒæœåŠ¡å™¨Aæ„å»ºä¸€æ¡è¿æ¥2. ç”¨æˆ·è®¿é—®æœåŠ¡å™¨A3. æœåŠ¡å™¨Aè”ç³»æœ¬åœ°å†…ç½‘ä¸»æœºè·å–å†…å®¹4. æœåŠ¡å™¨Aå°†è·å–åˆ°çš„å†…å®¹å‘é€ç»™ç”¨æˆ·5. é€šè¿‡ä¸Šé¢çš„æµç¨‹ï¼Œå°±å®ç°äº†ç”¨æˆ·è®¿é—®åˆ°äº†æˆ‘ä»¬å†…ç½‘çš„å†…å®¹ã€‚ æ›´ç›´è§‚ç‚¹ï¼Œå€Ÿç”¨frpæ–‡æ¡£ä¸­çš„è¿™å¼ å›¾æ¥è¯´æ˜ã€‚ äºŒã€ç¯å¢ƒä¸æºç  ç›¸å…³ä¾èµ– 1sudo apt-get install build-essential golang mercurial git Ngrokæºç  123git clone https://github.com/inconshreveable/ngrok.git ngrok## å»ºè®®è¯·ä½¿ç”¨ä¸‹é¢çš„åœ°å€ï¼Œä¿®å¤äº†æ— æ³•è®¿é—®çš„åŒ…åœ°å€git clone https://github.com/tutumcloud/ngrok.git ngrok å¦‚ä¸€å®šè¦ä½¿ç”¨ä¸Šé¢çš„å®˜æ–¹åœ°å€ï¼Œéœ€è¦ä¿®æ”¹ src/ngrok/log/logger.go ä¸­çš„æºä»£ç ï¼Œå°† log &quot;code.google.com/p/log4go&quot; ä¿®æ”¹ä¸º log &quot;github.com/alecthomas/log4go&quot; å¦åˆ™ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ build fails: 'package code.google.com/p/log4go: unable to detect version control system for code.google.com/ path' ä¸‰ã€ç”ŸæˆTLSè¯ä¹¦ä»¥æˆ‘ä»¬çš„åŸŸånuzar.topä¸ºä¾‹ï¼Œç”±äºæš‚æ—¶æ²¡æœ‰é€šè¿‡å¤‡æ¡ˆï¼Œæ— æ³•è®¾ç½®äºŒçº§åŸŸåï¼Œå› æ­¤æš‚å…ˆä½¿ç”¨ä¸€çº§åŸŸåã€‚ ç”ŸæˆTLSçš„å‘½ä»¤å¦‚ä¸‹ï¼š 1234567NGROK_DOMAIN=\"nuzar.top\"openssl genrsa -out rootCA.key 2048openssl req -x509 -new -nodes -key rootCA.key -subj \"/CN=$NGROK_DOMAIN\" -days 3650 -out rootCA.pemopenssl genrsa -out device.key 2048openssl req -new -key device.key -subj \"/CN=$NGROK_DOMAIN\" -out device.csropenssl x509 -req -in device.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out device.crt -days 3650 å°†å®˜æ–¹ngrok.comçš„è¯ä¹¦æ›¿æ¢ä¸ºåˆšåˆšç”Ÿæˆçš„ç§æœ‰è¯ä¹¦ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è´­ä¹°ä¸€ä¸ªSSLè¯ä¹¦ï¼Œè¿™ä¸ªåœ°æ–¹ä¼¼ä¹å¯ä»¥ç”¨é˜¿é‡Œäº‘æä¾›çš„nuzar.pemè¯ä¹¦ï¼Œä½†ç”±äºæ˜¯åˆæ¬¡æ­å»ºå†…ç½‘ç©¿é€çš„æœåŠ¡ï¼Œå…ˆå·²ç¨³ä¸ºä¸»ã€‚ 123cp rootCA.pem assets/client/tls/ngrokroot.crtcp device.crt assets/server/tls/snakeoil.crt cp device.key assets/server/tls/snakeoil.key å››ã€ç¼–è¯‘æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ç¨‹åº è®¾ç½®Golangç¼–è¯‘ç›®å½•å’Œå‚æ•° 12export GOPATH=/goexport CGO_ENABLED=0 ç¬¬äºŒæ¡å‘½ä»¤æ˜¯ä¸ºäº†å¯ä»¥åœ¨ docker ç¯å¢ƒä¸‹è¿è¡Œçš„éœ€è¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ Unable to run a go program inside docker /bin/sh: ./ngrokd: not found ç¼–è¯‘ngrokæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ 1234567891011121314151617181920212223# Linux 32 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=linux GOARCH=386make release-server release-client# Linux 64 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=linux GOARCH=amd64make release-server release-client# Windows 32 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=windows GOARCH=386make release-server release-client# Windows 64 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=windows GOARCH=amd64make release-server release-client# macOS 32 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=darwin GOARCH=386make release-server release-client# macOS 64 ä½ç³»ç»Ÿ ngrok ç¼–è¯‘å‘½ä»¤export GOOS=darwin GOARCH=amd64make release-server release-client äº”ã€è¿è¡ŒngrokdæœåŠ¡ç«¯ç¼–è¯‘å®Œæˆä¹‹åå¯ä»¥åœ¨ bin ç›®å½•ä¸‹çœ‹åˆ° ngrokdï¼ˆæœåŠ¡ç«¯ï¼‰å’Œ ngrokï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼Œè¿è¡ŒæœåŠ¡ç«¯æ—¶éœ€è¦å°† assets/server/tls/snakeoil.crt å’Œ assets/server/tls/snakeoil.key ngrokdæœåŠ¡ç«¯å¯åŠ¨ï¼š 1./ngrokd -tlsKey=snakeoil.key -tlsCrt=snakeoil.crt -domain=\"nuzar.top\" -httpAddr=\":80\" -httpsAddr=\":443\" -tunnelAddr=\":4443\" è¿™è¡Œå‘½ä»¤ä¸­ï¼ŒæŒ‡å®šäº†ç›¸å…³è¯ä¹¦ã€åŸŸåï¼Œä¹‹åçš„80ã€443ç«¯å£æŒ‡çš„æ˜¯ngrokdä¼šç›‘å¬è¿™äº›ç«¯å£çš„ä¿¡æ¯ï¼Œå¦‚æœæ”¶åˆ°ä¿¡æ¯ï¼Œå°±ä¼šè½¬ç»™ç›¸åº”çš„åè®®åœ°å€è¿›è¡Œå¤„ç†ï¼Œ4443ç«¯å£ç”¨äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¿æŒéš§é“è¿æ¥ã€‚ å…­ã€è¿è¡Œngrokå®¢æˆ·ç«¯åœ¨å®¢æˆ·ç«¯é€šè¿‡scpå‘½ä»¤ä»æœåŠ¡ç«¯ä¸­æ‹‰å–å®¢æˆ·ç«¯çš„å¯æ‰§è¡Œç¨‹åºï¼Œå¹¶ç¼–å†™ä¸€ä¸ªngrok.cfgæ–‡ä»¶ 12server_addr: \"nuzar.top:4443\"trust_host_root_certs: false è¿™é‡Œæ³¨æ„server_addrä¸€å®šè¦å’Œä¹‹å‰ç”ŸæˆTLSè¯ä¹¦æ­¥éª¤ä¸­çš„åœ°å€ä¿æŒä¸€è‡´ï¼Œå¦åˆ™æœåŠ¡ç«¯ä¼šæŠ¥tls: bad certificateè¯ä¹¦é”™è¯¯ã€‚ ä¸ƒã€å°ç»“é—æ†¾çš„æ˜¯ï¼Œç»è¿‡ä¸€ä¸ªç™½å¤©çš„åŠªåŠ›ï¼Œæˆ‘ç¡®è®¤æ‰€æœ‰æ­¥éª¤éƒ½æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶ä¼šåœ¨æœåŠ¡ç«¯æ˜¾ç¤ºè¯ä¹¦æœ‰é—®é¢˜ï¼Œç›¸å…³é—®é¢˜è¿™ç¯‡åšå®¢éƒ½è¯´çš„å¾ˆæ¸…æ¥šï¼Œæˆ‘ä¹Ÿéƒ½å·²ç»ä¸€ä¸€ç¡®è®¤è¿‡ã€‚å¹¶ä¸”ç”±äºngrok1.xç‰ˆæœ¬çš„å¼€å‘äººå‘˜å·²ç»åœæ­¢ç»´æŠ¤ï¼Œngrok2.xç‰ˆæœ¬ä¸ºé—­æºè½¯ä»¶ï¼Œå†³å®šé‡‡ç”¨å¦ä¸€å¥—æ–¹æ¡ˆã€‚ frpå®ç°å†…ç½‘ç©¿é€é¦–å…ˆè¯´æ˜ï¼Œfrpæ˜¯ç”±å›½äººå¼€å‘çš„ï¼Œæœ‰éå¸¸å¥½çš„ä¸­æ–‡æ–‡æ¡£æ”¯æŒï¼Œé¡¹ç›®ç›®å‰å¤„äºé¡¹ç›®å¼€å‘çš„åˆæœŸï¼Œå¯é æ€§ä¸Šé¢å¯èƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯åœ¨ngrokæ–¹æ¡ˆè¿·ä¹‹å‡ºé”™çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯å€¼å¾—ä¸€è¯•çš„ã€‚ frpé…ç½®ååˆ†ç®€å•ï¼Œä»è¿™æ‰¾åˆ°é€‚åˆä½ æœºå™¨çš„æœ€æ–°ç‰ˆæœ¬ï¼ŒåŒæ ·çš„ï¼Œfrpä¹Ÿæ˜¯åˆ†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œä½†æ˜¯åœ¨ä½ ä¸‹è½½çš„æ–‡ä»¶ä¸­ï¼Œå·²ç»åŒ…å«äº†å¯æ‰§è¡Œçš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºï¼Œååˆ†å‹å¥½ã€‚ è§£å‹ä¸‹è½½çš„.tar.gzåŒ…ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å †æ–‡ä»¶ä¸­åŒ…å«å››ä¸ªæ–‡ä»¶frpc frpc.ini frps frps.iniï¼Œè¿™å››ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ç¨‹åºåŠå…¶é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ­£å¥½æ˜¯ä¸ªå¼ºè¿«ç—‡çš„è¯ï¼Œä½ å®Œå…¨å¯ä»¥åœ¨æœåŠ¡ç«¯åªç•™ä¸‹frps frps.iniè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå®¢æˆ·ç«¯åŒç†ã€‚ ä½¿ç”¨æœ€ç®€åŒ–çš„é…ç½®ï¼š 123# frps.ini[common]bind_port = 7000 å¯åŠ¨frps: ./frps -c ./frps.ini 1234567891011# frpc.ini[common]server_addr = x.x.x.xserver_port = 7000[ssh]type = tcplocal_ip = 127.0.0.1local_port = 22remote_port = 6000# å³å¯é€šè¿‡x.x.x.x:6000æ¥è®¿é—®127.0.0.1:22 å¯åŠ¨frpc: ./frpc -c ./frpc.ini å½“é‡åˆ°ç«¯å£å ç”¨çš„é—®é¢˜æ—¶ï¼Œé€šè¿‡netstat -tunlpå¯ä»¥æŸ¥çœ‹å ç”¨ç«¯å£çš„ç¨‹åºçš„pidï¼Œä¸€å®šè¦åœ¨ç¡®å®šè‡ªå·±è¦åšä»€ä¹ˆçš„æƒ…å†µä¸‹ï¼Œkill -9 {PID} é…ç½®å¤šä¸ªå†…ç½‘ä¸»æœºé”™è¯¯çš„å¤šå®¢æˆ·ç«¯é…ç½®ä½¿ç”¨ä¸€å°é˜¿é‡Œäº‘çš„å…¬ç½‘æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®å¾ˆå¤šå†…ç½‘æœºå™¨çš„ frp å†…ç½‘ç©¿é€ï¼Œå…¬ç½‘æœåŠ¡å™¨ä¸Šåªéœ€è¦æŒ‰ç…§ä¸Šè¿°çš„é…ç½®ä¸€æ¬¡å³å¯ï¼Œä½†æ˜¯å†…ç½‘æœºå™¨çš„é…ç½®ç¨æœ‰ä¸åŒï¼Œå¦‚æœä½¿ç”¨äº†ä¸€æ ·çš„é…ç½®åˆ™åæ·»åŠ çš„å†…ç½‘æœºå™¨æ˜¯æ— æ³•è¿æ¥ä¸Šå…¬ç½‘æœåŠ¡å™¨çš„ã€‚è¿™é‡Œå‡è®¾å¦ä¸€å°å†…ç½‘æœºå™¨2çš„ frpc.ini é…ç½®å¦‚ä¸‹ï¼Œæ¥è¯´æ˜ä¼šé‡åˆ°çš„é—®é¢˜ï¼š 123456789[common]server_addr = xxx.xxx.xxx.xxx &lt;==è¿™é‡Œè¿˜æ˜¯æŒ‰ç…§ä¸Šé¢çš„å‡è®¾ï¼Œå…¬ç½‘æœåŠ¡å™¨çš„ipä¸ºxxx.xxx.xxx.xxxserver_port = 7000[ssh]type = tcp local_ip = 127.0.0.1local_port = 22remote_port = 6001 &lt;==remote_portè®¾ç½®ä¸ºå¦ä¸€ä¸ªå€¼ ä¸¤ä¸ªå†…ç½‘ä¸»æœºçš„é…ç½®é™¤äº† remote_port ä¸ä¸€æ ·ä¹‹å¤–ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯åœ¨å†…ç½‘æœºå™¨2ä¸Šè¿è¡Œ frpc åï¼Œå…¬ç½‘æœåŠ¡å™¨çš„ nohup.out ä¸­ä¼šè®°å½•ä¸€ä¸‹çš„é”™è¯¯ï¼š [W] [control.go:332] [280d36891a6ae0c7] new proxy [ssh] error: proxy name [ssh] is already in use1åæ¥å‘ç°ï¼Œfrp ä¸­æ˜¯é€šè¿‡ [ssh] è¿™ä¸ªåå­—æ¥åŒºåˆ†ä¸åŒå®¢æˆ·ç«¯çš„ï¼Œæ‰€ä»¥ä¸åŒçš„å®¢æˆ·ç«¯è¦é…ç½®æˆä¸åŒçš„åå­—ã€‚ æ­£ç¡®çš„å¤šå®¢æˆ·ç«¯é…ç½®å†…ç½‘æœºå™¨1å’Œå†…ç½‘æœºå™¨2çš„é…ç½®åº”è¯¥åŒºåˆ†å¦‚ä¸‹ï¼š 12345678910111213å†…ç½‘æœºå™¨1ï¼š[ssh] &lt;==ä¸åŒç‚¹type = tcp local_ip = 127.0.0.1local_port = 22remote_port = 6000 &lt;==ä¸åŒç‚¹å†…ç½‘æœºå™¨2ï¼š[ssh1] &lt;==ä¸åŒç‚¹type = tcp local_ip = 127.0.0.1local_port = 22remote_port = 6001 &lt;==ä¸åŒç‚¹ åœ¨ä¸¤ä¸ªå†…ç½‘æœºå™¨ä¸Šåˆ†åˆ«è¿è¡Œ frpc å®¢æˆ·ç«¯ç¨‹åºåï¼Œä¸€èˆ¬å°±å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹æ³• ssh ç™»å½•ï¼š 123456å†…ç½‘æœºå™¨1ï¼šssh -p 6000 user_name1@server_addrå†…ç½‘æœºå™¨2ï¼šssh -p 6001 user_name2@server_addr ä¿æŠ¤è¾£ä¸ªfrp1.ä½¿ç”¨nohupå¯åŠ¨è¿™æ˜¯frpsçš„åå°å¯åŠ¨ï¼ˆè·¯å¾„å†™ä½ æœåŠ¡å™¨ä¸Šçš„ç»å¯¹è·¯å¾„ï¼‰ï¼Œå¦‚æœè¦æŸ¥çœ‹æ—¥å¿—çš„è¯ï¼Œå°±ç›´æ¥ä½¿ç”¨cat nohup.outï¼Œå°±å¯ä»¥æŸ¥çœ‹äº†ã€‚ nohup /path/to/your/fprs -c-c /path/to/your/frps.ini è¿™æ˜¯frpcçš„åå°å¯åŠ¨ nohup /path/to/your/fprc -c-c /path/to/your/frpc.ini 2.ä½¿ç”¨systemctlæ¥æ§åˆ¶å¯åŠ¨1vim /lib/systemd/system/frps.service å†™å…¥ï¼š 123456789101112[Unit]Description=fraps serviceAfter=network.target syslog.targetWants=network.target[Service]Type=simple#å¯åŠ¨æœåŠ¡çš„å‘½ä»¤ï¼ˆæ­¤å¤„å†™ä½ çš„frpsçš„å®é™…å®‰è£…ç›®å½•ï¼‰ExecStart=/your/path/frps -c /your/path/frps.ini[Install]WantedBy=multi-user.target å¯åŠ¨frpsï¼šsystemctl start frps è®¾ç½®å¼€æœºè‡ªå¯ï¼šsystemctl enable frps å¦‚æœè¦é‡å¯åº”ç”¨ï¼Œå¯ä»¥è¿™æ ·ï¼Œsudo systemctl restart frps å¦‚æœè¦åœæ­¢åº”ç”¨ï¼Œå¯ä»¥è¾“å…¥ï¼Œsudo systemctl stop frps å¦‚æœè¦æŸ¥çœ‹åº”ç”¨çš„æ—¥å¿—ï¼Œå¯ä»¥è¾“å…¥ï¼Œsudo systemctl status frps 3.ä½¿ç”¨supervisoræ¥æ§åˆ¶è¿™ä¸ªè²Œä¼¼åªåœ¨ubuntuä¸Šå¥½ä½¿ï¼ŒCentOSä¸Šä½¿ç”¨é¡»è°¨æ… sudo apt install supervisor åˆ›å»º supervisor frps é…ç½®æ–‡ä»¶,åœ¨ /etc/supervisor/conf.d åˆ›å»º frp.conf 123program:frp]command = /your/path/frps -c /your/path/frps.iniautostart = true 1234# é‡å¯supervisorsudo systemctl restart supervisor# æŸ¥çœ‹supervisorè¿è¡ŒçŠ¶æ€sudo supervisorctl status å®¢æˆ·ç«¯ä¹Ÿæ˜¯ä¸€æ ·ã€‚","link":"/2019/08/03/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"},{"title":"[NOTE] åŒºå—é“¾æ¼«è°ˆ","text":"è°ˆåˆ°åŒºå—é“¾æŠ€æœ¯ï¼Œæœ‰ä¸ªç»•ä¸è¿‡çš„ä¸œè¥¿ï¼Œé‚£å°±æ˜¯æ¯”ç‰¹å¸ã€‚æ¯”ç‰¹å¸è¢«ç§°ä¸ºâ€œåˆ†å¸ƒå¼çš„è´¦å•â€ï¼Œè¿™æ˜¯åŒºåˆ«äºé“¶è¡Œè€Œè¨€çš„ã€‚ä¼ ç»Ÿè´§å¸ä¸­æ˜¯æœ‰é“¶è¡Œè¿™ä¸ªä¸­å¿ƒå­˜åœ¨çš„ï¼Œé“¶è¡Œé€šè¿‡å°å‘é’ç¥¨ã€å¢å‡å€ºåˆ¸ã€ä¿®æ”¹å‡†å¤‡é‡‘ç­‰é‡‘èæ‰‹æ®µè°ƒæ§è´§å¸ï¼Œä½¿å…¶ç¨³å®šã€‚é“¶è¡Œä½œä¸ºä¸€ä¸ªå—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ï¼Œä¿æœ‰äº¤æ˜“åŒæ–¹çš„äº¤æ˜“ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å…¶è´¦æœ¬ã€‚ è€Œä¸­æœ¬èªæå‡ºæ¯”ç‰¹å¸ç™½çš®ä¹¦çš„æå‡ºæ˜¯æœ‰ä¸€ä¸ªèƒŒæ™¯çš„ï¼Œé‚£å°±æ˜¯08å¹´çš„é‡‘èå±æœºï¼Œé‡‘èå±æœºåæ¥è¢«è®¤ä¸ºæ˜¯é“¶è¡Œã€è¯„çº§æœºæ„å¯¹ä¿¡ç”¨çš„æ»¥ç”¨å¯¼è‡´çš„ã€‚è¿™ä¹Ÿå¼•å‘äº†äººä»¬çš„æ‹…å¿§ï¼šå½“æœ‰ä¸€å¤©ï¼Œé“¶è¡Œå˜å¾—â€œä¸é è°±â€çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰‹ä¸Šçš„è´§å¸è¿˜èƒ½é è°±å—ï¼Ÿ æ¯”ç‰¹å¸çš„åŸç†ä¸Šè¿°ç»†èŠ‚å¯èƒ½ä¸æ˜¯æ¯”ç‰¹å¸è¯ç”Ÿçš„ç›´æ¥åŸå› ï¼Œä½†å®ƒä¸€å®šæ˜¯åŸå› ä¹‹ä¸€ã€‚ ç™½çš®ä¹¦ä»ä¸€å¼€å§‹å°±ç»™äº†æ¯”ç‰¹å¸ä¸€ä¸ªå®šä¹‰â€A Peer-to-Peer Electronic Cash Systemâ€ï¼Œå› æ­¤æ¯”ç‰¹å¸çš„è®¾è®¡ä¸­ï¼Œæ˜¯ä¸å­˜åœ¨â€œä¸­å¿ƒâ€è¿™ä¸ªæ¦‚å¿µçš„ï¼Œæˆ‘ä»¬ä¸”å…ˆä¸å¤ªå…¶å®ç°çš„å…·ä½“åŸç†ï¼Œå…ˆè§£å†³ä¸‹é¢çš„ä¸¤ä¸ªé—®é¢˜ï¼š æ²¡æœ‰â€œä¸­å¿ƒâ€ï¼Œé‚£ä¹ˆè´¦æœ¬ç”±è°æ¥è®°å‘¢ï¼Ÿâ€”â€”å¯ä»¥æ˜¯æ¯ä¸ªäºº è´¦æœ¬ä¿å­˜åœ¨å“ªå‘¢ï¼Ÿâ€”â€”æ¯ä¸ªäººéƒ½ä¼šä¿å­˜ä¸€ä¸ªè´¦æœ¬çš„å‰¯æœ¬ï¼Œå³åŒºå—é“¾ 1.è´¦æœ¬çš„è®°å½•åœ¨ç™½çš®ä¹¦ä¸­ï¼Œæ‰€æœ‰çš„äº¤æ˜“ä¿¡æ¯éƒ½æ˜¯ä¿å­˜åœ¨åŒºå—é“¾ä¸Šçš„ï¼Œå½“æœ‰æ–°çš„äº¤æ˜“ä¿¡æ¯éœ€è¦è®°å½•æ—¶ï¼Œä¾¿ä¼šå°†æ‰€æœ‰æ–°äº§ç”Ÿçš„äº¤æ˜“ä¿¡æ¯è®°å½•åˆ°ä¸€ä¸ªæ–°çš„å—ä¸Šï¼Œå°†è¿™ä¸ªå—æ¥åˆ°é“¾çš„åç«¯ã€‚ è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¾—æ˜ç¡®ä¸€ç‚¹ï¼Œbitcoinä¸­æ˜¯ä¸å­˜åœ¨ä½™é¢è¿™ä¸ªæ¦‚å¿µçš„ï¼Œè¦æ˜¯æœ‰å¤©æˆ‘æƒ³æ•°æ•°æˆ‘æœ‰å¤šå°‘é’±ï¼Œé‚£çœŸå¾—å¥½å¥½æ•°æ•°äº†â€”â€”ä»é“¾å¤´å¼€å§‹ï¼ŒæŸ¥çœ‹æ‰€æœ‰è‡ªå·±çš„æ”¶å…¥å’Œæ”¯å‡ºï¼Œæœ€åå¾—åˆ°çš„ç»“æœï¼Œå°±æ˜¯è‡ªå·±çš„â€œä½™é¢â€ã€‚è¿™ä¹ˆä¸€è¯´æ¥ï¼Œä¿å­˜ä¸€ä»½è´¦æœ¬ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„äº†ï¼ˆå…·ä½“åŸå› åé¢ä¼šè¯´æ˜ï¼‰ã€‚ è¿™ä¸¤ä¸ªé—®é¢˜æ˜¯è§£å†³äº†ï¼Œä½†åŒæ—¶å¼•æ¥äº†æ›´å¤šçš„é—®é¢˜ã€‚ 2.ä¸ºä»€ä¹ˆè¦è®°è´¦ï¼Ÿå¯¹äººæ¥è¯´ï¼Œè®°è´¦ä¸æ˜¯ä¸€ä»¶è½»æ¾çš„æ´»ï¼Œè€Œå¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œè®°è´¦æ˜¯è¦æ¶ˆè€—å®ƒçš„ç®—åŠ›ã€ç”µåŠ›çš„ï¼Œé‚£ä¹ˆå‡è‹¥ä½ æ˜¯ä¸ªæ¯”ç‰¹å¸çš„ç”¨æˆ·ï¼Œä½ ä¸ºä»€ä¹ˆè¦è´¹å¿ƒåŠ›ç»™åˆ«äººçš„äº¤æ˜“â€œè®°è´¦â€å‘¢ï¼Ÿ å› ä¸ºæœ‰å¥–åŠ±ï¼ å¥–åŠ±åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šäº¤æ˜“é¢ä¸€å®šæ¯”ä¾‹çš„æ‰‹ç»­è´¹ï¼›æ‰“åŒ…å¥–åŠ±ã€‚ æ‰‹ç»­è´¹ï¼šâ€œæ—¢ç„¶éƒ½æ˜¯é©å‘½æ€§çš„è´§å¸äº†ï¼Œæ€ä¹ˆè¿˜æ”¶æ‰‹ç»­è´¹ï¼Ÿâ€â€”â€”æ‰‹ç»­è´¹è¿œä½äºé“¶è¡Œ æ‰“åŒ…å¥–åŠ±ï¼š æ‰“åŒ…æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”äº¤æ˜“ä¿¡æ¯ä¼šä»¥å¹¿æ’­çš„å½¢å¼å‘å‡ºï¼Œå¯¹äºä¸€ä¸ªç”¨æˆ·(è®¡ç®—æœº)æ¥è¯´ï¼Œå®ƒä¼šå°è¯•å°†å®ƒæ‰€æ”¶åˆ°çš„äº¤æ˜“ä¿¡æ¯éƒ½æ•´åˆåˆ°ä¸€èµ·ï¼Œå¹¶å°è¯•â€œæ‰“åŒ…â€ï¼Œæ¥åˆ°é“¾çš„æœ«ç«¯ã€‚ å¥–åŠ±é‡‘é¢ï¼šç™½çš®ä¹¦ä¸­çº¦å®šï¼Œ10åˆ†é’Ÿæ‰“åŒ…ä¸€æ¬¡ï¼Œæ¯ä¸ªæ‰“åŒ…è€…å¥–åŠ±50BTCï¼Œæ¯å››å¹´å¥–åŠ±å‡åŠï¼ˆè¿™æ˜¯ä¸ºäº†çº¦æŸæœ€åçš„BTCçš„æ€»æ•°æ¥è¿‘ä¸€ä¸ªå®šå€¼ï¼š210,000,000ï¼‰ é—®é¢˜åˆæ¥äº†ï¼Œæ‰“åŒ…æœ‰å¥–åŠ±ï¼Œé‚£å²‚ä¸æ˜¯â€œäººäººå–Šæ‰“â€ï¼Ÿ 3.æ‰“åŒ…çš„çº¦æŸâ€”â€”å·¥ä½œé‡è¯æ˜(Proof of Work, PoW)æ˜¾ç„¶ï¼ŒåŒ…æ˜¯åªèƒ½ä¸€ä¸ªäººæ‰“çš„ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åŒºå—é“¾æ­£å¸¸è¿è¡Œä¸‹å»ã€‚å› æ­¤æ‰€æœ‰åˆ†å¸ƒå¼èŠ‚ç‚¹éƒ½éœ€è¦è¾¾æˆä¸€ä¸ªå…±è¯†ï¼Œå³å½“ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°äº†å…¶ä»–èŠ‚ç‚¹æ‰“åŒ…å®Œæˆçš„ä¿¡æ¯çš„æ—¶å€™ï¼Œè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šæ”¾å¼ƒå½“å‰çš„æ‰“åŒ…æ“ä½œï¼Œè½¬è€Œå»æ‰“ä¸‹ä¸€ä¸ªåŒ…ã€‚ ä½†è¿™æ ·ä¾ç„¶å¾ˆéš¾é¿å…è¿™æ ·ä¸€ç§æƒ…å†µï¼šå¤šä¸ªèŠ‚ç‚¹â€åŒæ—¶â€œæ‰“å¥½äº†åŒ…ï¼ˆæ­¤å¤„åŒæ—¶ä¸ä¸€å®šæ˜¯åŒä¸€æ—¶åˆ»ï¼Œç”±äºç½‘ç»œå»¶è¿Ÿçš„åŸå› ï¼Œå¾ˆå¯èƒ½ä¸€ä¸ªèŠ‚ç‚¹å®Œæˆæ‰“åŒ…æ“ä½œåï¼Œæ‰æ”¶åˆ°å…¶ä»–èŠ‚ç‚¹æ—©å·²å®Œæˆæ‰“åŒ…çš„ä¿¡æ¯ï¼‰ã€‚ ä¸ºäº†å°½é‡é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œä¸­æœ¬èªçš„åšæ³•æ˜¯å°†æ‰“åŒ…è¿™ä¸ªè¿‡ç¨‹æ‹‰é•¿ï¼Œè¿™æ ·åšç¡®å®èƒ½æœ‰æ•ˆçš„é™ä½é‡å¤æ‰“åŒ…çš„ç°è±¡ï¼Œå…·ä½“åšæ³•æ˜¯ï¼š æˆ‘ä»¬å°†ï¼š1.è®°å½•å‰å—ä¿¡æ¯çš„â€œå¤´éƒ¨â€ï¼›2.è®°å½•äº¤æ˜“ä¿¡æ¯çš„â€œè´¦å•â€ï¼›3.æ—¶é—´æˆ³ï¼›4.ä¸€ä¸²éšæœºæ•° ç»„åˆæˆä¸€ä¸ªå—ï¼Œå¯¹è¿™ä¸ªå—è¿›è¡Œä¸¤æ¬¡SHA256çš„å“ˆå¸Œè¿ç®—ï¼Œæœ€ç»ˆçš„åˆ°ä¸€ä¸ª256ä½çš„hashå€¼ã€‚ æŒ‰ç…§çº¦å®šï¼Œå¦‚æœè¿™ä¸ª256ä½çš„hashå€¼çš„å‰nä½ä¸º0ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šè®¤å¯è¿™ä¸ªå—å¯ä»¥æ¥åœ¨é“¾ä¸Šï¼Œå³å…·å¤‡äº†æ‰“åŒ…èµ„æ ¼ã€‚ç”±äºsha256çš„ä¸å¯é€†æ€§ï¼Œæ‰€æœ‰èŠ‚ç‚¹åªèƒ½é€šè¿‡ä¿®æ”¹éšæœºæ•°çš„å€¼ï¼Œä¸€ä¸ªä¸€ä¸ªå»å°è¯•ï¼Œçœ‹å¾—åˆ°çš„ç»“æœæ˜¯å¦èƒ½æ»¡è¶³æ¡ä»¶ï¼ˆæ ¹æ®æ—¶é—´æˆ³çš„ä¸åŒï¼Œå„èŠ‚ç‚¹å¼€å§‹è®¡ç®—çš„å€¼ä¹Ÿä¸åŒï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿè¢«ç§°ä¸ºæŒ–çŸ¿ã€‚ å‰é¢æˆ‘ä»¬ä¹Ÿæåˆ°ï¼Œç™½çš®ä¹¦ä¸­è®¡åˆ’æ˜¯æ¯10åˆ†é’Ÿæ‰“ä¸€ä¸ªåŒ…ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿ å¯¹äº256ä½çš„hashå€¼æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ¯ä¸€ä½ä¸Šå‡ºç°0çš„å‡ ç‡æ˜¯50%ï¼Œé‚£ä¹ˆhashå€¼çš„å‰nä½ä¸º0çš„å‡ ç‡å°±æ˜¯1/(2^n)ï¼Œå‡è®¾ç®—åŠ›æ’å®šï¼Œæ˜¾ç„¶nè¶Šå¤§ï¼Œè®¡ç®—å‡ºç¬¦åˆæ¡ä»¶çš„ç»“æœçš„æ—¶é—´å°±è¶Šé•¿ã€‚é‚£ä¹ˆå›åˆ°ç°å®æƒ…å†µï¼Œå‚ä¸BTCè¿ç®—çš„ç®—åŠ›ä¸€ç›´åœ¨å¢é•¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¢åŠ nçš„å¤§å°ï¼Œä½¿æ¯ä¸ªåŒ…çš„äº§å‡ºæ—¶é—´åœ¨æ¦‚ç‡ä¸Šæ’å®šäº10åˆ†é’Ÿã€‚ å¦‚æœä½ è¿˜æ²¡æœ‰å……åˆ†ç†è§£çš„è¯ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åšé“è®¡ç®—é¢˜ï¼š 123å‡è®¾ä¸€å…±æœ‰2wå°çŸ¿æœºå‚ä¸è¿ç®—ï¼Œæ¯å°çŸ¿æœºçš„ç®—åŠ›ä¸º14Tbpsï¼Œæ­¤æ—¶è¦æ§åˆ¶ä¸º10åˆ†é’Ÿæ‰“åŒ…ä¸€æ¬¡ï¼Œéœ€è¦å°†nè®¾ç½®ä¸ºå¤šå°‘ï¼Ÿ20000*14*10^12*600=1.68e20 çº¦ä¸º 2^67 å°½ç®¡æœ‰PoWç®—æ³•çš„ä¿éšœï¼Œä½†ä»ç„¶ä¸èƒ½æ’é™¤åŒæ—¶æ‰“åŒ…çš„æƒ…å†µçš„å‘ç”Ÿã€‚åŒæ—¶æ‰“åŒ…çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¼šåˆ†åˆ«å‘å‘¨å›´çš„èŠ‚ç‚¹åˆ†å‘è‡ªå·±çš„é‚£ä¸ªåŒ…ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå®è§‚ä¸Šå°±ä¼šå‘ç”ŸåŒºå—é“¾é“¾è·¯åˆ†å‰çš„æƒ…å†µï¼Œé¢å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿè¯·ç»§ç»­çœ‹ä¸‹æ–‡ã€‚ ##åŒºå—é“¾ä¸­çš„å®‰å…¨æœºåˆ¶ åœ¨BTCä¸­ï¼Œä¸ç®¡æ˜¯å°†äº¤æ˜“ä¿¡æ¯å¹¿æ’­ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œè¿˜æ˜¯å°†æ‰“åŒ…çš„å—åˆ†å‘ï¼Œéƒ½éœ€è¦å¤„ç†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•é˜²ä¼ªï¼Ÿæ€æ ·ç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„è¿‡ç¨‹ä¸­æ²¡æœ‰æ”¶åˆ°ç¯¡æ”¹ï¼Ÿ è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ï¼šç”µå­ç­¾å 1.ç”µå­ç­¾åè®¡ç®—æœºç½‘ç»œä¸­ç”µå­ç­¾åçš„åº”ç”¨èŒƒå›´ååˆ†å¹¿æ³›ï¼Œç›¸ä¿¡ä½ å¯¹ç”µå­ç­¾åå·²ç»æœ‰äº†ä¸€å®šçš„è®¤çŸ¥äº†ï¼Œæ‰€ä»¥å…ˆç•¥è¿‡ã€‚ 2.æº¯æºå‰æ–‡å·²ç»æåˆ°ï¼Œç”¨æˆ·æ‹¥æœ‰æ¯”ç‰¹å¸çš„æ•°é‡ä¸æ˜¯æŒ‰ç…§ä½™é¢æ¥è®¡ç®—ï¼Œæ‰€ä»¥å½“è¦éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰èƒ½åŠ›æ”¯ä»˜å¯¹åº”é‡‘é¢çš„æ¯”ç‰¹å¸æ—¶ï¼Œå…¶ä»–ç”¨æˆ·å°±éœ€è¦â€œæŸ¥è´¦â€ï¼ŒåŒ…æ‹¬ï¼šæ‰“åŒ…æ”¶ç›Šã€äº¤æ˜“æ”¯å‡ºã€äº¤æ˜“æ”¶å…¥ã€‚ä¸€æ—¦å‘ç°è¯¥ç”¨æˆ·å¹¶ä¸å…·å¤‡æ”¯ä»˜èƒ½åŠ›æ—¶ï¼Œè¿™ä¸ªäº¤æ˜“ä¿¡æ¯å°±ä¼šè¢«é©³å›ï¼Œä¸ä¼šè¢«åˆ†å¸ƒå¼ä¸­çš„èŠ‚ç‚¹æ‰€æ‰¿è®¤ã€‚ 3.åŒé‡æ”¯ä»˜é—®é¢˜åœ¨æº¯æºé—®é¢˜ä¸­æˆ‘ä»¬æåˆ°ï¼ŒèŠ‚ç‚¹æ¥æ”¶äº¤æ˜“ä¿¡æ¯çš„æ—¶å€™å¹¶ä¸æ˜¯æ— è„‘æ¥å—çš„ï¼Œå®ƒä¼šæ ¡éªŒäº¤æ˜“æ˜¯å¦åˆæ³•ã€‚ é‚£ä¹ˆè€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼ŒAåªå‰©ä¸‹5 BTCï¼Œæ­¤æ—¶å®ƒåŒæ—¶å‘Bå’ŒCè½¬å¸5 BTCï¼Œç”±äºBå’ŒCåˆ†åˆ«åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œå®ƒä»¬å¯¹äº¤æ˜“çš„æ ¡éªŒéƒ½æ˜¯é€šè¿‡çš„ï¼Œè¿™å°±æ˜¯åŒé‡æ”¯ä»˜é—®é¢˜ã€‚ æ­¤æ—¶ï¼ŒBå’ŒCå¤„ä¼šå­˜åœ¨ä¸€ä¸ªç«äº‰ï¼Œç”±äºäº¤æ˜“ä¿¡æ¯ä¼šè¢«åˆ†åˆ«å¹¿æ’­åˆ°Bå’ŒCå‘¨è¾¹çš„èŠ‚ç‚¹ï¼Œæ­¤æ—¶é‚£è¾¹çš„èŠ‚ç‚¹å…ˆå®Œæˆæ‰“åŒ…çš„è®¡ç®—ï¼Œé‚£ä¹ˆè¯¥å¤„å¯¹åº”çš„äº¤æ˜“æ‰å®Œæˆï¼Œå¦å¤–ä¸€ä¸ªå°šæœªå®Œæˆçš„äº¤æ˜“å°†ä¼šè¢«åºŸå¼ƒã€‚ 4.æœ€é•¿é“¾åŸåˆ™ç»§ç»­åŒé‡æ”¯ä»˜ä¸­çš„é—®é¢˜ï¼Œè‹¥æ˜¯Bå’ŒCä¸¤å¤„çš„èŠ‚ç‚¹åŒæ—¶å®Œæˆæ‰“åŒ…æ“ä½œå‘¢ï¼Ÿ æ­¤æ—¶ï¼Œä¸¤è¾¹ä¸åŒç‰ˆæœ¬çš„åŒºå—é“¾ç‰ˆæœ¬åˆ†åˆ«å‘å…¨ç½‘æ‰©æ•£ï¼Œæ­¤æ—¶ä»å®è§‚ä¸Šæ¥çœ‹ï¼ŒåŒºå—é“¾å°±å‘ç”Ÿäº†åˆ†æ”¯çš„ç°è±¡ï¼Œæ­¤æ—¶å‚ä¸è¿ç®—çš„èŠ‚ç‚¹ä»¬ä¼šåˆ†ä¸ºä¸‰æ´¾ï¼Œä¸€æ´¾æˆ‘ä»¬ç§°ä¸ºAåˆ†æ”¯ï¼Œå¦ä¸€æ´¾æˆ‘ä»¬ç§°ä¸ºCåˆ†æ”¯ï¼Œé‚£è¿˜å‰©ä¸€æ´¾å‘¢ï¼Ÿå®ƒä»¬è¿˜æ²¡æ¥å¾—åŠæ¥å—Aæˆ–Cçš„åˆ†æ”¯ã€‚ é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ç§å†²çªå‘¢ï¼ŸèŠ‚ç‚¹ä»¬æ­¤æ—¶ä¼šåˆ†åˆ«åœ¨Bå’ŒCä¸­ç»§ç»­æ‰“åŒ…ï¼Œä¼˜å…ˆæ‰“å‡ºä¸‹ä¸€ä¸ªåŒ…çš„åˆ†æ”¯åŒæ ·ä¹Ÿä¼šå°†å®ƒä»¬çš„é“¾å¹¿æ’­å‡ºå»ï¼Œå½“æŸä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°çš„é“¾ä¸å®ƒè‡ªå·±çš„é“¾å¤„äºä¸¤ä¸ªä¸åŒåˆ†æ”¯çš„æ—¶å€™ï¼Œå®ƒä¼šé€‰æ‹©ä¿¡ä»»æ›´é•¿çš„é‚£æ¡é“¾ï¼Œå¹¶å°†ç»§ç»­åœ¨æ›´é•¿çš„é‚£æ¡é“¾ä¸Šè¿ç®—ä¸‹å»ï¼Œè€Œè¿™å°±æ˜¯æ‰€è°“çš„æœ€é•¿é“¾åŸåˆ™ã€‚ ä¸ºä»€ä¹ˆèŠ‚ç‚¹ä»¬ä¼šé€‰æ‹©æ›´é•¿çš„é‚£æ¡é“¾å‘¢ï¼Ÿ ç»“åˆä¹‹å‰åŒé‡æ”¯ä»˜çš„é—®é¢˜ï¼Œä¸€æ—¦ä¸€æ¡æ”¯é“¾è¢«åºŸå¼ƒï¼Œé‚£ä¹ˆè¿™æ¡æ”¯é“¾ä¸Šæ‰€æœ‰çš„æ‰“åŒ…æ”¶ç›Šä¹Ÿå°†è¢«åºŸå¼ƒã€‚èŠ‚ç‚¹ä»¬è‡ªç„¶ä¸ä¼šæ„¿æ„åšæ— ç”¨åŠŸï¼Œæ‰€ä»¥åœ¨è®¡ç®—ä¸‹ä¸€ä¸ªå—çš„æ—¶å€™ï¼Œå®ƒä»¬ä¼šé€‰æ‹©æ›´é•¿çš„é‚£æ¡é“¾ï¼Œæ¥åœ¨åé¢è¿›è¡Œè®¡ç®—ã€‚ 5.é˜²ç¯¡æ”¹å…ˆç»™ç»“è®ºï¼Œæ¯”ç‰¹å¸é˜²ç¯¡æ”¹çš„æœºåˆ¶å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯åŸºäºPoWç®—æ³•çš„ç®—åŠ›çº¦æŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æŸä¸€æ–¹æƒ³è¦æ¶æ„ç¯¡æ”¹åŒºå—é“¾ä¹‹ä¸­çš„äº¤æ˜“ä¿¡æ¯çš„æ—¶å€™ï¼Œä»–éœ€è¦æ‹¥æœ‰è¶…è¿‡å…¨ç½‘50%çš„ç®—åŠ›ã€‚50%ä»ä½•è€Œæ¥å‘¢ï¼Ÿè®¸å¤šæ–‡ç« å¯¹è¿™ä¸ªåœ°æ–¹éƒ½è¯­ç„‰ä¸è¯¦ï¼Œå…¶å®è¿™ä¸ªä¾ç„¶æ˜¯åŸºäºæœ€é•¿é“¾åŸåˆ™çš„ã€‚ å‡å¦‚ç”¨æˆ·Aæƒ³è¦ç¯¡æ”¹æŸä¸ªå—ä¹‹åçš„å†…å®¹ï¼Œä»–éœ€è¦åšçš„äº‹æƒ…ï¼Œæ˜¯åœ¨è¯¥é“¾ä¹‹ååˆ›å»ºå‡ºä¸€æ¡é“¾ï¼Œå¹¶ä½¿è¿™æ¡é“¾çš„é•¿åº¦æœ€ç»ˆè¶…è¿‡â€œä¸»é“¾â€ï¼Œæˆä¸ºæ–°çš„ä¸»é“¾ã€‚ è¿™æ ·ï¼Œå…¶ä»–ç”¨æˆ·ä¹Ÿå°†è®¤å¯è¿™æ¡â€œä¼ªé€ çš„é“¾è·¯â€ï¼Œå¹¶åœ¨å…¶åè¿›è¡Œè¿ç®—ã€‚ ä½†æ¯”ç‰¹å¸ç¤¾åŒºåˆ°ç›®å‰å¹¶æ²¡æœ‰å®é™…å‘ç”Ÿè¿‡51%æ”»å‡»çš„äº‹ä»¶ï¼Œä¸€æ˜¯ç”±äºå…¶ç”¨æˆ·æ•°é‡åºå¤§ï¼Œç®—åŠ›è§„æ¨¡å·¨å¤§å¯¼è‡´çš„ï¼›äºŒæ˜¯ç”±äºåœ¨æœ‰ç»å¯¹ç®—åŠ›ä¼˜åŠ¿çš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸»é“¾åé¢è¿›è¡Œæ‰“åŒ…ä¼šæ˜¯ä¸€ä¸ªæ›´æœ‰ä»·å€¼çš„è¡Œä¸ºã€‚ å…±è¯†å±‚ç®—æ³•æ”¹è¿›åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç³»ç»Ÿä¸­ï¼Œæœ€ä¸ºå…³é”®æ ¸å¿ƒçš„é—®é¢˜æ˜¯åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¯šç„¶PoWç®—æ³•çš„ç¡®åœ¨ä¸€ä¸ªå¼ºåˆ†å¸ƒå¼çš„ç³»ç»Ÿ(æˆ‘è‡ªå·±çš„ç§°è°“never mind)ä¸­ä¸ºåŒæ­¥æ•°æ®æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ³•ï¼Œä½†æ˜¯å®ƒå¸¦æ¥çš„æ¶ˆè€—æ˜¯åœ¨å¤ªé«˜äº†ã€‚ ä¸€ç›´åˆ°2019å¹´çš„7æœˆä»½ï¼Œå‚ä¸æ¯”ç‰¹å¸è¿ç®—çš„æ€»ç®—åŠ›å·²ç»è¾¾åˆ°äº†10^20bpsçš„æ•°é‡çº§äº†ï¼Œè¿™èƒŒåæ‰€ä»£è¡¨çš„è´¢åŠ›ã€ç‰©åŠ›çš„æ¶ˆè€—éå¸¸ææ€–ã€‚ 1.æ¶ˆè€—æ”¹è¿›ï¼šPoS(Proof of Stake)PoSç®—æ³•ä¸­æå‡ºäº†Stakeè¿™æ ·ä¸€ä¸ªæ¦‚å¿µç”¨æ¥å–ä»£ç®—åŠ›(Work)ï¼ŒStakeå¯ä»¥æ˜¯æŒå¸çš„æ•°é‡ã€æŒå¸çš„ä»·å€¼ç”šè‡³æ˜¯æŒå¸çš„æ—¶é—´ã€‚æ‰€æŒæœ‰çš„èµ„äº§å°†ä½œä¸ºä¿è¯é‡‘å‚ä¸æ‰“åŒ…çš„ç«äº‰ï¼Œè¿™ä¸ªæœ‰ç‚¹åƒè‚¡ä»½åˆ¶çš„å…¬å¸ï¼Œæ‰€æŒæœ‰çš„è‚¡ä»½è¶Šå¤šï¼Œåˆ†çº¢è¶Šå¤šã€‚ å¯¹äºäº§ç”Ÿæ¶æ„è¡Œä¸ºçš„ç”¨æˆ·ï¼Œä»–çš„ä¿è¯é‡‘å°†è¢«æ²¡æ”¶ã€‚ PoSç®—æ³•ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†PoWç®—æ³•ä¸­æ¶ˆè€—è¿‡å¤§çš„é—®é¢˜ï¼Œä½†PoSç®—æ³•åŒæ ·ä¹Ÿå­˜åœ¨ç€è‡ªå·±çš„ç¼ºé™·ï¼š æ— æƒç›Šé—®é¢˜ï¼šè¢«åºŸå¼ƒåˆ†æ”¯çš„å¥–åŠ±ä¾ç„¶ä¼šè¢«è®¤å¯ è¢«åŠ¨ä¸­å¿ƒåŒ–ï¼šæŒ‰ä¿è¯é‡‘åˆ†çº¢ï¼Œå¯Œè€…è¶Šå¯Œ æ—©æœŸå±é™©ï¼šæ—©æœŸå¸å€¼ä½ï¼Œåªéœ€è¦ä»˜å‡ºå¯æ¥å—çš„ä»£ä»·å°±èƒ½è¶…è¿‡51%çš„å¸å€¼ 2.æ€§èƒ½æ”¹è¿›ï¼šæ›´é«˜æ•ˆçš„æ‹“æ‰‘ç»“æ„ç”±äºåŒºå—é“¾å•é“¾çš„é™åˆ¶ï¼Œå¯¼è‡´æ‰“åŒ…æ“ä½œåªèƒ½ä¸²è¡Œåœ°å¤„ç†ï¼Œè¿™æ ·æ•ˆç‡è¿‡ä½ï¼Œä¸”ä¼šå¸¦æ¥æ€§èƒ½æµªè´¹ï¼ˆæ‰“åŒ…å¤±è´¥è€…çš„è¿ç®—å°†è¢«æµªè´¹ï¼‰ï¼Œ Parallel execution of blockchain transactions ä¸­æå‡ºäº†ä¸€ç§æ›´é«˜æ•ˆçš„DAGç»“æ„ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå…³äºå…±è¯†å±‚ç®—æ³•ä¹Ÿæœ‰å¾ˆå¤šçš„ç›¸å…³ç ”ç©¶ï¼Œå¦‚å§”æ‰˜è‚¡æƒè¯æ˜(Delegated Proof of Stake, DPoS)ï¼Œæ´»è·ƒåº¦è¯æ˜(Proof of Activity, PoA)ï¼Œæ¶ˆè€—è¯æ˜(Proof of Burn, PoB)ç­‰ã€‚ å—ç©ºé—´ä¸è¶³é—®é¢˜æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼ŒåŒºå—é“¾çš„å¤§å°éƒ½æ˜¯é™åˆ¶ä¸º1Mçš„ã€‚å…¶å®æœ€æ—©ä¸­æœ¬èªåˆ›å»ºæ¯”ç‰¹å¸æ—¶ï¼Œæ˜¯æ²¡æœ‰åŒºå—å¤§å°é™åˆ¶çš„ï¼Œä½†ç”±äºä¸€ä¸ªæ•°æ®ç»“æ„çš„é™åˆ¶ï¼ŒåŒºå—æœ€å¤§èƒ½è¾¾åˆ°33Mï¼Œè€Œä¸æ˜¯ç°åœ¨çš„1Mã€‚ä½†æœ€æ—©çš„æ—¶å€™æ¯”ç‰¹å¸å¾ˆä¾¿å®œï¼Œåªè¦èŠ±å¾ˆå°‘çš„é’±ï¼Œæ¯”å¦‚å‡ ç¾å…ƒï¼Œå°±å¯ä»¥å‘å‡ºéå¸¸å¤šçš„åƒåœ¾äº¤æ˜“ï¼Œæ¶æ„åœ°æŠŠåŒºå—æ•°æ®æ’‘å¤§ï¼Œæ’‘æ»¡ä½ çš„ç¡¬ç›˜ã€‚æ‰€ä»¥ä¸­æœ¬èªåŠ äº†ä¸€ä¸ª1MåŒºå—é™åˆ¶ï¼Œä¸­æœ¬èªåŠ çš„è¿™ä¸ªé™åˆ¶æ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ç»™å‡ºäº†æœªæ¥æ‰©å®¹çš„å®‰æ’ã€‚ é¢„æœŸè®¾è®¡çš„æ›´å¤§çš„åŒºå—é™åˆ¶å¯ä»¥åˆ†é˜¶æ®µæ‰§è¡Œï¼š å½“ åŒºå—é«˜åº¦(blocknumber) &gt; 115000 æ—¶ åŒºå—ä¸Šé™(maxblocksize)=æ›´å¤§çš„é™åˆ¶ éšç€ç”¨æˆ·æ•°é‡çš„å¢å¤šï¼Œäº¤æ˜“é¢‘æ¬¡çš„å¢é•¿ï¼Œåœ¨2017å¹´ï¼ŒåŒºå—çš„å¤§å°å·²ç»ä¸èƒ½æ»¡è¶³éœ€æ±‚äº†ï¼Œä½†æ­¤æ—¶åŒºå—é“¾çš„æ‰©å®¹å´æ²¡æœ‰ä¸­æœ¬èªçš„è®¡åˆ’èµ°ä¸‹å»ï¼Œè¿™å…¶ä¸­æ›²æŠ˜ä¹Ÿå¾ˆæœ‰æ„æ€ã€‚ æœ€æ—©çš„æ¯”ç‰¹å¸æ˜¯ç”±ä¸­æœ¬èªå¼€å‘çš„ï¼Œä¸­æœ¬èªéšé€€åï¼Œæ¯”ç‰¹å¸çš„å¼€å‘ç»´æŠ¤ä»»åŠ¡ç”±ä¸­æœ¬èªä¼ ç»™äº†åŠ æ–‡ï¼ˆGavinï¼‰ï¼ŒåŠ æ–‡ï¼ˆGavinï¼‰è§‰å¾—è‡ªå·±ç‹¬è£ä¸å¥½ï¼ŒåˆæŠŠä»£ç æƒé™åˆ†æƒç»™äº†å…¶å®ƒ4åå¼€å‘ï¼Œåæ¥åˆæœ‰å…¶å®ƒå¼€å‘åŠ å…¥ï¼Œå‘å±•æˆç°åœ¨çš„Coreå¼€å‘å›¢é˜Ÿã€‚ ä½†åæ¥ï¼ŒCoreå¼€å‘å›¢é˜Ÿå†…éƒ¨å…³äºè¦ä¸è¦æŒ‰ä¸­æœ¬èªçš„è®¡åˆ’ï¼Œç§»èµ°1Mé™åˆ¶ï¼Œäº§ç”Ÿäº†åˆ†æ­§ã€‚å¤šæ•°å¼€å‘äººå‘˜è§‰å¾—ä¸åº”è¯¥ç§»é™¤è¿™ä¸ªé™åˆ¶ï¼Œéƒ¨åˆ†è§‰å¾—åº”è¯¥ç§»é™¤è¿™ä¸ªé™åˆ¶ã€‚ çŸ›ç›¾æ¿€åŒ–çš„ç»“æœï¼Œå°±æ˜¯Gavinï¼ŒJeffç­‰æ”¯æŒç§»é™¤1Mé™åˆ¶çš„å¼€å‘äººå‘˜ï¼Œè¢«èµ¶å‡ºCoreå›¢é˜Ÿï¼Œè¢«åˆ é™¤äº†ä»£ç æƒé™ã€‚ç„¶åè¿™äº›å¼€å‘äººå‘˜ï¼ŒåŒ…æ‹¬ä¸€äº›æ–°çš„ï¼Œæ”¯æŒç§»é™¤1Mé™åˆ¶çš„å¼€å‘äººå‘˜ï¼Œå»ºç«‹äº†XTã€Classicã€BUç­‰å¼€å‘å›¢é˜Ÿã€‚ æˆ‘ä»¬è¯´çš„è¿™äº›å¼€å‘å›¢é˜Ÿçš„å…³ç³»ï¼Œå¾ˆç±»ä¼¼äºä¸€ä¸ªå›½å®¶é‡Œå¤šæ”¿å…šçš„å…³ç³»ï¼Œäº’ç›¸ç«äº‰ï¼Œå¹¶ä¸”è¯´æœç”¨æˆ·é€‰ä¸¾ä»–ä»¬ä½œä¸ºæ‰§æ”¿å…šã€‚ä¹Ÿå°±æ˜¯è¯´å°±æ¯”ç‰¹å¸çš„æ‰©å®¹ï¼Œå…¶å®å¾ˆæ—©ä¹‹å‰ï¼Œæ¯”ç‰¹å¸çš„æ ¸å¿ƒå¼€å‘å›¢é˜Ÿå°±å·²ç»åœ¨äº‰è®®äº†ï¼Œä¹Ÿç»è¿‡äº†æ¯”è¾ƒæ¿€çƒˆçš„äººäº‹æ–—äº‰ã€‚æˆ‘ä»¬ç†è§£å…¶å®è¿™äº›æ ¸å¿ƒå¼€å‘è€…ä¹Ÿæ˜¯ä¸ºäº†æ¯”ç‰¹å¸çš„å‘å±•å¥½ã€‚ åŒæ–¹çš„è§‚ç‚¹Coreï¼šä¸å¸Œæœ›ç§»é™¤1Mé™åˆ¶ è¿™æ˜¯ä¸ªç¡¬åˆ†å‰ï¼ŒCoreè®¤ä¸ºè¿™æ ·çš„ç¡¬åˆ†å‰æœ‰åˆ†è£‚æ¯”ç‰¹å¸çš„é£é™© é¦–å…ˆç§‘æ™®ä¸‹ä»€ä¹ˆæ˜¯ç¡¬åˆ†å‰å’Œè½¯åˆ†å‰ ç¡¬åˆ†å‰æ˜¯ä¸€ä¸ªå’Œè½¯åˆ†å‰ç›¸å¯¹åº”çš„æ¦‚å¿µï¼Œå½“æ¯”ç‰¹å¸ç³»ç»Ÿå‡çº§æ—¶ï¼Œå¦‚æœè¿™ä¸ªå‡çº§æ˜¯å‘å‰å…¼å®¹çš„ï¼Œç”¨æˆ·ä¸éœ€è¦å‡çº§è‡ªå·±çš„é’±åŒ…ä¹Ÿèƒ½ç»§ç»­ç”¨ä¸‹å»ï¼Œè¿™ä¸ªå‡çº§å°±å«è½¯åˆ†å‰ã€‚ å¯¹åº”çš„ï¼Œå¦‚æœç”¨æˆ·éœ€è¦å‡çº§é’±åŒ…æ‰èƒ½ç»§ç»­ç”¨ä¸‹å»ï¼Œè¿™ä¸ªå‡çº§å°±å«ç¡¬åˆ†å‰ã€‚ï¼ˆè¿™ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„å®šä¹‰ï¼Œä½†æ˜¯æ¯”è¾ƒå®¹æ˜“ç†è§£çš„å®šä¹‰ï¼‰ ç¡¬åˆ†å‰çš„é£é™©åœ¨äºï¼Œå¦‚æœæœ‰ç”¨æˆ·æ²¡å‡çº§è‡ªå·±çš„é’±åŒ…ï¼Œé‚£ä»–å°±ç•™åœ¨äº†æ—§ç‰ˆæœ¬çš„æ¯”ç‰¹å¸ä¸Šï¼Œä»–ä¼šå‘ç°è‡ªå·±çš„æ¯”ç‰¹å¸ï¼Œå’Œåˆ«äººå‡çº§äº†é’±åŒ…çš„æ¯”ç‰¹å¸ä¸ä¸€æ ·ï¼Œæ˜¯ä¸å…¼å®¹çš„ï¼Œä¸€ä¸ªæ˜¯æ—§ç‰ˆæ¯”ç‰¹å¸ï¼Œä¸€ä¸ªæ˜¯æ–°ç‰ˆæ¯”ç‰¹å¸ï¼Œå¦‚æœæœ‰ç”¨æˆ·åšæŒåœ¨æ—§ç‰ˆä¸Šä¸å‡çº§ï¼Œå°±äº§ç”Ÿäº†ä¸¤ä¸ªæ¯”ç‰¹å¸ï¼Œç³»ç»Ÿå°±ä¼šäº§ç”Ÿæ··ä¹±ï¼Œè¿™æ˜¯Coreè®¤ä¸ºçš„ç¬¬ä¸€ä¸ªé£é™©ã€‚ Coreè®¤ä¸ºå¦‚æœç§»é™¤è¿™ä¸ª1Mçš„é™åˆ¶ï¼Œä»¥åçš„åŒºå—ä¼šè¶Šæ¥è¶Šå¤§ï¼Œ2,4,8,16ï¼Œå¤ªå¤§åŒºå—ä¼šå¯¼è‡´æ™®é€šäººçš„ç”µè„‘æ— æ³•è¿è¡Œå®Œæ•´ç‰ˆçš„é’±åŒ…ï¼Œè¿™ç§å®Œæ•´ç‰ˆçš„é’±åŒ…ç§°ä¸ºå…¨èŠ‚ç‚¹ã€‚Coreè®¤ä¸ºå¦‚æœä¸ªäººä¸èƒ½è¿è¡Œå…¨èŠ‚ç‚¹ï¼Œè€Œåªæœ‰å…¬å¸å’Œæœºæ„èƒ½è¿è¡Œå…¨èŠ‚ç‚¹ï¼Œä¼šå¯¼è‡´æ¯”ç‰¹å¸çš„ä¸­å¿ƒåŒ–ã€‚ Coreè®¤ä¸ºæˆ‘ä»¬ç°åœ¨æœ‰ä¸€äº›æ¯”ä¸­æœ¬èªæ›´å…ˆè¿›çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œé€šè¿‡ç¬¬äºŒå±‚ç½‘ç»œï¼ˆæ¯”å¦‚é—ªç”µç½‘ç»œï¼‰å¯¹æ¯”ç‰¹å¸çš„äº¤æ˜“è¿›è¡Œåˆ†å±‚ï¼Œå¤§éƒ¨åˆ†ä½ä»·å€¼äº¤æ˜“èµ°ç¬¬äºŒå±‚ç½‘ç»œï¼Œåªæœ‰å°‘æ•°çš„é«˜ä»·å€¼ç»“ç®—äº¤æ˜“èµ°ä¸»é“¾è¿™ä¸ªç¬¬ä¸€å±‚ç½‘ç»œã€‚ é—ªç”µç½‘ç»œé—ªç”µç½‘ç»œæ˜¯æ€ä¹ˆè¿è¡Œçš„å‘¢ï¼Ÿå®ƒç±»ä¼¼äºç‰Œå±€é‡Œçš„è®°è´¦å‘˜ã€‚æ¯”å¦‚è¯´æœ‰å‡ ä¸ªäººåœ¨æ‰“ç‰Œï¼Œä»–ä»¬å¹¶ä¸ä¼šæ¯æ‰“ä¸€åœˆå°±æˆ‘ç»™ä½ äº”å—é’±ï¼Œä½ ç»™æˆ‘åå—é’±ï¼Œè€Œæ˜¯ä¼šå…ˆè®°è´¦ï¼Œç­‰æ‰“å®Œå¾ˆå¤šåœˆä»¥åï¼Œå†ä¸€èµ·ç®—è´¦ï¼Œåªä»˜ä¸€æ¬¡é’±ã€‚ é—ªç”µç½‘ç»œç±»ä¼¼äºè¿™ç§æ€è·¯ï¼Œæ¯”å¦‚è¯´æœ‰äººè¦ç»å¸¸å‘äº¤æ˜“æ‰€å……å€¼å’Œæç°ï¼Œé‚£ä»–å°±å¯ä»¥ç”¨é—ªç”µç½‘ç»œï¼Œå’Œäº¤æ˜“æ‰€ä¹‹é—´æ‰“å¼€ä¸€ä¸ªç»“ç®—é€šé“ï¼Œä»–å‘äº¤æ˜“æ‰€å……10BTCï¼Œå¹¶ä¸æ˜¯å……åˆ°äº¤æ˜“æ‰€çš„åœ°å€ä¸Šï¼Œè€Œæ˜¯å……åˆ°è¿™ä¸ªç»“ç®—é€šé“ä¸­ï¼Œç„¶åæ¯”å¦‚æç°1BTCä¹Ÿä¸æ˜¯æç°åˆ°ä»–çš„åœ°å€ï¼Œè€Œæ˜¯å’Œäº¤æ˜“æ‰€æŠŠé€šé“é‡Œçš„é’±é‡æ–°åˆ’åˆ†ä¸€ä¸‹ï¼Œæœ¬æ¥10ä¸ªæ¯”ç‰¹å¸éƒ½æ˜¯äº¤æ˜“æ‰€çš„ï¼Œç°åœ¨1ä¸ªæ¯”ç‰¹å¸å½’ä»–ï¼Œ9ä¸ªæ¯”ç‰¹å¸å½’äº¤æ˜“æ‰€ï¼Œè¿™æ ·ä»–å¯ä»¥å’Œäº¤æ˜“æ‰€å‘ç”Ÿå¾ˆå¤šç¬”å……å€¼æç°ï¼Œå´ä¸æ‰“å¸åˆ°åœ°å€ã€‚å°±å’Œæ‰“äº†å¾ˆå¤šåœˆç‰Œéƒ½è®°è´¦ï¼Œä¸å®é™…è½¬é’±ä¸€æ ·ï¼Œç›´åˆ°ä»–éœ€è¦å…³é—­è¿™ä¸ªç»“ç®—é€šé“æ—¶ï¼Œä»–å†å’Œäº¤æ˜“æ‰€ç»“ç®—æ¸…è´¦ç›®ï¼ŒæŠŠå±äºè‡ªå·±çš„å¸æåˆ°è‡ªå·±åœ°å€ã€‚ å¦‚æœæœ‰ä¸¤ä¸ªç”¨æˆ·éƒ½å’Œäº¤æ˜“æ‰€å»ºç«‹å’Œç»“ç®—é€šé“ï¼Œé‚£ä»–ä»¬å°±å¯ä»¥ä»¥äº¤æ˜“æ‰€ä¸ºä¸­é—´äººè¿›è¡Œè½¬è´¦ï¼Œäº¤æ˜“æ‰€ä¼šå¸®åŠ©ä»–ä»¬ç»“ç®—ç›¸åº”çš„é‡‘é¢ã€‚ è¿™å°±æ˜¯é—ªç”µç½‘ç»œï¼Œé—ªç”µç½‘ç»œåœ¨ä¸»é“¾ç¬¬ä¸€å±‚ç½‘ç»œçš„åŸºç¡€ä¸Šï¼Œå»ºç«‹äº†ä¸€ä¸ªç¬¬äºŒå±‚ç½‘ç»œï¼Œå¤§éƒ¨åˆ†äº¤æ˜“éƒ½èµ°ç¬¬äºŒå±‚ç½‘ç»œï¼Œè€Œä¸è¿›å…¥ç¬¬ä¸€å±‚ç½‘ç»œã€‚æœ‰ç‚¹ç±»ä¼¼äºä¸€ä¸ªé«˜æ¶æ¡¥å’Œåœ°é¢é“è·¯çš„å…³ç³»ã€‚ æ‰©å®¹æ´¾1.é—ªç”µç½‘ç»œæ¶æ„ä¸Šè™½ç„¶å­˜åœ¨ä¼˜åŠ¿ï¼Œä½†ä¸­æœ¬èªæ¶æ„å·²ç»è¢«å¸‚åœºè¯æ˜ç¨³å®šè¿è¡Œäº†8å¹´ï¼Œé‡‘èç³»ç»Ÿåº”è¯¥ä¿æŒç¨³å®šï¼Œæ²¡æœ‰ç‰¹åˆ«éœ€è¦ï¼Œä¸åº”ä¿®æ”¹ç°åœ¨çš„æ¶æ„ã€‚ ä»é‡‘èç³»ç»Ÿçš„è§’åº¦è€ƒè™‘ï¼Œæç¬¬äºŒå±‚ç½‘ç»œå¯ä»¥ï¼Œä½†è¦ä¿è¯ç¬¬ä¸€å±‚ç½‘ç»œå¯ä»¥ç”¨ï¼Œä¸èƒ½æŠŠç¬¬ä¸€å±‚ç½‘ç»œé™åˆ¶ä½1Mï¼Œå¦åˆ™ä¼šäº§ç”Ÿç¾éš¾æ€§åæœã€‚ç§‘æŠ€å²ä¸Šå‘ç”Ÿè¿‡ä¸€æ¬¡éå¸¸ç±»ä¼¼çš„ç¾éš¾ï¼šæ‘©æ‰˜ç½—æ‹‰çš„é“±æ˜Ÿç³»ç»Ÿã€‚æ‘©æ‰˜ç½—æ‹‰çš„æŠ€æœ¯äººå‘˜è®¤ä¸ºåœ°é¢åŸºç«™å¤ªLowäº†ï¼Œè¯´æˆ‘ä»¬è¦æä¸ªç»å¯¹ç‰›é€¼é«˜å¤§ä¸Šçš„å«æ˜Ÿé€šè®¯ç½‘ç»œï¼Œç»“æœé“±æ˜Ÿç³»ç»Ÿå¼€å‘äº†å‡ å¹´ï¼Œçƒ§æ‰äº†æ‘©æ‰˜ç½—æ‹‰çš„50äº¿ç¾å…ƒï¼ˆ1997å¹´çš„ç¾å…ƒï¼‰åï¼Œä»…ä»…è¿è¥äº†3ä¸ªæœˆå°±å€’é—­äº†ï¼Œå¹¶ä¸”ç›´æ¥æ‹–æ­»äº†æ‘©æ‰˜ç½—æ‹‰ã€‚æŠ€æœ¯ä¸Šçœ‹èµ·æ¥å…ˆè¿›çš„æ¶æ„æœªå¿…æ¯”å‚»å¤§é»‘ç²—çš„æ¶æ„å¥½ã€‚ 2.ç¬¬äºŒå±‚ç½‘ç»œå­˜åœ¨ä¸­å¿ƒåŒ–éšæ‚£ï¼ˆå…·ä½“è§£é‡Šï¼‰ï¼Œé—ªç”µç½‘ç»œçš„å…³é”®èŠ‚ç‚¹æœ‰ç‚¹ç±»ä¼¼äºæ”¯ä»˜å®ï¼ˆä½†ä¸èƒ½å·é’±å’Œé€ å‡å¸ï¼‰ï¼Œè¿è¥é—ªç”µç½‘ç»œçš„å…¬å¸ï¼Œå¯èƒ½è¢«æ”¿åºœç›‘ç®¡ï¼Œå…³é—­ã€‚ 3.é€šè¿‡ç™½çš®ä¹¦ç¬¬7ç« åˆ é™¤å†å²æ•°æ®ç­‰æ–¹å¼ï¼Œå¤§åŒºå—ä¸ä¼šå¯¼è‡´èŠ‚ç‚¹é—¨æ§›æé«˜ã€‚æŠ€æœ¯å‘å±•è¶…è¿‡äº¤æ˜“å‘å±•ï¼Œ20å¹´å†…æ‘©å°”å®šå¾‹ï¼ˆæ¯å¹´CPU+60%ï¼‰+å°¼å°”æ£®å®šå¾‹ï¼ˆæ¯å¹´å¸¦å®½+50%ï¼‰ï¼Œç°åœ¨çš„ç½‘ç»œå’Œç¡¬ä»¶å¯ä»¥æ‰¿å—20Mçš„åŒºå—ï¼Œè¶³å¤Ÿ10å¹´ä½¿ç”¨ã€‚ ä¸¤æ´¾çš„æ ¸å¿ƒåˆ†æ­§æ‰©å®¹æ´¾è®¤ä¸ºåº”è¯¥é‡ç‚¹å…³æ³¨æ¯”ç‰¹å¸çš„ä½¿ç”¨äººæ•°ï¼Œåªæœ‰æ›´å¤šçš„äººä½¿ç”¨ï¼Œæ‰èƒ½ä¿æŠ¤æ¯”ç‰¹å¸ï¼Œè¿™ç§ä¿æŠ¤æ˜¯å¤šä¸ªæ–¹é¢çš„ï¼Œæ—¢æ˜¯å› ä¸ºPoWå…±è¯†æœºåˆ¶ï¼ŒåŒæ ·å½“æ›´å¤šçš„äººèƒ½ä»åŒºå—é“¾çš„ç³»ç»Ÿä¸­è·ç›Šåï¼Œä»–ä»¬æ‰ä¼šè‡ªå‘åœ°æ‹¥æŠ¤å’Œå‘å±•åŒºå—é“¾ã€‚ å¦å¤–é€‚å½“çš„ä¸­å¿ƒåŒ–ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ä¸­æœ¬èªè®¤ä¸ºä¸ªäººç”¨è½»é’±åŒ…å³å¯ï¼Œæ²¡æœ‰å¿…è¦ç”¨å…¨èŠ‚ç‚¹ã€‚ åŒæ—¶è¿™æ´¾çš„è§‚ç‚¹ä¹Ÿæ¶‰åŠåˆ°äº†æ¯”ç‰¹å¸çš„ç»ˆæç›®çš„ï¼šä½œä¸ºæ³•å¸çš„ç«äº‰è´§å¸ï¼Œè¿™ä¸ªç†è®ºæ˜¯å“ˆè€¶å…‹æå‡ºæ¥çš„ï¼Œå“ˆè€¶å…‹æ˜¯1974å¹´è¯ºè´å°”ç»æµå­¦å¥–å¾—ä¸»ï¼Œä»–è®¤ä¸ºæ”¿åºœä¸å¯èƒ½æŠ‘åˆ¶ä½æ»¥å‘æ³•å¸çš„å†²åŠ¨ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ç«äº‰ã€‚å•†å“çš„ç«äº‰èƒ½äº§ç”Ÿæ›´å¥½çš„å•†å“ï¼Œè´§å¸ä¹Ÿåº”è¯¥ç«äº‰ï¼Œè´§å¸çš„ç«äº‰ä¹Ÿèƒ½äº§ç”Ÿæ›´å¥½çš„ï¼Œå¸å€¼ç¨³å®šçš„è´§å¸ã€‚åœ¨æ³•å¸è¿‡åˆ†é€šèƒ€æ—¶ï¼Œæ¯”ç‰¹å¸ä½œä¸ºæ³•å¸çš„ç«äº‰è´§å¸ï¼Œä¿æŠ¤äººæ°‘ä¸å—æ³•å¸å‰¥å‰Šï¼Œå¹¶é€šè¿‡ç«äº‰ï¼ŒæŠ‘åˆ¶æ³•å¸çš„é€šèƒ€ã€‚ Coreæ´¾åˆ™è®¤ä¸ºæ¯”ç‰¹å¸çš„ç»ˆæç›®çš„æ˜¯å®ç°ä¸€ä¸ªç»ˆæè‡ªç”±çš„è´§å¸ï¼Œèƒ½å¤Ÿä¿æŠ¤ä¸ªäººçš„è´¢äº§å®‰å…¨ï¼Œä»è¿™ç‚¹ä¸Šçœ‹ï¼Œå’Œæ‰©å®¹æ´¾ä¼¼ä¹æœ‰ç‚¹æ®Šé€”åŒå½’ï¼Œä½†æ˜¯ï¼ŒCoreæ´¾åˆ™æ˜¾å¾—æ›´ä¸ºæç«¯ï¼š Coreæ´¾ä¸æ˜¯å¾ˆå…³å¿ƒæ¯”ç‰¹å¸çš„äº¤æ˜“æ‹¥å µæˆ–ç”¨æˆ·å‘å±•ï¼Œå‡ºä¸–æ´¾å…³å¿ƒæ¯”ç‰¹å¸æ˜¯å¦ç¬¦åˆè‡ªå·±å¿ƒç›®ä¸­â€œç»ˆæè‡ªç”±è´§å¸â€çš„æ ‡å‡†ï¼Œè®¤ä¸ºâ€œç»ˆæè‡ªç”±è´§å¸â€ï¼Œæ˜¯å¸å¼•ç”¨æˆ·æ¥ç”¨çš„æœ€é«˜å¸å¼•åŠ›ã€‚ ä¸”ï¼ŒCoreæ´¾ä¸èƒ½æ¥å—ä¸€ç‚¹ä¸­å¿ƒåŒ–ï¼Œè®¤ä¸ºè¦ä¿è¯äººäººéƒ½å¯ä»¥è¿è¡Œå…¨èŠ‚ç‚¹ï¼Œå¹¶å¸Œæœ›è¿›ä¸€æ­¥å¢å¼ºæ¯”ç‰¹å¸çš„ç›¸å…³å±æ€§ï¼Œä¾‹å¦‚å®Œå…¨åŒ¿åæ€§ã€‚ åŒæ–¹çš„å¦¥åä¸å½»åº•åˆ†è£‚é¦™æ¸¯å…±è¯†ï¼šåŒæ–¹çš„æœ€åä¸€æ¬¡å¦¥åï¼ŒåŒæ–¹åŒæ„å¦¥ååˆ° éš”ç¦»è§è¯+ç¡¬åˆ†å‰2Mï¼ŒçŸ¿ä¸šä¸è¿è¡ŒClassicï¼ˆç®€å•2Mæ–¹æ¡ˆï¼‰ å¯¹æ‰©å®¹æ´¾æ¥è¯´ï¼Œ2Må¯ä»¥ç¼“è§£ç›®å‰æ‹¥å µçš„äº¤æ˜“ã€‚å¯¹Coreæ¥è¯´ï¼Œ2Mä¸ç®—å¤ªå¤§ï¼ˆéš”ç¦»è§è¯å®é™…ä¹Ÿè¾¾åˆ°2Mï¼‰ï¼Œæ‰€ä»¥ä»–ä»¬å¹¶ä¸åå¯¹éš”ç¦»è§è¯å’Œèƒ½å¢åŠ ç”¨æˆ·çš„LNï¼Œä½†æ‰©å®¹æ´¾åå¯¹Coreè·¯çº¿å›¾çš„ç¬¬ä¸€æ­¥ï¼šè½¯åˆ†å‰éš”ç¦»è§è¯ã€‚ Coreä¸»è¦çš„å‡ ä¸ªå¼€å‘å›å»åé­åˆ°å…¶ä»–äººçš„åå¯¹ï¼ˆå› ä¸ºè¿™æ˜¯ä¸ªå¦¥åçš„æ–¹æ¡ˆï¼‰ï¼Œè¿ç›¸åº”ä»£ç éƒ½æœªå¼€å‘ï¼Œé¦™æ¸¯å…±è¯†æµäº§ã€‚ é‚£ä¹ˆä¹‹åå‘¢ï¼Ÿ æ‰©å®¹æ–¹è½¬è€Œæ”¯æŒBUä¸€åŠ³æ°¸é€¸è§£å†³åŒºå—å¤§å°çš„æ–¹æ¡ˆ(BUï¼š51%çš„çŸ¿æ± æŠ•ç¥¨å†³å®šåŒºå—å¤§å°)â€”â€”Coreåå¯¹ï¼šæ‰©å®¹æ˜¯çŸ¿ä¸šä¼å›¾æ§åˆ¶æ¯”ç‰¹å¸ï¼Œè¿™å°†ç ´åæ¯”ç‰¹å¸çš„å¼€å‘ï¼ˆå¦‚é—ªç”µç½‘ç»œæ²¡æœ‰éš”ç¦»è§è¯åªèƒ½éå¸¸ä¸ä¼˜é›…åœ°è¿è¡Œï¼‰â€”â€”æ‰©å®¹åå¯¹Coreçš„åå¯¹ï¼šCoreçš„å¤šåå¼€å‘éƒ½å—BlockStreamå…¬å¸é›‡ä½£ï¼ŒBSä¸ºäº†æ¨è¡Œé—ªç”µç½‘ç»œï¼Œåˆ©ç”¨Coreçš„å‡ºä¸–å€¾å‘ï¼Œé”æ­»ä¸»é“¾åˆ°1Mï¼ˆCoreæ—©æœŸå¹¶æ²¡æœ‰1Mé‚£ä¹ˆæç«¯ï¼Œæ˜¯ä¸æç«¯çš„Coreå¼€å‘éƒ½è¢«è¸¢å‡ºå»äº†ï¼‰ã€‚ åå¤åµæ¶ä¹‹ä¸‹ï¼Œä¸€æ–¹é¢æ˜¯åŒºå—æ‹¥å µåŠ å‰§ï¼Œå¦ä¸€æ–¹é¢æ˜¯å…¶ä»–è´§å¸å¦‚ETHçš„é«˜é€Ÿå‘å±•ã€‚ ä»¥æ¯”ç‰¹å¸ä¸ºä»£è¡¨çš„åŒºå—é“¾æŠ€æœ¯ä»åœ¨æ›²æŠ˜å‰è¿›ï¼ŒåŒºå—é“¾å…ˆå¤©å…·æœ‰è·¨ç•Œçš„ä¼˜åŠ¿ï¼Œåœ¨é‡‘èã€ç‰©æµã€é›¶å”®ç­‰æ–¹é¢éƒ½å…·æœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚æ–‡ç« åˆ°è¿™å·²ç»æ¥è¿‘å°¾å£°ï¼Œä½†åŒºå—é“¾çš„æ•…äº‹è¿˜åœ¨ç»§ç»­ä¹¦å†™â€¦","link":"/2019/10/28/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%BC%AB%E8%B0%88/"},{"title":"[NOTE] å®‰è£…hadoopç›¸å…³æ³¨æ„äº‹é¡¹","text":"linuxåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­é€šè¿‡è¯»å–/etc/profileæ–‡ä»¶ä¸­å†…å®¹å®Œæˆç›¸å…³ç¯å¢ƒçš„è½½å…¥ï¼Œè€Œsshç™»é™†è¿œç¨‹ä¸»æœºçš„æ—¶å€™å¹¶ä¸ä¼šåŠ è½½/etc/profileä¸­çš„é…ç½®æ–‡ä»¶ã€‚ å› æ­¤jdkå®‰è£…å®Œæˆåéœ€è¦ä¸¤æ¬¡é…ç½®ï¼Œä¸€ä¸ºé…ç½®/etc/profileä¸­çš„ç¯å¢ƒå˜é‡ï¼ŒäºŒå°†hadoopå¯åŠ¨è„šæœ¬ä¸­è°ƒç”¨çš„HADOOP_HOMEæ”¹ä¸ºç»å¯¹è·¯å¾„çš„å½¢å¼ã€‚ ä¸€ã€æ“ä½œç³»ç»Ÿç¯å¢ƒ ä¾èµ–è½¯ä»¶sshã€jdk jdkå®‰è£…: rpm -i jdk-xxxx.rpmé€šè¿‡rpmå®‰è£…jdkï¼Œä¼šå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼Œä½¿ç”¨whereis javaæ—¶ï¼Œç³»ç»Ÿä¼šç»™å‡ºjavaå®‰è£…åœ¨/usr/bin/javaï¼Œä½†äº‹å®ä¸Šï¼Œ/usr/bin/javaå¼•å‡ºäº†ä¸€ä¸ªæŒ‡å‘/usr/javaçš„è½¯é“¾æ¥ï¼Œè€Œåœ¨/usr/javaä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªè½¯é“¾æ¥ï¼ŒdefaultæŒ‡å‘latestï¼ŒlatestæŒ‡å‘jdk1.x.x_xxx-xxxï¼Œä¸”ï¼Œé€šè¿‡rpmå®‰è£…çš„javaç¯å¢ƒæ˜¯ä¸å…¨çš„ï¼Œjava/binç›®å½•ä¸‹åªæœ‰å°‘æ•°æŒ‡ä»¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒå–ï¼Œè€Œå¦‚jpsä¸€èˆ¬çš„æŒ‡ä»¤å¹¶æœªæ·»åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼› è§£å†³ï¼šsudo vi /etc/profileæ–‡æœ«æ·»åŠ export JAVA_HOME=/usr/java/jdk1.x.x_xxx-xxxï¼Œå¹¶åœ¨ç³»ç»Ÿè·¯å¾„ä¸­å¢åŠ PATH = $PATH:$JAVA_HOME/bin source /etc/profile ç¯å¢ƒé…ç½® java_home(/etc/profile) å…å¯† æ—¶é—´åŒæ­¥ hostsã€hostname äºŒã€hadoopéƒ¨ç½² /opt/hadoop/ (/optç›®å½•ä¸“é—¨ç”¨äºæ”¾ç¬¬ä¸‰æ–¹æºçš„è½¯ä»¶ï¼Œæ³¨æ„/ä¸/usr/localçš„åŒºåˆ«) /etc/profileæ–‡ä»¶ä¸­åŠ å…¥export HADOOP_HOME=/opt/hadoopã€PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin å¯åŠ¨è„šæœ¬ä¿®æ”¹ $HADOOP_HOME/etc/hadoop/hadoop-env.sh $HADOOP_HOME/etc/hadoop/mapred-env.sh $HADOOP_HOME/etc/hadoop/yarn-env.sh é…ç½®æ–‡ä»¶ä¿®æ”¹ é…ç½®æ–‡ä»¶å½¢å¼å¦‚ä¸‹ï¼Œpropertyä¸­åŒ…å«name:valueå¯¹ï¼Œä¹‹åçš„å†…å®¹ä¸­å°†åªä¼šè¯´æ˜éœ€è¦é…ç½®çš„name:valueã€‚ 123456&lt;configuration&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://localhost:9000&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; etc/hadoop/core-site.xml Parameter Value Notes fs.defaultFS NameNode URI hdfs://host:port/ io.file.buffer.size 131072 Size of read/write buffer used in SequenceFiles. hadoop.tmp.dir /tmp/hadoop-${user.name} Linuxå†…æ ¸åœ¨å¿…è¦æ—¶ä¼šåˆ é™¤/tmpç›®å½•ä¸‹æ–‡ä»¶ï¼ŒåŒæ—¶hdfs-site.xmlä¸­çš„dfs.namenode.name.dirä¸dfs.datanode.data.dirä¹Ÿä½¿ç”¨äº†$hadoop.tmp.dirçš„å‚æ•°ï¼Œè¿™ä¼šé€ æˆæ•°æ®çš„ä¸¢å¤±ï¼Œå› æ­¤å¿…é¡»ä¿®æ”¹ã€‚æ”¹ä¸º/var/hadoop/local â€‹ etc/hadoop/hdfs-site.xml configurations for NameNode: Parameter Value Notes dfs.namenode.name.dir NNå¯¹å‘½åç©ºé—´åŠæ—¥å¿—æ–‡ä»¶è¿›è¡ŒæŒä¹…åŒ–çš„åœ°å€ã€‚ If this is a comma-delimited list of directories then the name table is replicated in all of the directories, for redundancy. dfs.hosts / dfs.hosts.exclude List of permitted/excluded DataNodes. If necessary, use these files to control the list of allowable datanodes. dfs.blocksize 268435456 HDFS blocksize of 256MB for large file-systems. dfs.namenode.handler.count 100 More NameNode server threads to handle RPCs from large number of DataNodes. configurations for SNN: | Parameter | Value | Notes | | ------------------------------------ | ------------- | ----------------------------------------------------- | | dfs.namedoe.secondary.http-address | 0.0.0.0:50090 | The secondary namenode http server address and port. | | dfs.namenode.secondary.https-address | 0.0.0.0:50091 | The secondary namenode HTTPS server address and port. | + configurations for DN: | Parameter | Value | Notes | | ----------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | | `dfs.datanode.data.dir` | Comma separated list of paths on the local filesystem of a `DataNode` where it should store its blocks. | If this is a comma-delimited list of directories, then data will be stored in all named directories, typically on different devices. | | | | |â€‹ etc/hadoop/yarn-site.xml` etc/hadoop/mapred-site.xml è§’è‰²åœ¨å“ªé‡Œå¯åŠ¨ï¼Ÿ å¯åŠ¨ hdfs namenode -formatæ­¤å¤„é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œhdfsæ ¼å¼åŒ–å¤±è´¥ï¼ŒçŒœæµ‹æ˜¯è¿˜æœªä¿®æ”¹hadoopç”¨æˆ·æƒé™ï¼Œæš‚ä¸”å…ˆç”¨rootç”¨æˆ·ï¼Œä¿®æ”¹ç”¨æˆ·æƒé™çœ‹è¿™ä¸€ç¯‡ start-dfs.sh æ­¤å¤„é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¤–ç½‘æ— æ³•é€šè¿‡master:50070è®¿é—®hadoopçš„ç®¡ç†é¡µé¢ï¼ŒçŒœæµ‹æ˜¯é˜²ç«å¢™æ²¡å…³ï¼Œå…³é—­é˜²ç«å¢™çœ‹è¿™ä¸€ç¯‡ 3.é›†ç¾¤ NN SNN DN master * slave1 * * slave2 * slave3 * ä¿®æ”¹hadoop.tmp.dir=/var/hadoop/cluster å¹¶ä¿®æ”¹core-site.xml slaves hdfs-site.xmlä¸­ç›¸åº”çš„é…ç½® scp -r /opt/hadoop/ hadoop@slave1:/opt/ è‹¥ç¢°åˆ°scp permission denied çš„æƒ…å†µï¼Œå¯ä½¿ç”¨chmod 777 /opt/hadoopå¯¹ä½¿ç”¨æƒé™è¿›è¡Œä¿®æ”¹ 12","link":"/2019/07/08/%E5%AE%89%E8%A3%85hadoop%E7%9B%B8%E5%85%B3%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"},{"title":"[Docker] åŸºäºDockerçš„NextCloudç§æœ‰äº‘ç›˜æ­å»º","text":"æ¯«æ— å«é‡çš„æ°´åšå®¢ã€‚ 1.å‡†å¤‡å·¥ä½œ å®‰è£…Dockerï¼Œå‡å®šCentOS: 1yum install -y docker è®¾ç½®Dockerè‡ªå¯ 12systemctl start dockersystemctl enable docker å‡†å¤‡ç›¸å…³é•œåƒ 12docker pull docker.io/nextclouddocker pull docker.io/mariadb 2.è¿è¡Œå®¹å™¨ æ•°æ®åº“å®¹å™¨ 123456docker run -d --name db_nextcloud \\-v /var/www/nextcloud/mysqldb:/var/lib/mysql \\-e MYSQL_ROOT_PASSWORD=ROOT_PWD \\-e MYSQL_DATABASE=nextcloud \\-e MYSQL_USER=nextcloud \\-e MYSQL_PASSWORD=YOUR_PWD mariadb nextcloudå®¹å™¨ 3.ç½‘é¡µé…ç½® å¥½çš„ï¼Œæ°´å®Œäº†ã€‚ çœ‹æ¥è¿˜æ²¡å®Œ 4.å°†æœ¬åœ°ç«¯å£æ˜ å°„åˆ°äº‘ç«¯ ä¿®æ”¹frpc.ini 1vim FRP_PATH/frpc.ini æ·»åŠ 12345[http-nextcloud]type = tcplocal_ip = 192.168.1.101local_port = 40080remote_port = 40080 ä¹‹åå°±å¯ä»¥åœ¨è¿œç¨‹ä¸»æœº remote_ipaddr:40080ä¸Šçœ‹åˆ°é¡µé¢äº† 5.åŸŸååŠ å…¥åˆ°ä¿¡ä»»åˆ—è¡¨å¦‚æœæŒ‰ç…§æœ¬æ–‡çš„æ­¥éª¤ï¼Œé‚£ä¹ˆåˆ°äº†è¿™ä¸ªåœ°æ–¹ä½ åº”è¯¥ä¼šç¢°åˆ°ä¸€ä¸ªé—®é¢˜ï¼šé€šè¿‡åŸŸåè®¿é—®äº‘ç›˜æ—¶ï¼ŒNextCloudé¡µé¢ä¼šæç¤ºè¯·æ±‚åŸŸåæœªåŠ å…¥åˆ°ä¿¡ä»»åˆ—è¡¨ã€‚æŒ‰ç…§é¡µé¢ç»™å‡ºçš„æç¤ºï¼Œè¿™ä¸ªé—®é¢˜åº”è¯¥å¾ˆå¥½è§£å†³ï¼š 1vim /var/www/nextcloud/config/config.php åœ¨trusted_domainsä¸‹æ·»åŠ ï¼š 123456'trusted_domains' =&gt; array ( 0 =&gt; '192.168.1.253:40080', 1 =&gt; 'YOUR_REMOTE_ADDR', 2 =&gt; 'YOUR_DOMAINS',)","link":"/2019/09/25/%E5%9F%BA%E4%BA%8EDocker%E7%9A%84NextCloud%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98%E6%90%AD%E5%BB%BA/"},{"title":"[Golang] è‡ªåŠ¨å¥åº·ä¸ŠæŠ¥","text":"Charles http.Client mailx crontab Charles Golang 1.14 CentOS 7 å¥åº·ä¸ŠæŠ¥APP 1. Charles1.1 åŸºæœ¬é…ç½®æœ¬èº«çš„åŠŸèƒ½è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œç”±äºå¥åº·ä¿¡æ¯ä¸ŠæŠ¥åœ¨æ‰‹æœºAPPä¸­ï¼Œæ— æ³•æ­£å¸¸é€šè¿‡æµè§ˆå™¨æ¥åˆ†æè¯·æ±‚ä¿¡æ¯ï¼Œæ‰€ä»¥æ­¤å¤„ç”¨Charlesè¿›è¡ŒæŠ“åŒ…ã€‚ Charlesä¸ºæ”¶è´¹è½¯ä»¶ï¼Œè‡ªè¡Œå†³å®šä¸‹è½½æºï¼Œå®‰è£…å®Œæˆåï¼š ç³»ç»Ÿä»£ç†ç«¯å£ï¼šèœå•æ Proxy - Proxy Settings - Proxies - HTTP Proxyè®¾ç½®ä¸º8888(é»˜è®¤å€¼)ï¼› ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹ï¼› æ‰‹æœºä¿®æ”¹Wi-Fié…ç½®ï¼Œä¸€èˆ¬åœ¨â€œæ— çº¿ç½‘ç»œé€‰é¡¹â€æˆ–â€œé«˜çº§é€‰é¡¹â€ä¸­ï¼Œå¯ä»¥è®¾ç½®HTTPä»£ç†ï¼Œå°†å…¶è®¾ç½®ä¸ºPC_ADDR: 8888ï¼Œæ­¤æ—¶æ‰‹æœºçš„æ‰€æœ‰æµé‡éƒ½ä¼šé€šè¿‡ç”µè„‘çš„8888ç«¯å£ï¼Œç”±Charlesæˆªè·ï¼› åŒ…ä¹±ç é—®é¢˜ï¼š ä»¥ä¸Šä»…é’ˆå¯¹httpè¯·æ±‚ï¼Œè€Œæˆ‘ä»¬éœ€è¦æˆªè·çš„APPè¯·æ±‚æ˜¯é€šè¿‡HTTPSè¿›è¡Œçš„ï¼Œå› æ­¤è¦æ±‚ç”µè„‘ç«¯å’Œæ‰‹æœºç«¯éƒ½æœ‰ç›¸åŒçš„è¯ä¹¦ï¼Œä¾¿äºä¼ªè£…(æˆ‘çŒœçš„) èœå•æ ï¼šHelp - SSL Proxing - Install Charles Root Certificate æ‰‹æœºæ‰“å¼€ç½‘å€http://www.charlesproxy.com/getsslï¼Œè·å–ç”µè„‘ä¸Šçš„è¯ä¹¦ èœå•æ ï¼šProxy - SSL Proxying Settings - SSL Proxyingï¼ŒLocation Includeä¸­æ·»åŠ *:443ï¼Œå³åŒ¹é…ä»»æ„ç«™ç‚¹çš„HTTPSè¯·æ±‚ 1.2 æŠ“åŒ…å®Œæˆé…ç½®ä¹‹åï¼ŒæŠ“åŒ…æ˜¯å¾ˆç®€å•çš„ï¼Œæ‰‹æœºæ‰“å¼€ç›¸åº”é¡µé¢ï¼Œç”µè„‘æˆªè·è¯·æ±‚ï¼Œç”±äºè¿™ä¸ªAPPç”¨çš„æ˜¯WebViewï¼Œç”šè‡³å¯ä»¥ç›´æ¥å°†è¯·æ±‚çš„ç½‘å€æå–å‡ºæ¥ï¼Œåˆ©ç”¨Chromeæµè§ˆå™¨è¿›è¡Œåˆ†æã€‚ æ ¹æ®ç›¸å…³ä¿¡æ¯æ‰¾åˆ°æœåŠ¡å™¨çš„åœ°å€ï¼Œåœ¨uc/wap/è·¯å¾„ä¸­ï¼Œæ‰¾åˆ°äº†ç›®æ ‡loginï¼Œæˆ‘ä»¬å…³æ³¨çš„ä¸»è¦åœ¨Contentsä¸­ï¼Œä¸Šä¸‹ä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯Requestä¸Responseã€‚ è‡³æ­¤ï¼Œæ‰‹æœºå¯ä»¥ä¸¢åˆ°ä¸€æ—äº†ã€‚å…³äºCharlesä½¿ç”¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« . 1.3 åˆ†æåœ¨ä¿¡æ¯ä¸ŠæŠ¥çš„æµç¨‹ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦å®Œæˆä¸¤æ­¥æ“ä½œâ€œç™»é™†-æäº¤ä¿¡æ¯â€ï¼Œå°½ç®¡æˆ‘ä»¬çŸ¥é“æåŠä¿¡æ¯å¯¹åº”çš„è·¯å¾„ncov/wap/default/saveï¼Œä½†æ˜¯ç›´æ¥è®¿é—®è¿™ä¸ªåœ°å€ä¼šè¢«é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç™»é™†è·å–Cookiesã€‚ ä¼ªé€ è¯·æ±‚ï¼šè¯·æ±‚ä¸­éœ€è¦åŒ…æ‹¬ä¸Requestä¸­ç›¸åŒçš„Headersï¼Œä½¿æˆ‘ä»¬çš„dataå¯ä»¥é¡ºåˆ©çš„è¢«æœåŠ¡å™¨è®¤å¯ã€è¯»å–å¹¶è¿”å›éœ€è¦çš„responseã€‚ è¯»å–è¿”å›ï¼šresponseé€šå¸¸ä¸ºè¿”å›çš„HTMLæˆ–è€…å…³äºæ“ä½œæˆåŠŸ/å¤±è´¥çš„statusï¼ŒæŒ‰ç…§Response - Headerä¸­å¯èƒ½å­˜åœ¨çš„Content-Encodingç±»å‹å¯¹è¿”å›å€¼è¿›è¡Œè§£ç ï¼Œå¹¶é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æå–å‡ºæ–‡æœ¬ä¸­æˆ‘ä»¬éœ€è¦çš„å†…å®¹ã€‚ ç»•è¿‡åˆæ³•æ€§æ ¡éªŒï¼šé€šè¿‡åˆ†æç½‘é¡µçš„æºç ï¼Œé’ˆå¯¹æ‰€å¤„åœ°ç†ä½ç½®ã€èº«ä½“çŠ¶å†µã€æ˜¯å¦å·²æäº¤ç­‰ä¿¡æ¯çš„æ ¡éªŒå‡ ä¹éƒ½æ˜¯åœ¨å‰ç«¯å®Œæˆçš„ï¼Œè¿™ä¹Ÿä¸ºæˆ‘ä»¬ä¹‹åçš„å·¥ä½œæä¾›äº†ä¾¿åˆ©ã€‚ å®šä½ä¿¡æ¯ï¼šå®šä½æ˜¯é€šè¿‡è¯·æ±‚ç™¾åº¦åœ°å›¾çš„APIå®Œæˆçš„ï¼Œæºç ä¸­å°±åŒ…å«ç›¸åº”çš„tokenã€‚ä½†ä½¿ç”¨APIå®šä½æ”¶åˆ°çš„é™åˆ¶æ¯”è¾ƒå¤§ï¼š1.æœ€ç»ˆéƒ¨ç½²æœåŠ¡å™¨çš„ä½ç½®ï¼›2.å¤§å…¬å¸APIå¯èƒ½å­˜åœ¨çš„ä¸€äº›å®‰å…¨é™åˆ¶ã€‚ä¸è¿‡ç½‘é¡µjsä¸­å°±åŒ…å«äº†â€œä¸Šæ¬¡æäº¤â€çš„ä¿¡æ¯oldInfoï¼Œå¯ä»¥ç›´æ¥é’ˆå¯¹ä¸Šæ¬¡ä¿¡æ¯ä½œå‡ºæå–ï¼Œä¿®æ”¹å‡ ä¸ªå€¼å°±å¯ä»¥ä½œä¸ºæ–°çš„ä¿¡æ¯è¿›è¡Œæäº¤äº†ã€‚ 2. ä¼ªè£…è¯·æ±‚åŸºäºä¸Šè¿°çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¨‹åºåˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š é¦–å…ˆå‘POST uc/wap/login/checkå‘é€ä¿¡æ¯ï¼ŒæˆåŠŸç™»é™†å¹¶è·å–cookiesï¼› GET /ncov/wap/default/indexå‘ä¿¡æ¯ä¸ŠæŠ¥é¡µé¢è¯·æ±‚ä¿¡æ¯ï¼Œå¹¶ä¸”å¯¹æ‰€éœ€ä¿¡æ¯è¿›è¡ŒåŒ¹é…ï¼› ä¹‹åç»•è¿‡ä¿¡æ¯ä¸ŠæŠ¥çš„é¡µé¢ï¼Œç›´æ¥å°†åŒ…è£…å¥½çš„ä¿¡æ¯é€šè¿‡POST /ncov/wap/default/index/saveã€‚ 2.1 Golangçš„å‡ ç§è¯·æ±‚æ–¹å¼2.1.1 GET123func Get(url string) (resp *Response, err error) { return DefaultClient.Get(url)} Getè¯·æ±‚å¯ä»¥ç›´æ¥ç”¨http.Get(url string)æ–¹æ³•è¿›è¡Œï¼Œå¦‚ä¸‹ï¼š 123456789101112func httpGet() { resp, err := http.Get(\"https://example.com\") if err != nil { // handle error } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) //è¯·æ±‚æ•°æ®è¿›è¡Œè¯»å– if err != nil { // handle error } fmt.Println(string(body))} 2.1.2 POSThttp.Post()æ¥æ”¶stringç±»å‹çš„urlä¸è¯·æ±‚å¤´bodyTypeï¼Œæœ€åä¸€ä¸ªå‚æ•°æ¥æ”¶io.Readerç±»å‹çš„ä¸»ä½“å†…å®¹ï¼Œå¯ä»¥é€šè¿‡strings.NewReader()è¿›è¡Œè½¬æ¢ 123func Post(url string, bodyType string, body io.Reader) (resp *Response, err error) { return DefaultClient.Post(url, bodyType, body)} ä¾‹ï¼š 12345678910111213func httpPost() {resp, err := http.Post(\"https://example.com\",\"application/x-www-form-urlencoded\",strings.NewReader(\"name=abc\")) if err != nil { fmt.Println(err) } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) if err != nil { // handle error } fmt.Println(string(body))} http.PostForm()æ”¯æŒè¡¨å•çš„è¯·æ±‚ï¼š 1234567func httpPostForm() { form := url.Value{} form.Add(\"name\", \"å¼ ä¸‰\") form.Add(\"password\", \"zhangsanNB\") resp, err := http.PostForm(\"https://example.com\", form) ...} 2.1.3 å¤æ‚è¯·æ±‚å¯¹äºä¸€äº›å¤æ‚çš„è¯·æ±‚ï¼Œå¯ä»¥ç”¨http.NewRequest()å’Œ&amp;http.Client{}è¿›è¡Œæ„å»ºã€‚ äº‹å®ä¸Šï¼Œhttp.Get() http.Post() http.PostForm()éƒ½æ˜¯å¯¹http.Client{}çš„å°è£…ï¼Œåœ¨æ‰§è¡Œè¯·æ±‚çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç”¨äº†client.Do()æ–¹æ³•ï¼Œå› æ­¤è¦è®¾ç½®æ›´è¯¦ç»†çš„è¯·æ±‚ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥é¦–å…ˆå¯¹http.Client{}è¿›è¡Œåˆå§‹åŒ–ï¼š 12345jar, _ := cookiejar.New(nil)client := &amp;http.Client{ Jar: jar, Timeout: 10 * time.Second,} cookiejarä¸ºä¿å­˜cookieçš„å®¹å™¨ï¼ŒTimeoutç”¨äºè®¾ç½®è¶…æ—¶æ—¶é—´ã€‚å¯¹äºclientæˆ‘ä»¬éœ€è¦è¯¦ç»†è®¾ç½®å…¶Headers 1234567891011121314req.Header.Set(\"Host\", \"example.com\")req.Header.Set(\"Connection\", \"keep-alive\")req.Header.Set(\"Content-Control\", \"max-age=0\")req.Header.Set(\"DNT\", \"1\")req.Header.Set(\"Upgrade-Insecure-Requests\", \"1\")req.Header.Set(\"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36\")req.Header.Set(\"Sec-Fetch-Dest\", \"document\")req.Header.Set(\"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\")req.Header.Set(\"Sec-Fetch-Site\", \"same-origin\")req.Header.Set(\"Sec-Fetch-Mode\", \"navigate\")req.Header.Set(\"Sec-Fetch-User\", \"?1\")req.Header.Set(\"Referer\", \"https://example.com/uc/wap/login?redirect=https%3A%2F%2Fexample.com%2Fncov%2Fwap%2Fdefault%2Findex\")req.Header.Set(\"Accept-Encoding\", \"gzip, deflate, br\")req.Header.Set(\"Accept-Language\", \"zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7\") è¿™ä¸€æ­¥çš„å†…å®¹å–å†³äºä½ æ•è·çš„åŒ…çš„è¯·æ±‚å¤´ã€‚ä¹‹åæˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªè¯·æ±‚http.NewRequest() 12345678910111213// GETresp, err := client.Get(\"https://example.com\")if err != nil { logs.Warn(err.Error())}defer resp.Body.Close()// POSTreq, _ := http.Newrequest(\"POST\", \"https://example.com/\", \"data\")resp, _ := client.Do(req) //ç¯‡å¹…æœ‰é™ï¼Œerrçœç•¥// or// resp, _ := client.Post(\"https://example.com/\", \"data\", nil)defer resp.Body.Close() æ³¨æ„åŠæ—¶å…³é—­resp.Bodyï¼Œé˜²æ­¢èµ„æºå ç”¨å¯¼è‡´çš„é˜»å¡ã€‚ â€‹ 2.2 å†…å®¹æå–é€šè¿‡http.Client.Get(&quot;https://example.com/ncov/wap/default/index&quot;)å¯ä»¥è·å–é¡µé¢ä¿¡æ¯ï¼Œå½“ç„¶ç”±äºåœ¨headersä¸­è®¾å®šäº†Accept-Encoding: gzipï¼Œæ­¤å¤„éœ€è¦å¯¹response.Bodyè¿›è¡Œè§£ç æ“ä½œï¼Œå¦åˆ™çœ‹åˆ°çš„æ˜¯ä¸€å †ä¹±ç ï¼š 1234567891011//è§£å†³Contentä¹±ç é—®é¢˜var reader io.ReadCloserswitch response.Header.Get(\"Content-Encoding\") {case \"gzip\": reader, err = gzip.NewReader(response.Body) defer reader.Close()default: reader = response.Body}byte, err := ioutil.ReadAll(reader)str := string(byte) æˆªå–å†…å®¹ä¸­çš„ä¸€æ®µã€‚ 123456789101112131415161718192021# ----HTML ABOVE------ #var vm = new Vue({ el: '.form-detail2', data: { realname: \"å¼ ä¸‰\", number: 'SZ111111111', date: '2020-03-25', info: $.extend({ ... }, def, { szgj: '', szcs: '' }), oldInfo: {\"id\":2368048,\"uid\":236939,\"date\":\"20200324\",...,\"sflznjcjwfh\":\"0\"}, tipMsg: '', ajaxLock: false, showFxyy: false, sfzgn: 1, hasFlag: '1', }} ç®€å•ç²—æš´ä¸€ç‚¹ï¼Œç›´æ¥ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯oldInfo realname number 123456789func GetInfo(str string) (string, error) { matched, err := regexp.MatchString(\".*oldInfo:.*\", str) infoRegexp := regexp.MustCompile(`.*oldInfo:\\s(\\{.*\\})`) params := infoRegexp.FindStringSubmatch(str) if matched { return params[1], nil } return \"\", err} â€‹ 2.3 æ•°æ®åºåˆ—åŒ–jsonæ˜¾ç„¶oldInfoä¸ºä¸€æ®µjsonæ–‡æœ¬ï¼Œé€šè¿‡GetInfo(str string) (string, err)æˆ‘ä»¬å¾—åˆ°äº†ä¸€æ®µstringï¼Œå°†å…¶è½¬ä¸ºmap[string]interface{}ä¾¿äºå¯¹å…¶ä¸­çš„å€¼è¿›è¡Œä¿®æ”¹ã€‚ 1234567891011121314str := ReadString(username)var data map[string]interface{}// var info map[string]string// ç”±äºéƒ¨åˆ†å€¼å¹¶ä¸æ˜¯stringç±»å‹ï¼Œæ‰€ä»¥ç”¨interface{}è¿›è¡Œè¯»å–if err := json.Unmarshal([]byte(str), &amp;data); err != nil { return err}// some procedures ...byte, _ := json.Marshal(data)str := string(byte)// å°†æ•°æ®æŒä¹…åŒ–f, _ := os.Open(path)l, _ := os.WriteString(str) // lä¸ºå†™å…¥çš„å­—èŠ‚æ•°f.Close() è¿™é‡Œæœ‰ä¸ªä¸å¥½å¤„ç†çš„åœ°æ–¹ï¼šç”±äºè¿”å›çš„jsonæ–‡ä»¶ä¸­ï¼Œå­˜åœ¨æ•´å‹å’Œå­—ç¬¦ä¸²ç±»å‹çš„valueï¼Œè€Œåœ¨å°†æ•°æ®å°è£…åˆ°è¯·æ±‚åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å°†jsonå­˜åˆ°url.Values{}ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªmap[string][]stringç±»å‹çš„å¯¹è±¡ï¼Œä¸ºäº†é¿å…éº»çƒ¦ï¼Œåœ¨ä¸Šè¿°è¿‡ç¨‹ä¸­ï¼Œç›´æ¥è®²éƒ¨åˆ†æ•´å‹é€šè¿‡strconv.Itoa(int)è½¬æˆäº†å­—ç¬¦ç±»å‹ã€‚ 3. éƒ¨ç½²ä¸ºäº†å®ç°æ•´ä¸ªä¸ŠæŠ¥è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ï¼Œéœ€è¦å°†ç¨‹åºæ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¹¶å®šæœŸè¿è¡Œã€‚ 3.1 æ„å»ºå¤šå¹³å°å¯æ‰§è¡Œç¨‹åºé’ˆå¯¹ä¸åŒå¹³å°ä½¿ç”¨env GOOS=target-OS GOARCH=target-architecture go build path -o build-nameï¼Œå¸¸ç”¨çš„target-OSå’Œtarget-architectureå¦‚ä¸‹ï¼š| GOOS - Target Operating System | GOARCH - Target Platform || :â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”: | :â€”â€”â€”â€”â€”â€”â€”â€”: || android | arm || darwin | amd64 || darwin | arm || darwin | arm64 || linux | amd64 || windows | amd64 | å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ¨äº¤å‰ç¼–è¯‘çš„è„šæœ¬æ¥å®Œæˆè¿™ä¸ªå·¥ä½œã€‚ 3.2 é‚®ä»¶æé†’ç›®å‰ä¸»æµé‚®ç®±éƒ½å¯ä»¥å¼€å¯pop3æˆ–smtpçš„æœåŠ¡ï¼Œç”¨äºåœ¨ç¬¬ä¸‰æ–¹ä¸Šæ”¶å‘é‚®ä»¶ï¼Œè¯¸å¦‚qqã€outlookã€163(åƒåœ¾ï¼Œåˆ«ç”¨)ã€gmailç­‰éƒ½å¯ä»¥åœ¨è®¾ç½®ç•Œé¢æ‰¾åˆ°ç›¸åº”çš„é€‰é¡¹ï¼Œå¼€å¯åï¼ŒæœåŠ¡å•†éƒ½ä¼šç»™ä½ ä¸€æ®µæˆæƒç (ä¸æ˜¯å¯†ç )ï¼Œç”¨äºèº«ä»½è¯†åˆ«ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹: å¼€å¯smtpæˆæƒ æœåŠ¡å™¨ä¸Šmkdir /root/.certs é…ç½®è¯ä¹¦ï¼š 123456789echo -n | openssl s_client -connect smtp.qq.com:465 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; ~/.certs/qq.crtcertutil -A -n \"GeoTrust Global CA\" -t \"C,,\" -d ~/.certs -i ~/.certs/qq.crt certutil -A -n \"GeoTrust SSL CA\" -t \"C,,\" -d ~/.certs -i ~/.certs/qq.crt certutil -L -d /root/.certs certutil -A -n \"GeoTrust SSL CA - G3\" -t \"Pu,Pu,Pu\" -d ~/.certs/ -i ~/.certs/qq.crt å®‰è£…mailx 12yum -y install sendmailyum -y install mailx é…ç½®å‘ä»¶äººä¿¡æ¯:vim /etc/mail.rc 12345set from=example@qq.comset smtp=smtp.qq.comset smtp-auth-user=example@qq.comset smtp-auth-password=AUTHORITY_CODEset smtp-auth=login å‘é€é‚®ä»¶ï¼šcat response.log | mail -s 'title' yourmail@gmail.comæˆ–mail -s 'title' yourmail@gmail.com &lt; test.txt 3.3 å®šæ—¶æ‰§è¡Œä»»åŠ¡ å®‰è£…crontab 12yum install -y vixie-cronyum install -y crontabs é…ç½® 1service crond start å®šæ—¶è¿è¡Œ 1crontab -e å‡ºç°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ ¼å¼ï¼š 12* * * * * commandåˆ† æ—¶ æ—¥ æœˆ å‘¨ è®¾ç½®ä¸ºï¼š 130 6 * * * {$PATH}/report.sh 4. æ€»ç»“ ç¨‹åºç»“æ„æ··æ‚ï¼› golang httpåŒ…æºç å¯ä»¥çœ‹ä¸€ä¸‹ï¼› æºç .","link":"/2020/03/27/%E6%90%9E%E4%BA%8B/"},{"title":"[DB] å¹¶å‘æ§åˆ¶","text":"å¹¶å‘æ§åˆ¶simultaneous concurrencyå¹¶å‘æ§åˆ¶æ¦‚è¿°äº‹åŠ¡æ˜¯å¹¶å‘æ§åˆ¶åœ°åŸºæœ¬å•ä½ï¼Œä¸ºäº†ä¿è¯äº‹åŠ¡åœ°éš”ç¦»æ€§å’Œä¸€è‡´æ€§ï¼ŒDBMSéœ€è¦å¯¹å¹¶å‘æ“ä½œè¿›è¡Œæ­£ç¡®çš„è°ƒåº¦ã€‚ å¹¶å‘æ“ä½œå¸¦æ¥çš„æ•°æ®ä¸ä¸€è‡´æ€§åŒ…æ‹¬ä¸¢å¤±æ•°æ®ã€ä¸å¯é‡å¤è¯»ã€è¯»è„æ•°æ®ã€‚ ä¸¢å¤±æ•°æ®lost updateï¼šä¸¤ä¸ªäº‹åŠ¡è¯»å…¥åŒä¸€æ•°æ®å¹¶ä¿®æ”¹ï¼Œä¸€ä¸ªæäº¤çš„ç»“æœç ´åäº†å¦ä¸€ä¸ªæäº¤çš„ç»“æœï¼Œå¯¼è‡´ä¿®æ”¹è¢«ä¸¢å¤±ã€‚ ä¸å¯é‡å¤è¯»non-repeatable readï¼šæŒ‡äº‹åŠ¡T1è¯»å–æ•°æ®åï¼Œäº‹åŠ¡T2æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œä½¿Tæ— æ³•å†ç°å‰ä¸€æ¬¡è¯»å–ç»“æœã€‚å…·ä½“åˆ†ä¸‰ç§ï¼š T1è¯»æŸä¸€æ•°æ®åï¼ŒT2ä¿®æ”¹ï¼ŒT1å†è¯»ï¼Œå¾—åˆ°ä¸åŒå€¼ã€‚ T1è¯»æŸä¸€æ•°æ®åï¼ŒT2åˆ é™¤ï¼ŒT1å†è¯»ï¼Œæ•°æ®æ¶ˆå¤±ã€‚ T1è¯»æŸä¸€æ•°æ®åï¼ŒT2æ’å…¥ï¼ŒT1å†è¯»ï¼Œå¤šäº†æ•°æ®ã€‚ åä¸¤ç§ä¸å¯é‡å¤è¯»æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºå¹»å½±(phamtom row)ç°è±¡ã€‚ è¯»è„æ•°æ®dirty readï¼šT1ä¿®æ”¹æŸä¸€æ•°æ®å¹¶å†™å›ç£ç›˜ï¼ŒT2è¯»è¯¥æ•°æ®ï¼ŒT1 rollbackï¼ŒT2è¯»åˆ°çš„æ•°æ®ä¸æ•°æ®åº“ä¸­çš„æ•°æ®ä¸ä¸€è‡´ã€‚ å¹¶å‘æ§åˆ¶çš„ä¸»è¦æŠ€æœ¯ï¼šå°é”(locking)ï¼Œæ—¶é—´æˆ³(timestamp)ï¼Œä¹è§‚æ§åˆ¶æ³•(optimistic scheduler)ï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(multi-version concurrency control,MVCC) å°é”äº‹åŠ¡å¯¹æŸä¸ªæ•°æ®è¿›è¡ŒåŠ é”ï¼Œåœ¨å…¶é‡Šæ”¾å‰ï¼Œå…¶ä»–é£Ÿç‰©ä¸èƒ½æ›´æ–°æ­¤æ•°æ®å¯¹è±¡ã€‚ åŸºæœ¬çš„å°é”ç±»å‹æœ‰ä¸¤ç§ï¼š æ’ä»–é”(å†™é”)-Xé”ï¼Œé‡Šæ”¾å‰åªå…è®¸è‡ªå·±è¯»å†™ï¼Œä¸”ç¦æ­¢å…¶ä»–äº‹åŠ¡åŠ ä»»ä½•ç±»å‹çš„é”ã€‚ å…±äº«é”(è¯»é”)-Sé” ï¼Œé‡Šæ”¾å‰è‡ªå·±ä¹Ÿåªèƒ½è¯»ï¼Œå…¶ä»–äº‹åŠ¡å¯ä»¥è¯»ï¼Œå¯ä»¥åŠ åŒæ ·çš„Sé”ã€‚ å°é”åè®®locking protocolå°é”åè®®ï¼šè§„å®šåˆé€‚ç”³è¯·Xé”æˆ–Sé”ã€æŒé”æ—¶é—´ã€ä½•æ—¶é‡Šæ”¾ç­‰ã€‚ ä¸€çº§å°é”åè®®ï¼šäº‹åŠ¡Tåœ¨ä¿®æ”¹æ•°æ®Rä¹‹å‰å¿…é¡»å…ˆå¯¹å…¶åŠ Xé”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾ã€‚äº‹åŠ¡ç»“æŸåŒ…æ‹¬COMMIT, ROLLBACKã€‚ ä¸€çº§å°é”åè®®ä¸­ï¼Œå¦‚æœä»…ä»…æ˜¯è¯»æ•°æ®è€Œä¸æ˜¯å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œæ˜¯ä¸éœ€è¦åŠ é”çš„ï¼Œæ‰€ä»¥å®ƒ**ä¸èƒ½ä¿è¯ å¯é‡å¤è¯» å’Œ ä¸è¯»è„æ•°æ®ã€‚ äºŒçº§å°é”åè®®ï¼šåœ¨ä¸€çº§å°é”åè®®çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº‹åŠ¡Tåœ¨è¯»å–æ•°æ®Rä¹‹å‰å¿…é¡»å…ˆå¯¹å…¶åŠ Sé”ï¼Œè¯»å®Œåå³å¯é‡Šæ”¾Sé”ã€‚ ç”±äºè¯»å®Œå³å¯é‡Šæ”¾Sé”ï¼Œæ‰€ä»¥ä»–ä¸èƒ½ä¿è¯ å¯é‡å¤è¯»ã€‚ ä¸‰çº§å°é”åè®®ï¼šåœ¨ä¸€çº§å°é”åè®®çš„åŸºç¡€ä¸Šå¢åŠ  äº‹åŠ¡Tåœ¨è¯»å–æ•°æ®Rä¹‹å‰å¿…é¡»å…ˆå¯¹å…¶åŠ Sé”ï¼Œç›´åˆ°è¯¥äº‹åŠ¡ç»“æŸä¹‹åæ‰é‡Šæ”¾ã€‚ å¯è§£å†³ä¸å¯é‡å¤è¯»ã€è¯»è„æ•°æ®é—®é¢˜ã€‚ ä¸‰çº§åè®®çš„ä¸»è¦åŒºåˆ«åœ¨äºä»€ä¹ˆæ“ä½œéœ€è¦ç”³è¯·å°é”ï¼Œä»¥åŠåˆé€‚é‡Šæ”¾é”ã€‚ æ´»é”å’Œæ­»é”æ´»é” ï¼šT1å°é”æ•°æ®Rï¼ŒT2è¯·æ±‚å°é”Rï¼ŒåT3ä¹Ÿè¯·æ±‚å°é”Rï¼ŒT1é‡Šæ”¾Råé¦–å…ˆæ‰¹å‡†äº†T3çš„è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´T2è¢«æ’é˜Ÿäº†ï¼Œå¦‚æœT2ä¸€ç›´è¢«æ’é˜Ÿï¼Œé‚£ä¹ˆç§°ä¹‹ä¸ºæ´»é”ã€‚ è§£å†³æ–¹æ³•ï¼šå…ˆæ¥å…ˆæœåŠ¡ã€‚ æ­»é” ï¼šå¾ªç¯ç­‰å¾…ã€‚ æ­»é”çš„é¢„é˜²ï¼š ä¸€æ¬¡å°é”æ³•ï¼šè¦æ±‚æ¯ä¸ªäº‹åŠ¡å¿…é¡»ä¸€æ¬¡å°†æ‰€æœ‰è¦ä½¿ç”¨çš„æ•°æ®å…¨éƒ¨åŠ é”ï¼Œå¦åˆ™å°±ä¸èƒ½ç»§ç»­æ‰§è¡Œã€‚ ç¼ºé™·ï¼š1.æ‰©å¤§å°é”èŒƒå›´ï¼Œé™ä½å¹¶å‘åº¦ï¼›2.å¾ˆéš¾äº‹å…ˆç¡®å®šéœ€è¦å°é”çš„æ•°æ®å¯¹è±¡ã€‚ é¡ºåºå°é”æ³•ï¼šé¢„å…ˆå¯¹æ•°æ®å¯¹è±¡è§„å®šä¸€ä¸ªå°é”é¡ºåºï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½æŒ‰ç…§è¿™ä¸ªé¡ºåºå®æ–½å°é”ã€‚ ç¼ºé™·ï¼š1.æ•°æ®åº“ç³»ç»Ÿä¸­å°é”çš„æ•°æ®å¯¹è±¡æå¤šï¼Œå¹¶ä¸”ä¸æ–­å˜åŒ–ï¼Œè¦ç»´æŠ¤è¿™æ ·çš„èµ„æºçš„å°é”é¡ºåºéå¸¸å›°éš¾ï¼Œæˆæœ¬å¾ˆé«˜ï¼›2.å¾ˆéš¾äº‹å…ˆç¡®å®šè¦å°é”é‚£äº›å¯¹è±¡ï¼Œä¸€æ¬¡ä¹Ÿå°±å¾ˆéš¾æŒ‰è§„å®šçš„é¡ºåºå»æ–½åŠ å°é”ã€‚ æ­»é”çš„è¯Šæ–­ä¸è§£é™¤ ï¼š è¶…æ—¶æ³•ï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡çš„ç­‰å¾…æ—¶é—´è¶…è¿‡äº†è§„å®šçš„æ—¶é™ï¼Œå°±è®¤ä¸ºå‘ç”Ÿäº†æ­»é”ã€‚ ç­‰å¾…å›¾æ³•ï¼šç”¨ä¸€ä¸ªæœ‰å‘å›¾G=(T, U)è¡¨ç¤ºäº‹åŠ¡çš„æƒ…å†µï¼ŒåŠ¨æ€åœ°åæ˜ æ‰€æœ‰äº‹åŠ¡åœ°ç­‰å¾…æƒ…å†µï¼Œå‘¨æœŸæ€§ç”Ÿæˆäº‹åŠ¡ç­‰å¾…å›¾ï¼Œå¹¶è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°å›¾ä¸­å­˜åœ¨å›è·¯ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿä¸­å‡ºç°äº†æ­»é”ã€‚ è§£é™¤æ­»é”ï¼šé€‰æ‹©ä¸€ä¸ªå¤„ç†æ­»é”ä»£ä»·æœ€å°çš„äº‹åŠ¡ï¼Œå°†å…¶æ’¤é”€ï¼Œé‡Šæ”¾æ­¤äº‹åŠ¡æŒæœ‰åœ°æ‰€æœ‰é”ã€‚ å¹¶å‘è°ƒåº¦åœ°å¯ä¸²è¡Œæ€§å¯ä¸²è¡ŒåŒ–è°ƒåº¦ï¼šå¤šä¸ªäº‹åŠ¡åœ°å¹¶å‘æ‰§è¡Œæ˜¯æ­£ç¡®çš„ï¼Œå½“ä¸”ä»…å½“å…¶ç»“æœä¸æŒ‰æŸä¸€æ¬¡åºä¸²è¡Œæ‰§è¡Œè¿™äº›äº‹åŠ¡åœ°ç»“æœç›¸åŒæ—¶ï¼Œç§°è¿™ç§è°ƒåº¦ç­–ç•¥ä¸ºå¯ä¸²è¡ŒåŒ–serializableçš„ã€‚ å¯ä¸²è¡Œæ€§æ˜¯å¹¶å‘å®ç‰©æ­£ç¡®è°ƒåº¦çš„å‡†åˆ™ã€‚ å†²çªåŒ–å¯ä¸²è¡Œè°ƒåº¦å†²çªæ“ä½œæ˜¯æŒ‡ä¸åŒäº‹åŠ¡å¯¹åŒä¸€æ•°æ®çš„è¯»å†™æ“ä½œå’Œå†™å†™æ“ä½œã€‚è€Œå…¶ä»–æ“ä½œæ˜¯ä¸å†²çªæ“ä½œã€‚ é€šè¿‡äº¤æ¢ä¸¤ä¸ªäº‹åŠ¡ä¸å†²çªæ“ä½œçš„æ¬¡åºå¾—åˆ°å¦ä¸€ä¸ªè°ƒåº¦Scâ€˜ï¼Œå¦‚æœScâ€™æ˜¯ä¸²è¡Œçš„ï¼Œåˆ™ç§°è°ƒåº¦Scä¸ºå†²çªå¯ä¸²è¡ŒåŒ–çš„è°ƒåº¦ã€‚å› æ­¤å¯ä»¥ç”¨è¿™ç§æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªè°ƒåº¦æ˜¯å¦æ˜¯å†²çªå¯ä¸²è¡ŒåŒ–çš„ã€‚ å†²çªå¯ä¸²è¡ŒåŒ–è°ƒåº¦æ˜¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦çš„å……åˆ†æ¡ä»¶ï¼Œä¸æ˜¯å¿…è¦æ¡ä»¶ã€‚ ä¸¤æ®µé”åè®® TwoPhase Lockingæ‰€è°“2PLåè®®æ˜¯æŒ‡æ‰€æœ‰äº‹åŠ¡å¿…é¡»åˆ†ä¸¤ä¸ªé˜¶æ®µå¯¹æ•°æ®é¡¹åŠ é”å’Œè§£é”ï¼š åœ¨å¯¹ä»»ä½•æ•°æ®è¿›è¡Œè¯»ã€å†™æ“ä½œä¹‹å‰ï¼Œé¦–å…ˆè¦ç”³è¯·å¹¶è·å¾—å¯¹è¯¥æ•°æ®çš„å°é” åœ¨é‡Šæ”¾ä¸€ä¸ªé”ä¹‹åï¼Œäº‹åŠ¡ä¸å†ç”³è¯·å’Œè·å¾—ä»»ä½•å…¶ä»–å°é” äº‹åŠ¡åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µæ˜¯è·å¾—å°é”ï¼Œä¹Ÿæˆä¸ºæ‰©å±•é˜¶æ®µï¼Œæ­¤é˜¶æ®µå¯ä»¥ç”³è¯·è·å¾—ä»»ä½•æ•°æ®é¡¹ä¸Šçš„ä»»ä½•ç±»å‹çš„é”ï¼Œä½†æ˜¯ä¸èƒ½é‡Šæ”¾ä»»ä½•é”ï¼›ç¬¬äºŒé˜¶æ®µæ˜¯é‡Šæ”¾å°é”ï¼Œä¹Ÿç§°ä¸ºæ”¶ç¼©é˜¶æ®µï¼Œè¯¥é˜¶æ®µäº‹åŠ¡å¯ä»¥é‡Šæ”¾ä»»ä½•æ•°æ®é¡¹ä¸Šçš„ä»»ä½•ç±»å‹çš„é”ï¼Œä½†æ˜¯ä¸èƒ½å†ç”³è¯·ä»»ä½•é”ã€‚ è‹¥å¹¶å‘æ‰§è¡Œçš„æ‰€æœ‰äº‹åŠ¡å‡éµå¾ªä¸¤æ®µé”åè®®ï¼Œåˆ™å¯¹è¿™äº›äº‹åŠ¡çš„ä»»ä½•å¹¶å‘è°ƒåº¦éƒ½æ˜¯å¯ä¸²è¡ŒåŒ–çš„ã€‚ ä¸¥æ ¼ä¸¤æ®µé”åè®®ï¼šé™¤è¦æ±‚æ»¡è¶³ä¸¤æ®µé”åè®®è§„å®šå¤–ï¼Œè¿˜è¦æ±‚äº‹åŠ¡çš„æ’å®ƒé”å¿…é¡»åœ¨äº‹åŠ¡æäº¤ä¹‹åé‡Šæ”¾ å¼ºä¸¤æ®µé”åè®®ï¼šé™¤è¦æ±‚æ»¡è¶³ä¸¤æ®µé”åè®®è§„å®šå¤–ï¼Œè¿˜è¦æ±‚äº‹åŠ¡çš„æ‰€æœ‰é”éƒ½å¿…é¡»åœ¨äº‹åŠ¡æäº¤ä¹‹åé‡Šæ”¾ äº‹åŠ¡éµå®ˆä¸¤æ®µé”åè®®æ˜¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦çš„å……åˆ†æ¡ä»¶ï¼Œè€Œä¸æ˜¯å¿…è¦æ¡ä»¶ã€‚ å°é”çš„ç²’åº¦ Granularityå°é”å¯¹è±¡çš„å¤§å°ç§°ä¸ºå°é”çš„ç²’åº¦ï¼Œå°é”ç²’åº¦ä¸ç³»ç»Ÿçš„å¹¶å‘åº¦å’Œå¹¶å‘æ§åˆ¶çš„å¼€é”€å¯†åˆ‡ç›¸å…³ã€‚ å°é”çš„ç²’åº¦è¶Šå¤§ï¼Œæ•°æ®åº“æ‰€èƒ½å°é”çš„å•å…ƒå°±è¶Šå°‘ï¼Œå¹¶å‘åº¦è¶Šå°ï¼Œç³»ç»Ÿå¼€é”€è¶Šå°ã€‚ å¤šç²’åº¦å°é”ï¼šä¸€ä¸ªç³»ç»Ÿä¸­åŒæ—¶æ”¯æŒå¤šç§å°é”ç²’åº¦ä¾›ä¸åŒçš„äº‹åŠ¡é€‰æ‹©ã€‚ å¼•å…¥å¤šç²’åº¦æ ‘çš„æ¦‚å¿µï¼Œä¸‰çº§ç²’åº¦æ ‘(æ•°æ®åº“ï¼Œå…³ç³»ï¼Œå…ƒç»„)ï¼Œå››çº§ç²’åº¦æ ‘(æ•°æ®åº“ï¼Œæ•°æ®åˆ†åŒºï¼Œæ•°æ®æ–‡ä»¶ï¼Œæ•°æ®è®°å½•)ã€‚å¤šç²’åº¦å°é”åè®®å…è®¸å¤šç²’åº¦æ ‘ä¸­çš„æ¯ä¸ªç»“ç‚¹è¢«ç‹¬ç«‹çš„åŠ é”ã€‚å¯¹ä¸€ä¸ªç»“ç‚¹åŠ é”æ„å‘³ç€è¿™ä¸ªç»“ç‚¹çš„æ‰€æœ‰åè£”ç»“ç‚¹ä¹Ÿè¢«åŠ ä»¥åŒæ ·ç±»å‹çš„é”ã€‚ æ˜¾å¼å°é”ï¼šåº”äº‹åŠ¡è¦æ±‚ç›´æ¥åŠ åˆ°æ•°æ®å¯¹è±¡ä¸Šçš„é”ã€‚ éšå¼å°é”ï¼šè¯¥æ•°æ®å¯¹è±¡æ²¡æœ‰è¢«ç‹¬ç«‹åŠ é”ï¼Œè€Œæ˜¯ç”±äºå…¶ä¸Šçº§ç»“ç‚¹åŠ é”è€Œä½¿è¯¥æ•°æ®å¯¹è±¡åŠ ä¸Šäº†é”ã€‚ ä¸€èˆ¬åœ°ï¼Œå¯¹äºæŸä¸ªæ•°æ®å¯¹è±¡åŠ é”ï¼Œç³»ç»Ÿè¦æ£€æŸ¥è¯¥æ•°æ®å¯¹è±¡ä¸Šæœ‰æ— æ˜¾å¼å°é”ä¸ä¹‹å†²çªï¼Œè¿˜è¦æ£€æŸ¥ä¸Šçº§ç»“ç‚¹ä¼ ä¸‹æ¥çš„éšå¼å°é”æ˜¯å¦å†²çªï¼Œä»¥åŠä¼ ç»™ä¸‹çº§ç»“ç‚¹çš„å°é”æ˜¯å¦å†²çªï¼Œè¿™æ ·çš„æ£€æŸ¥æ–¹æ³•æ•ˆç‡å¾ˆä½ï¼Œå› æ­¤å¼•å…¥æ„å‘é”ã€‚ æ„å‘é”æ„å‘é”ï¼šå¦‚æœå¯¹ä¸€ä¸ªç»“ç‚¹åŠ æ„å‘é”ï¼Œåˆ™è¯´æ˜è¯¥ç»“ç‚¹çš„ä¸‹å±‚ç»“ç‚¹æ­£åœ¨è¢«åŠ é”ï¼›å¯¹ä»»ä¸€ç»“ç‚¹åŠ é”æ—¶ï¼Œå¿…é¡»å…ˆå¯¹å®ƒçš„ä¸Šå±‚ç»“ç‚¹åŠ æ„å‘é”ã€‚ ä¸‰ç§å¸¸ç”¨çš„æ„å‘é”ï¼Œæ„å‘å…±äº«é”(Intent Share Lockï¼ŒISé”)ï¼Œæ„å‘æ’ä»–é”(Intent Exclusive Lock, IXé”)ï¼Œæ„å‘å…±äº«æ’ä»–é”(Share Intent Exclusive Lock, SIXé”) ISé”ï¼šå¦‚æœå¯¹ä¸€ä¸ªæ•°æ®å¯¹è±¡åŠ ISé”ï¼Œè¡¨ç¤ºå®ƒçš„åè£”ç»“ç‚¹æ‹ŸåŠ Sé”ã€‚ ä¾‹å¦‚ï¼Œäº‹åŠ¡T1è¦å¯¹R1ä¸­æŸä¸ªå…ƒç»„åŠ Sé”ï¼Œåˆ™è¦é¦–å…ˆå¯¹å…³ç³»R1å’Œæ•°æ®åº“åŠ ISé” IXé”ï¼šå¦‚æœå¯¹ä¸€ä¸ªæ•°æ®å¯¹è±¡åŠ IXé”ï¼Œè¡¨ç¤ºå®ƒçš„åè£”ç»“ç‚¹æ‹ŸåŠ Xé”ã€‚ SIXé”ï¼šå¦‚æœå¯¹ä¸€ä¸ªå¯¹è±¡åŠ SIXé”ï¼Œè¡¨ç¤ºå¯¹å®ƒåŠ Sé”ï¼Œå†åŠ IXé”ï¼Œå³SIX=S+IXã€‚ è¯¾åé¢˜ï¼š æ­£ç¡®çš„è°ƒåº¦-&gt;å¯ä¸²è¡ŒåŒ–çš„è°ƒåº¦-&gt;éµå®ˆä¸¤é˜¶æ®µå°é”çš„è°ƒåº¦-&gt;ä¸²è¡Œè°ƒåº¦","link":"/2019/07/05/%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/"},{"title":"[DB] æ•°æ®åº“æ¢å¤æŠ€æœ¯","text":"æ•°æ®åº“æ¢å¤æŠ€æœ¯äº‹åŠ¡åœ¨è®¨è®ºæ•°æ®åº“æ¢å¤è®¡æ•°ä¹‹å‰å…ˆè¦æ˜ç¡®äº‹åŠ¡çš„åŸºæœ¬æ¦‚å¿µå’Œäº‹åŠ¡çš„æ€§è´¨ã€‚ äº‹åŠ¡ï¼šç”¨æˆ·å®šä¹‰çš„ä¸€ä¸ªæ•°æ®åº“æ“ä½œåºåˆ—ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨åšè¦ä¹ˆå…¨ä¸åšï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚åœ¨SQLä¸­ï¼Œå®šä¹‰äº‹åŠ¡çš„è¯­å¥æœ‰3æ¡ï¼š BEGIN TRANSACTION COMMIT ROLLBACK ç‰¹æ€§ï¼šACIDâ€”â€”åŸå­æ€§Atomisticyã€ä¸€è‡´æ€§Consistencyã€éš”ç¦»æ€§Isolationã€æŒç»­æ€§Durabilityã€‚ æ•…éšœçš„ç§ç±» äº‹åŠ¡å†…éƒ¨çš„æ•…éšœï¼šäº‹åŠ¡æ²¡æœ‰æ‰“åˆ°é¢„æœŸçš„ç»ˆç‚¹(COMMITæˆ–è€…æ˜¾ç¤ºçš„ROLLBACK)ï¼Œå› æ­¤ï¼Œæ•°æ®å¯å¯èƒ½å‡ºäºä¸æ­£ç¡®çš„çŠ¶æ€ã€‚äº‹åŠ¡å†…éƒ¨æ›´å¤šçš„æ•…éšœæ˜¯éé¢„æœŸçš„ï¼Œæ˜¯ä¸èƒ½ç”±åº”ç”¨ç¨‹åºå¤„ç†çš„ã€‚ ç³»ç»Ÿæ•…éšœï¼šç³»ç»Ÿæ•…éšœæ˜¯æŒ‡é€ æˆç³»ç»Ÿåœæ­¢è¿è½¬çš„ä»»ä½•æ—¶é—´ï¼Œæ˜¯çš„ç³»ç»Ÿè¦é‡æ–°å¯åŠ¨ã€‚å¦‚ï¼šCPUæ•…éšœã€æ“ä½œç³»ç»Ÿæ•…éšœã€DBMSä»£ç é”™è¯¯ã€ç³»ç»Ÿæ–­ç”µç­‰ã€‚å‘ç”Ÿç³»ç»Ÿæ•…éšœæ—¶ï¼Œä¸€äº›å°šæœªå®Œæˆçš„äº‹åŠ¡ç»“æœå¯èƒ½å·²é€å…¥ç‰©ç†æ•°æ®åº“ï¼Œä»è€Œé€ æˆæ•°æ®åº“å¯èƒ½å‡ºäºä¸æ­£ç¡®çš„çŠ¶æ€ã€‚ æ¢å¤å­ç³»ç»Ÿå¿…é¡»åœ¨ç³»ç»Ÿé‡æ–°å¯åŠ¨æ—¶è®©æ‰€æœ‰éæ­£å¸¸ä¸­å€¼çš„äº‹åŠ¡å›æ»šï¼Œè¿˜éœ€è¦é‡åšREDOæ‰€æœ‰å·²æäº¤çš„äº‹åŠ¡ï¼Œä»¥å°†æ•°æ®åº“çœŸæ­£æ¢å¤åˆ°ä¸€è‡´çŠ¶æ€ã€‚ ä»‹è´¨æ•…éšœï¼šç³»ç»Ÿæ•…éšœå¸¸è¢«æˆä¸ºè½¯æ•…éšœ(soft crash) ï¼Œä»‹è´¨æ•…éšœæˆä¸ºç¡¬æ•…éšœ(hard crash) ã€‚ç¡¬æ•…éšœæŒ‡å¤–å­˜æ•…éšœï¼Œå¦‚ç£ç›˜æŸåã€ç£å¤´ç¢°æ’ã€ç¬æ—¶å¼ºç£åœºå¹²æ‰°ç­‰ã€‚å‘ç”Ÿå‡ ç‡å°ï¼Œä½†ç ´åæ€§å·¨å¤§ã€‚ è®¡ç®—æœºç—…æ¯’ æ¢å¤çš„åŸºæœ¬åŸç†ï¼šå†—ä½™ã€‚ä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“ä¸­ä»»ä½•ä¸€éƒ¨åˆ†è¢«ç ´åæˆ–ä¸æ­£ç¡®çš„æ•°æ®å¯ä¸æ ¹æ®å­˜å‚¨åœ¨ç³»ç»Ÿåˆ«å¤„çš„å†—ä½™æ•°æ®æ¥é‡å»ºã€‚ æ¢å¤çš„å®ç°æŠ€æœ¯æ¢å¤æœºåˆ¶å…³é”®é—®é¢˜ï¼šå¦‚ä½•å»ºç«‹å†—ä½™æ•°æ®ï¼Œå¦‚ä½•åˆ©ç”¨è¿™äº›å†—ä½™æ•°æ®å®æ–½æ•°æ®åº“æ¢å¤ã€‚ å»ºç«‹å†—ä½™æ•°æ®æœ€å¸¸ç”¨çš„æŠ€æœ¯æ—¶æ•°æ®è½¬å‚¨å’Œç™»è®°æ—¥å¿—æ–‡ä»¶logging(é€šå¸¸äºŒæ³•å¹¶ç”¨)ã€‚ æ•°æ®è½¬å‚¨è½¬å‚¨å³æ•°æ®åº“ç®¡ç†å‘˜å®šæœŸåœ°å°†æ•´ä¸ªæ•°æ®åº“å¤åˆ¶åˆ°ç£ç›˜ã€ç£å¸¦æˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨ä¸Šä¿å­˜èµ·æ¥çš„è¿‡ç¨‹ã€‚è¿™äº›å¤‡ç”¨æ•°æ®æˆä¸ºåå¤‡å‰¯æœ¬backupã€‚è½¬å‚¨æ˜¯ååˆ†è€—è´¹æ—¶é—´å’Œèµ„æºçš„ï¼Œä¸èƒ½é¢‘ç¹è¿›è¡Œï¼Œåº”æ ¹æ®æ•°æ®åº“ä½¿ç”¨æƒ…å†µç¡®å®šä¸€ä¸ªé€‚å½“çš„è½¬å‚¨å‘¨æœŸã€‚ é™æ€è½¬å‚¨ï¼šç³»ç»Ÿä¸­åˆè¿è¡Œäº‹åŠ¡æ—¶è¿›è¡Œçš„è½¬å‚¨æ“ä½œã€‚ å³è½¬å‚¨æ“ä½œå¼€å§‹çš„æ—¶åˆ»ï¼Œæ•°æ®åº“å‡ºæ¸¸ä¸€è‡´æ€§çŠ¶æ€ï¼Œè€Œè½¬å‚¨æœŸé—´ä¸å…è®¸å¯¹æ•°æ®åº“çš„ä»»ä½•å­˜å–ã€ä¿®æ”¹æ´»åŠ¨ã€‚ç¼ºç‚¹ï¼šé™ä½æ•°æ®åº“çš„å¯ç”¨æ€§ã€‚ åŠ¨æ€è½¬å‚¨ï¼šè½¬å‚¨æœŸé—´å…è®¸å¯¹æ•°æ®åº“è¿›è¡Œå­˜å–æˆ–ä¿®æ”¹ã€‚ç¼ºç‚¹ï¼šè½¬å‚¨ç»“æŸæ—¶backupä¸Šçš„æ•°æ®å¹¶ä¸èƒ½ä¿è¯æ­£ç¡®æœ‰æ•ˆï¼Œå¯èƒ½å·²ç»æ˜¯è¿‡æ—¶çš„æ•°æ®äº†ã€‚ è§£å†³æ–¹æ³•ï¼šå°†è½¬å‚¨æœŸé—´å„äº‹åŠ¡å¯¹æ•°æ®åº“çš„ä¿®æ”¹æ´»åŠ¨ç™»è®°ä¸‹æ¥ï¼Œå»ºç«‹æ—¥å¿—æ–‡ä»¶log fileã€‚ è½¬å‚¨è¿˜åˆ†ä¸ºæµ·é‡è½¬å‚¨å’Œå¢é‡è½¬å‚¨ä¸¤ç§æ–¹å¼ã€‚ æµ·é‡è½¬å‚¨ï¼šæ¯æ¬¡è½¬å‚¨å…¨éƒ¨æ•°æ®åº“ å¢é‡è½¬å‚¨ï¼šæ¯æ¬¡åªè½¬å‚¨ä¸Šä¸€æ¬¡è½¬å‚¨åæ›´æ–°è¿‡çš„æ•°æ®ã€‚ ç™»è®°æ—¥å¿—æ–‡ä»¶Loggingæ—¥å¿—æ–‡ä»¶çš„æ ¼å¼å’Œå†…å®¹ æ—¥å¿—æ–‡ä»¶ï¼šç”¨æ¥è®°å½•äº‹åŠ¡å¯¹æ•°æ®åº“çš„æ›´æ–°æ“ä½œçš„æ–‡ä»¶ã€‚åˆ†ä¸ºå·²è®°å½•ä¸ºå•ä½çš„æ—¥å¿—æ–‡ä»¶å’Œä»¥æ•°æ®å—ä¸ºå•ä½çš„æ—¥å¿—æ–‡ä»¶ã€‚ æ—¥å¿—æ–‡ä»¶ä¸­éœ€è¦ç™»è®°çš„å†…å®¹ï¼š å„ä¸ªäº‹åŠ¡çš„å¼€å§‹(BEGIN TRANSACTION)æ ‡è®° å„ä¸ªäº‹åŠ¡çš„ç»“æŸ(COMMITæˆ–ROLLBACK)æ ‡è®° å„ä¸ªäº‹åŠ¡çš„æ‰€æœ‰æ›´æ–°æ“ä½œ æ—¥å¿—æ–‡ä»¶çš„ä½œç”¨ï¼š äº‹åŠ¡æ•…éšœæ¢å¤å’Œç³»ç»Ÿæ•…éšœæ¢å¤å¿…é¡»ç”¨æ—¥å¿—æ–‡ä»¶ åœ¨åŠ¨æ€è½¬å‚¨æ–¹å¼ä¸­å¿…é¡»å»ºç«‹æ—¥å¿—æ–‡ä»¶ï¼Œbackupå’Œlog fileç»“åˆèµ·æ¥æ‰èƒ½æœ‰æ•ˆåœ°æ¢å¤æ•°æ®åº“ é™æ€è½¬å‚¨æ–¹å¼ä¸­ä¹Ÿå¯ä»¥å»ºç«‹æ—¥å¿—æ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ•°æ®åº“æ¢å¤åå°†å·²å®Œæˆåœ°äº‹åŠ¡è¿›è¡Œé‡åšå¤„ç†ï¼Œå¯¹æ•…éšœå‘ç”Ÿæ—¶å°šæœªå®Œæˆçš„äº‹åŠ¡è¿›è¡Œæ’¤é”€å¤„ç† ä¸ºä¿è¯æ•°æ®åº“æ˜¯å¯æ¢å¤çš„ï¼Œç™»è®°æ—¥å¿—æ–‡ä»¶æ—¶å¿…é¡»éµå¾ªä¸¤æ¡åŸåˆ™ï¼š ç™»è®°çš„æ¬¡åºä¸¥æ ¼æŒ‰å¹¶å‘äº‹åŠ¡æ‰§è¡Œçš„æ—¶é—´æ¬¡åº å¿…é¡»å…ˆå†™æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åå†å†™æ•°æ®åº“ã€‚ æ¢å¤ç­–ç•¥äº‹åŠ¡æ•…éšœçš„æ¢å¤ ï¼šäº‹åŠ¡åœ¨è¿è¡Œè‡³æ­£å¸¸ç»ˆæ­¢ç‚¹å‰è¢«ç»ˆæ­¢ï¼Œæ¢å¤å­ç³»ç»Ÿåº”åˆ©ç”¨æ—¥å¿—æ–‡ä»¶æ’¤é”€UNDOæ­¤äº‹åŠ¡ä¸€å †æ•°æ®åº“è¿›è¡Œçš„ä¿®æ”¹ã€‚ç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆ ï¼Œå¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ï¼Œæ­¥éª¤ä¸ºï¼š åå‘æ‰«ææ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥æ‰¾è¯¥äº‹ç‰©çš„æ›´æ–°æ“ä½œã€‚ å¯¹è¯¥äº‹ç‰©çš„æ›´æ–°æ“ä½œæ‰§è¡Œé€†æ“ä½œ ç»§ç»­åå‘æ‰«ææ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥è¯¥äº‹åŠ¡çš„å…¶ä»–æ“ä½œï¼Œå¹¶ä½œåŒæ ·å¤„ç†ã€‚ repeat until begining ç³»ç»Ÿæ•…éšœçš„æ¢å¤ ï¼Œæˆå› æœ‰ä¸¤ä¸ªï¼š1.æœªå®Œæˆäº‹åŠ¡å¯¹æ•°æ®åº“çš„æ›´æ–°å·²å†™å…¥æ•°æ®åº“ï¼›2.å·²æäº¤äº‹åŠ¡å¯¹æ•°æ®åº“çš„æ›´æ–°è¿˜ç•™åœ¨ç¼“å†²åŒºã€‚è¯¥æ¢å¤ç”±ç³»ç»Ÿåœ¨é‡æ–°å¯åŠ¨æ—¶è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å¹²é¢„ã€‚ æ¢å¤æ­¥éª¤ï¼š æ­£å‘æ‰«ææ—¥å¿—æ–‡ä»¶ï¼Œæ‰¾å‡ºåœ¨æ•…éšœå‘ç”Ÿå‰å·²ç»æäº¤çš„äº‹åŠ¡(æœ‰BEGIN TRANSACTION å’Œ COMMIT)ï¼Œæ ‡è®°è®°å…¥é‡åšé˜Ÿåˆ—(REDO LIST)ï¼ŒåŒæ—¶æ‰¾å‡ºæ•…éšœå‘ç”Ÿæ—¶å°šæœªå®Œæˆçš„äº‹åŠ¡(åªæœ‰BEGIN TRANSACTIONæ— COMMIT)ï¼Œæ ‡è®°è®°å…¥æ’¤é”€é˜Ÿåˆ—(UNDO LIST) å¯¹UNDO LISTä¸­çš„å„ä¸ªäº‹åŠ¡UNDOâ€”â€”åå‘æ‰«ææ—¥å¿—æ–‡ä»¶ï¼Œå¯¹æ¯ä¸ªè¦æ’¤é”€äº‹åŠ¡çš„æ›´æ–°æ“ä½œæ‰§è¡Œé€†æ“ä½œã€‚ å¯¹REDO-LISTè¿›è¡ŒREDOâ€”â€”æ­£å‘æ‰«ææ—¥å¿—æ–‡ä»¶ï¼Œä¾æ¬¡REDOã€‚ ä»‹è´¨æ•…éšœçš„æ¢å¤ ï¼Œæ¢å¤æ–¹æ³•ï¼šé‡è£…æ•°æ®åº“ï¼Œé‡åšå·²å®Œæˆçš„äº‹åŠ¡ã€‚(è£…å…¥æœ€æ–°backupï¼Œè£…å…¥ç›¸åº”çš„æ—¥å¿—æ–‡ä»¶å‰¯æœ¬) å…·æœ‰æ£€æŸ¥ç‚¹çš„æ¢å¤æŠ€æœ¯åœ¨æ—¥å¿—æ–‡ä»¶ä¸­å¢åŠ ä¸€ä¸ªæ–°çš„è®°å½•â€”â€”æ£€æŸ¥ç‚¹checkpointè®°å½•ï¼Œå¢åŠ ä¸€ä¸ªé‡æ–°å¼€å§‹æ–‡ä»¶ï¼Œå¹¶è®©æ¢å¤å­ç³»ç»Ÿåœ¨ç™»å½•æ—¥å¿—æ–‡ä»¶æœŸé—´åŠ¨æ€åœ°ç»´æŠ¤æ—¥å¿—ã€‚ checkpointsè®°å½•å†…å®¹: å»ºç«‹æ£€æŸ¥ç‚¹æ—¶åˆ»æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡æ¸…å• è¿™äº›äº‹åŠ¡æœ€è¿‘ä¸€ä¸ªæ—¥å¿—è®°å½•çš„åœ°å€ åŠ¨æ€ç»´æŠ¤æ—¥å¿—æ–‡ä»¶çš„æ–¹æ³•æ˜¯ï¼Œå‘¨æœŸæ€§åœ°æ‰§è¡Œå»ºç«‹æ£€æŸ¥ç‚¹ã€ä¿å­˜æ•°æ®åº“çŠ¶æ€åœ°æ“ä½œã€‚ ä½¿ç”¨æ£€æŸ¥ç‚¹æ–¹æ³•å¯ä»¥æ”¹å–„æ¢å¤æ•ˆç‡ã€‚","link":"/2019/07/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D%E6%8A%80%E6%9C%AF/"},{"title":"[DB] æ•°æ®åº“ç³»ç»Ÿæ¦‚è®º","text":"æ•°æ®åº“ç³»ç»Ÿæ¦‚è®º æ•°æ®ï¼šæ•°æ®åº“ä¸­å­˜å‚¨çš„åŸºæœ¬å•ä½ æ•°æ®åº“ï¼šæ˜¯é•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„å¤§é‡æ•°æ®çš„é›†åˆã€‚å…·æœ‰è¾ƒå°çš„å†—ä½™åº¦ã€è¾ƒé«˜çš„æ•°æ®ç‹¬ç«‹æ€§ã€æ˜“æ‰©å±•æ€§ã€‚åŸºæœ¬ç‰¹ç‚¹ï¼šæ°¸ä¹…å­˜å‚¨ã€æœ‰ç»„ç»‡ã€å¯å…±äº«ã€‚ æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼šæ˜¯ä½äºç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„ä¸€å±‚æ•°æ®ç®¡ç†è½¯ä»¶ã€‚ä¸»è¦åŠŸèƒ½ï¼š æ•°æ®å®šä¹‰åŠŸèƒ½ æ•°æ®ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç† æ•°æ®æ“çºµåŠŸèƒ½ æ•°æ®åº“çš„äº‹åŠ¡ç®¡ç†å’Œè¿è¡Œç®¡ç† æ•°æ®åº“çš„å»ºç«‹å’Œç»´æŠ¤ å…¶ä»–åŠŸèƒ½ æ•°æ®åº“ç³»ç»ŸDBSï¼šæŒ‡åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­å¼•å…¥æ•°æ®åº“åçš„ç³»ç»Ÿï¼Œæœ‰æ•°æ®åº“ã€DBMSã€åº”ç”¨ç³»ç»Ÿã€æ•°æ®åº“ç®¡ç†å‘˜(DBA)ç»„æˆã€‚ æ•°æ®åº“ç³»ç»Ÿçš„ç‰¹ç‚¹ï¼š æ•°æ®ç»“æ„åŒ– æ•°æ®çš„å…±äº«æ€§é«˜ï¼Œå†—ä½™åº¦ä½ï¼Œæ˜“æ‰©å…… æ•°æ®ç‹¬ç«‹æ€§é«˜ æ•°æ®ç”±DBMSç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶ æ•°æ®ç®¡ç†çš„ä¸‰ä¸ªé˜¶æ®µï¼šäººå·¥ç®¡ç†é˜¶æ®µâ€”â€”æ–‡ä»¶ç³»ç»Ÿé˜¶æ®µâ€”â€”æ•°æ®åº“ç³»ç»Ÿé˜¶æ®µ å½•éŸ³æ€è·¯1.å¦‚ä½•ç»„ç»‡æ•°æ®â€”â€”æ•°æ®æ¨¡å‹ã€è§„èŒƒåŒ–ç†è®º 2.å¦‚ä½•å­˜å–æ•°æ®â€”â€”æ•°æ®å®šä¹‰ä¸æ“ä½œè¯­è¨€ 3.å“ªäº›äººå¯ä»¥æ“ä½œå“ªäº›æ•°æ®â€”â€”å®‰å…¨æ€§ç›¸å…³ 4.å¾ˆå¤šäººåœ¨æ“ä½œç»Ÿä¸€æ•°æ®æ—¶å¦‚ä½•é¿å…å‘ç”Ÿå†²çªâ€”â€”å¹¶å‘æ§åˆ¶ 5.æ•…éšœåæ€ä¹ˆåŠâ€”â€”æ•°æ®æ¢å¤ æ•°æ®æ¨¡å‹ï¼šæ¦‚å¿µæ¨¡å‹ã€é€»è¾‘æ¨¡å‹ åˆ†ä¸¤ä¸ªæ¨¡å‹çš„åŸå› ï¼šé€»è¾‘æ¨¡å‹ ä¸ºäº†æ–¹ä¾¿æŠŠ æ¦‚å¿µæ¨¡å‹ å­˜æ”¾åˆ°è®¡ç®—æœºä¸­ï¼Œäº‹å®ä¸ŠäºŒè€…æ˜¯åŒä¸€æ¦‚å¿µã€‚ æ•°æ®æ¨¡å‹çš„ç»„æˆè¦ç´ ï¼šæ•°æ®ç»“æ„ã€æ•°æ®æ“ä½œã€æ•°æ®çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ æ¦‚å¿µæ¨¡å‹ï¼šå®ä½“ å±æ€§ ç  åŸŸ å®ä½“æ€§ å®ä½“é›† è”ç³» å¸¸ç”¨çš„é€»è¾‘æ•°æ®æ¨¡å‹ï¼š å±‚æ¬¡æ¨¡å‹ ç½‘çŠ¶æ¨¡å‹ å…³ç³»æ¨¡å‹ é¢å‘å¯¹è±¡æ¨¡å‹ å¯¹è±¡å…³ç³»æ¨¡å‹ E-Rå›¾ â€”â€”â€”â€”â€”- P19 å®ä½“-çŸ©å½¢ å±æ€§-æ¤­åœ† å…³ç³»-è±å½¢ã€‚ å…³ç³»æ¨¡å‹ï¼šå…³ç³»(Relation)ã€å…ƒç»„(Tuple)ã€å±æ€§(Attribute)ã€ç (Key)ã€åŸŸ(Domain)ã€åˆ†é‡ã€‚ å…³ç³»çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ï¼šå®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§ã€ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§ã€‚ ä¼˜ç‚¹ï¼šæ•°å­¦åŸºç¡€ã€æ¦‚å¿µå•ä¸€(éƒ½æ˜¯äºŒç»´è¡¨)ã€å­˜å–è·¯å¾„å¯¹ç”¨æˆ·é€æ˜ã€‚ ç¼ºç‚¹ï¼›æ•ˆç‡ã€ä¼˜åŒ–ä¼šå¢åŠ å¼€å‘éš¾åº¦ã€‚ æ•°æ®åº“ç³»ç»Ÿç»“æ„æ•°æ®åº“çš„ä¸‰çº§æ¨¡å¼ï¼š å¤–æ¨¡å¼ï¼šå­/ç”¨æˆ·æ¨¡å¼ï¼Œæ•°æ®åº“ç”¨æˆ·çœ‹è§å’Œä½¿ç”¨çš„å±€éƒ¨æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ã€‚ æ¨¡å¼ï¼šé€»è¾‘æ¨¡å¼ï¼Œæ•°æ®ä¸­å…¨ä½“æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ã€‚ å†…æ¨¡å¼ï¼šå­˜å‚¨æ¨¡å¼ï¼Œæ•°æ®ç‰©ç†ç»“æ„å’Œå­˜å‚¨æ–¹å¼çš„æè¿°ã€‚ æ•°æ®åº“çš„äºŒçº§æ˜ åƒï¼š å¤–æ¨¡å¼/æ¨¡å¼æ˜ åƒ æ¨¡å¼/å†…æ¨¡å¼æ˜ åƒâ€”â€”å®šä¹‰äº†æ•°æ®å…¨å±€é€»è¾‘ç»“æ„å’Œå­˜å‚¨ç»“æ„ä¹‹é—´å¯¹åº”å…³ç³»ã€‚ å…³ç³»æ•°æ®åº“çœ‹ä¹¦åšé¢˜å°±è¡Œ å€™é€‰ç ï¼šå…³ç³»ä¸­èƒ½å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå…ƒç»„çš„å€¼ã€‚ ä¸»å±æ€§ï¼šå€™é€‰ç ä¸­çš„å±æ€§ã€‚ å…³ç³»çš„ä¸‰ç§ç±»å‹ï¼šåŸºæœ¬ç±»å‹(åŸºæœ¬è¡¨)ã€æŸ¥è¯¢è¡¨ã€è§†å›¾è¡¨ã€‚ æ³¨ï¼š è¿æ¥æ“ä½œä¸­ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€äº›å€¼ï¼Œä¸ºäº†ä¿ç•™è¿™äº›å€¼è€Œç•™å‡ºç©ºå€¼å«åšå¤–è¿æ¥ è¦çœ‹é™¤è¿ç®— SQLç‰¹ç‚¹ï¼š ç»¼åˆç»Ÿä¸€ é«˜åº¦éè¿‡ç¨‹åŒ– é¢å‘é›†åˆçš„æ“ä½œæ–¹å¼ ä»¥åŒä¸€ç§è¯­æ³•ç»“æ„æä¾›å¤šç§ä½¿ç”¨æ–¹å¼ ä¿®æ”¹åŸºæœ¬è¡¨ï¼š ALTER TABLE &lt;è¡¨æ˜&gt; ä¾‹ï¼š â€‹ ALTER TABLE Student ADD S_entrance DATE; â€‹ ALTER TABLE Student ALTER COLUMN Sage INT; â€‹ ALTER TABLE Course ADD UNIQUE(Cname); æŸ¥è¯¢ä¸­çš„å­—ç¬¦åŒ¹é…ï¼š ä¾‹ï¼š â€‹ SELECT Sname, Sno, Ssex FROM Student WHERE Sname LIKE â€˜åˆ˜%â€™; â€‹ åŒ¹é…æ‰€æœ‰å§“åˆ˜çš„åŒå­¦ â€‹ SELECT Sname FROM Student WHERE Sname LIKE â€˜æ¬§é˜³__â€™; â€‹ åŒ¹é… æ¬§é˜³X having ORDER BY ASC(å‡åº) DESC(é™åº) ç¼ºçœæƒ…å†µä¸ºå‡åº æ•°æ®åº“å®‰å…¨æ€§è®¡ç®—æœºç³»ç»Ÿå®‰å…¨æ€§ï¼š æŠ€æœ¯å®‰å…¨ ç®¡ç†å®‰å…¨ æ”¿ç­–æ³•å¾‹ ç”¨æˆ·è¡¨ç¤ºä¸é‰´åˆ«Identification &amp; Authentication â€”â€” æœ€å¤–å±‚å®‰å…¨ä¿æŠ¤æªæ–½ ç”¨æˆ·è¡¨ç¤ºUser Identification å£ä»¤Password å­˜å–æ§åˆ¶ï¼š å®šä¹‰ç”¨æˆ·æƒé™ï¼Œå¹¶å°†ç”¨æˆ·æƒé™ç™»è®°åˆ°æ•°æ®å­—å…¸ä¸­ åˆæ³•æƒé™æ£€æŸ¥ è‡ªä¸»å­˜å–æ§åˆ¶(Discretionary Access Control, DAC) C1çº§åˆ« ç”¨æˆ·å¯¹äºä¸åŒçš„æ•°æ®åº“å¯¹è±¡ç”±ä¸åŒçš„å­˜å–æƒé™ï¼Œä¸åŒçš„ç”¨æˆ·å¯¹åŒä¸€å¯¹è±¡ä¹Ÿæœ‰ä¸åŒçš„æƒé™ï¼Œç”¨æˆ·å¯å°†å…¶æ‹¥æœ‰çš„å­˜å–æƒé™æˆæƒç»™å…¶ä»–ç”¨æˆ· å¼ºåˆ¶å­˜å–æ§åˆ¶(Mandatory Access Control, MAC) B1çº§åˆ« æ¯ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡è¢«æ ‡ä»¥ä¸€å®šçš„å¯†çº§ï¼Œæ¯ä¸€ä¸ªç”¨æˆ·ä¹Ÿè¢«æˆäºˆæŸä¸€çº§åˆ«çš„è®¸å¯è¯ã€‚ Discretionary Access Controlæˆæƒä¸å›æ”¶ï¼š GRANT GRANT SELECT ON TABLE Student TO U1; REVOKE å›æ”¶æƒé™ï¼Œå½¢å¼ä¸ä¸Šé¢ç±»ä¼¼ æ•°æ®åº“è§’è‰²â€”â€”æƒé™çš„é›†åˆï¼Œç”¨äºç®€åŒ–æˆæƒ 1.è§’è‰²çš„åˆ›å»º â€‹ CREATE ROLE 2.ç»™è§’è‰²æˆæƒ â€‹ ç•¥ 3.å°†ä¸€ä¸ªè§’è‰²æˆäºˆå…¶ä»–ç”¨æˆ· â€‹ ç•¥ 4.è§’è‰²æƒé™çš„æ”¶å› Mandatory Access Controlåœ¨MACä¸­DBMSæ‰€ç®¡ç†çš„å…¨éƒ¨å®ä½“è¢«åˆ†ä¸ºä¸»ä½“å’Œå®¢ä½“ä¸¤å¤§ç±»ã€‚ ä¸»ä½“ï¼šç³»ç»Ÿä¸­çš„æ´»åŠ¨å®ä½“ï¼Œæ—¢åŒ…æ‹¬DBMSæ‰€ç®¡ç†çš„å®é™…ç”¨æˆ·ï¼Œä¹ŸåŒ…æ‹¬ä»£è¡¨ç”¨æˆ·çš„å„è¿›ç¨‹ã€‚ å®¢ä½“ï¼šç³»ç»Ÿä¸­çš„è¢«åŠ¨å®ä½“ï¼ŒåŒ…æ‹¬æ–‡ä»¶ã€åŸºæœ¬è¡¨ã€ç´¢å¼•ã€è§†å›¾ï¼Œå—ä¸»é¢˜æ“çºµã€‚ å¯¹äºä¸»ä½“å’Œå®¢ä½“ï¼ŒDBMSä¸ºå®ƒä»¬æ¯ä¸ªå®ä¾‹æŒ‡æ´¾ä¸€ä¸ªæ•æ„Ÿåº¦æ ‡è®°(Label)ã€‚åˆ†ä¸ºç»å¯†Top Secretã€æœºå¯†Secretã€å¯ä¿¡Confidentialã€å…¬å¼€Publicï¼Œä¸»ä½“çš„æ•æ„Ÿåº¦æ ‡è®°ç§°ä¸ºè®¸å¯è¯çº§åˆ«ï¼Œå®¢ä½“çš„æ•æ„Ÿåº¦æ ‡è®°ä¸ºå¯†çº§ã€‚ è§„åˆ™ï¼š ä»…å½“ä¸»ä½“çš„è®¸å¯è¯çº§åˆ«å¤§äºæˆ–ç­‰äºå®¢ä½“çš„å¯†çº§ï¼Œå¯è¯»ï¼› ä»…å½“ä¸»é¢˜çš„è®¸å¯è¯çº§åˆ«ç­‰äºå®¢ä½“çš„å¯†çº§ï¼Œå¯å†™ã€‚ åŸå› ï¼šç¦æ­¢äº†æ‹¥æœ‰é«˜è®¸å¯è¯çº§åˆ«çš„ä¸»ä½“æ›´æ–°ä½å¯†åº¦çš„æ•°æ®å¯¹è±¡ï¼Œé€ æˆæ•æ„Ÿæ•°æ®çš„æ³„éœ²ã€‚ æ•°æ®åº“å®Œæ•´æ€§å®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§ã€ç”¨æˆ·è‡ªå®šä¹‰çš„å®Œæ•´æ€§ DBMSä¸ºç»´æŠ¤æ•°æ®åº“çš„å®Œæ•´æ€§ï¼Œå¿…é¡»èƒ½å¤Ÿï¼› 1.æä¾›å®šä¹‰å®Œæ•´æ€§çº¦æŸæ¡ä»¶çš„æœºåˆ¶ 2.æä¾›å®Œæ•´æ€§æ£€æŸ¥çš„æ–¹æ³• 3.è¿çº¦å¤„ç† å®ä½“å®Œæ•´æ€§çš„å®šä¹‰ï¼šåˆ—çº§çº¦æŸæ¡ä»¶ã€è¡¨çº§çº¦æŸæ¡ä»¶ å®ä½“å®Œæ•´æ€§æ£€æŸ¥å’Œè¿çº¦å¤„ç†ï¼šæ£€æŸ¥ä¸»ç å€¼æ˜¯å¦å”¯ä¸€ï¼›æ£€æŸ¥ä¸»ç çš„å„å±æ€§æ˜¯å¦ä¸ºç©º å‚ç…§å®Œæ•´æ€§å®šä¹‰ï¼šFOREIGN KEYï¼Œå¯¹å¤–ç çš„å–å€¼åšä¸€ä¸ªçº¦æŸï¼šç©ºå€¼æˆ–å­˜åœ¨å€¼ã€‚ ç”¨æˆ·è‡ªå®šä¹‰å®Œæ•´æ€§ï¼š1.NOT NULL; 2.UNIQUE; 3.CHECK; å…³ç³»æ•°æ®åº“ç†è®ºå‡½æ•°ä¾èµ–(Functional Dependency,FD)ï¼šå±æ€§é—´ç±»ä¼¼æ•°å­¦ä¸­çš„å‡½æ•°y=f(x)çš„ä¾èµ–å…³ç³»ï¼Œè¢«ç§°ä¸ºå‡½æ•°ä¾èµ–ã€‚è®°ä½œXâ†’Yã€‚ éå¹³å‡¡å‡½æ•°ä¾èµ–ï¼šXâ†’Yï¼Œä½†Yä¸æ˜¯Xçš„å­é›†ã€‚ å¹³å‡¡å‡½æ•°ä¾èµ–ï¼šXâ†’Yï¼ŒYæ˜¯Xçš„å­é›†ã€‚ å®Œå…¨å‡½æ•°ä¾èµ–ï¼šXâ†’Yï¼Œå¹¶ä¸”å¯¹äºXçš„ä»»ä½•ä¸€ä¸ªçœŸå­é›†Xâ€˜ï¼Œéƒ½æœ‰Yä¸å‡½æ•°ä¾èµ–äºXâ€™ã€‚ éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼šXâ†’Yï¼ŒYä¸ å®Œå…¨å‡½æ•°ä¾èµ– äºXã€‚uâ€™s ä¼ é€’å‡½æ•°ä¾èµ–ï¼šXâ†’Y, Yâ†’Z, ä¸”Yä¸â†’Xã€‚ ä¸»å±æ€§(Prime Attribute)ï¼šä»»ä½•å€™é€‰ç ä¸­çš„å±æ€§ã€‚ éä¸»å±æ€§(Nonprime Attribute)ï¼šä¸åŒ…å«åœ¨ä»»ä½•ç ä¸­çš„å±æ€§ã€‚ä¹Ÿç§°éç å±æ€§(Non-key Attribute)ã€‚ ç¬¬ä¸€èŒƒå¼(1NF)ï¼šæ¯ä¸€ä¸ªåˆ†é‡å¿…é¡»æ˜¯ä¸å¯åˆ†çš„æ•°æ®é¡¹ã€‚ ç¬¬äºŒèŒƒå¼(2NF)ï¼š1NFçš„åŸºç¡€ä¸‹ï¼Œæ¯ä¸€ä¸ªéä¸»å±æ€§å®Œå…¨ä¾èµ–äºç  è§„èŒƒåŒ–(normalization)ï¼šä¸€ä¸ªä½ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼ï¼Œé€šè¿‡æ¨¡å¼åˆ†è§£å¯ä»¥è½¬åŒ–ä¸ºè‹¥å¹²ä¸ªé«˜ä¸€çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼çš„é›†åˆã€‚ ç¬¬ä¸‰èŒƒå¼(3NF)ï¼šæ¯ä¸€ä¸ªéä¸»å±æ€§ æ—¢ä¸éƒ¨ä»½ä¾èµ–äºç ï¼Œä¹Ÿä¸ä¼ é€’ä¾èµ–äºç ã€‚ BCNFï¼šå…³ç³»æ¨¡å¼R&lt;U,F&gt;âˆˆ1NFï¼Œè‹¥Xâ†’Yä¸”Yä¸æ˜¯Xå­é›†æ—¶ï¼ŒXå¿…å«æœ‰ç ã€‚å³ï¼Œæ¯ä¸€ä¸ªå†³å®šå› ç´ éƒ½å«æœ‰ç ã€‚ ä¸€ä¸ªæ»¡è¶³BCNFçš„å…³ç³»æ¨¡å¼ï¼š æ‰€æœ‰éä¸»å±æ€§å¯¹äºæ¯ä¸€ä¸ªç éƒ½æ˜¯å®Œå…¨å‡½æ•°ä¾èµ– æ‰€æœ‰çš„ä¸»å±æ€§å¯¹æ¯ä¸€ä¸ªä¸åŒ…å«å®ƒçš„ç ï¼Œä¹Ÿæ˜¯å®Œå…¨å‡½æ•°ä¾èµ– æ²¡æœ‰ä»»ä½•å±æ€§å®Œå…¨å‡½æ•°ä¾èµ–äºé£é©¬çš„ä»»ä½•ä¸€ç»„å±æ€§ BCNFä¿®æ­£äº†3NFä¸»å±æ€§å†…éƒ¨éƒ¨åˆ†å‡½æ•°ä¾èµ– å¤šå€¼ä¾èµ–(Multivalued Dependency,MVD) æ¨¡å¼åˆ†è§£ åˆ†è§£å…·æœ‰æ— æŸè¿æ¥æ€§(Lossless Join)â€”â€”é€šè¿‡è‡ªç„¶è¿ç®—å¯å¤åŸ åˆ†è§£è¦â€œä¿æŒå‡½æ•°ä¾èµ–â€(Preserve functional dependenct) åˆ†è§£æ—¢è¦ä¿æŒå‡½æ•°ä¾èµ–ï¼Œåˆè¦å…·æœ‰æ— æŸè¿æ¥æ€§ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”19åˆ†é’Ÿä¸¤ç±»è€ƒé¢˜â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ å…³ç³»æŸ¥è¯¢å¤„ç†å’ŒæŸ¥è¯¢ä¼˜åŒ–DBMSæŸ¥è¯¢å¤„ç†åˆ†ä¸º4ä¸ªé˜¶æ®µï¼šæŸ¥è¯¢åˆ†æã€æŸ¥è¯¢æ£€æŸ¥ã€æŸ¥è¯¢ä¼˜åŒ–ã€æŸ¥è¯¢æ‰§è¡Œã€‚ è®¡ç®—é¢˜ï¼šP268 æ•°æ®åº“è®¾è®¡æ•°æ®åº“è®¾è®¡é‡ç‚¹ï¼š æ¦‚å¿µè®¾è®¡-&gt;é€»è¾‘è®¾è®¡ ï¼Œ æ¯ä¸€é˜¶æ®µç›®çš„æ˜¯ä»€ä¹ˆã€‚ æ•°æ®åº“è®¾è®¡æ–¹æ³•ï¼šæ–°å¥¥å°”è‰¯æ–¹æ³•ã€åŸºäºE-Ræ¨¡å‹çš„æ•°æ®åº“è®¾è®¡æ–¹æ³•ã€3NFçš„è®¾è®¡æ–¹æ³•ã€ODLæ–¹æ³•ã€UMLæ–¹æ³• æ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤ï¼š å‡†å¤‡å·¥ä½œï¼š1.ç³»ç»Ÿåˆ†æäººå‘˜ã€æ•°æ®åº“è®¾è®¡äººå‘˜ï¼›2.ç”¨æˆ·ä»£è¡¨å’Œæ•°æ®åº“ç®¡ç†å‘˜ï¼›3.åº”ç”¨å¼€å‘äººå‘˜ éœ€æ±‚åˆ†æ éœ€æ±‚åˆ†æä»»åŠ¡ï¼šä¿¡æ¯è¦æ±‚ã€å¤„ç†è¦æ±‚ã€å®‰å…¨æ€§ä¸å®Œæ•´æ€§è¦æ±‚ éœ€æ±‚åˆ†ææ–¹æ³•ï¼šè·Ÿç­ä½œä¸šã€å¼€è°ƒæŸ¥ä¼šã€è¯·ä¸“äººä»‹ç»ã€è¯¢é—®ã€è®¾è®¡è°ƒæŸ¥è¡¨ã€æŸ¥é˜…è®°å½• æ•°æ®å­—å…¸ï¼šæœºå‹è¯¦ç»†çš„æ•°æ®æ”¶é›†å’Œæ•°æ®åˆ†ææ‰€è·å¾—çš„ä¸»è¦ç»“æœ æ•°æ®é¡¹ï¼šä¸å¯å†åˆ†çš„æ•°æ®å•ä½ æ•°æ®ç»“æ„ï¼šåæ˜ æ•°æ®ä¹‹é—´çš„ç»„åˆå…³ç³» æ•°æ®æµï¼šæ•°æ®ç»“æ„åœ¨ç³»ç»Ÿå†…ä¼ è¾“çš„è·¯å¾„ æ•°æ®å­˜å‚¨ï¼šæ•°æ®ç»“æ„åœç•™æˆ–ä¿å­˜çš„åœ°æ–¹ å¤„ç†è¿‡ç¨‹ï¼šå¤„ç†è¿‡ç¨‹çš„å…·ä½“å¤„ç†é€»è¾‘ä¸€èˆ¬ç”¨åˆ¤å®šè¡¨æˆ–åˆ¤å®šä¹¦æ¥æè¿° å°ç»“ï¼šå……åˆ†è€ƒè™‘å¯èƒ½çš„æ‰©å……å’Œæ”¹å˜ï¼Œä½¿è®¾è®¡æ˜“äºæ›´æ”¹ï¼Œç³»ç»Ÿæ˜“äºæ‰©å……ï¼›å¼ºè°ƒç”¨æˆ·å‚ä¸ã€‚ æ¦‚å¿µç»“æ„è®¾è®¡ ç‰¹ç‚¹ï¼š èƒ½çœŸå®å……åˆ†åæ˜ ç°å®ä¸–ç•Œ æ˜“äºç†è§£ æ˜“äºæ›´æ”¹ æ˜“äºå‘å…³ç³»ã€ç½‘çŠ¶ã€å±‚æ¬¡ç­‰æ•°æ®æ¨¡å‹è½¬ å››ç±»æ–¹æ³•ï¼š(å¸¸ç”¨ï¼šè‡ªé¡¶å‘ä¸‹éœ€æ±‚åˆ†æï¼Œè‡ªåº•å‘ä¸Šè®¾è®¡æ¦‚å¿µç»“æ„) è‡ªé¡¶å‘ä¸‹ è‡ªåº•å‘ä¸Š é€æ­¥æ‰©å¼  æ··åˆç­–ç•¥ è§†å›¾çš„é›†æˆï¼šå¤šä¸ªE-Rä¸€æ¬¡ç»§æ‰¿(éš¾åº¦è¾ƒå¤§)ï¼›é€æ­¥ç»§æ‰¿ åˆå¹¶å†²çªï¼š å±æ€§å†²çªï¼šå±æ€§å€¼çš„ç±»å‹ã€å–å€¼èŒƒå›´ã€å–å€¼é›†åˆã€å•ä½ä¸åŒã€‚ å‘½åå†²çªï¼šåŒåå¼‚ä¹‰ï¼Œå¼‚ååŒä¹‰ã€‚ ç»“æ„å†²çªï¼š åŒä¸€å¯¹è±¡åœ¨ä¸åŒåº”ç”¨ä¸­å…·æœ‰ä¸åŒçš„æŠ½è±¡ï¼Œå¦‚èŒå·¥åœ¨æŸä¸€å±€éƒ¨åº”ç”¨ä¸­ä¸ºå®ä½“ï¼Œå¦ä¸€ä¸ºå±æ€§ åŒä¸€å®ä½“åœ¨ä¸åŒE-Rå›¾ä¸­æ‰€åŒ…å«çš„å±æ€§ä¸ªæ•°å’Œå±æ€§æ’åˆ—æ¬¡åºä¸å®Œå…¨ç›¸åŒ å®ä½“é—´çš„è”ç³»åœ¨ä¸åŒçš„åˆ†E-Rå›¾ä¸­ä¸ºä¸åŒçš„ç±»å‹ é€»è¾‘ç»“æ„è®¾è®¡ ç‰©ç†ç»“æ„è®¾è®¡ æ•°æ®åº“å®æ–½ æ•°æ®åº“è¿è¡Œä¸ç»´æŠ¤","link":"/2019/07/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA/"},{"title":"[NOTE] æœåŠ¡å™¨ä½¿ç”¨æœ¬æœº(PC)ä»£ç†","text":"åœ¨ä½¿ç”¨å®éªŒå®¤æœåŠ¡å™¨è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶ä¸å¾—ä¸ä»å¤–ç½‘ä¸Šæ‹‰å–ç›¸å…³ä»“åº“ï¼Œè¯¸å¦‚git cloneå¥‡æ…¢æ— æ¯”ï¼Œè¿˜æ€»æ˜¯å¤±è´¥ï¼Œæœ¬æƒ³ç€è¿‡æ®µæ—¶é—´ç”³è¯·ä¸€ä¸ªac86uä¹‹ç±»çš„ï¼Œæ”¹æˆè·¯ç”±å™¨ä»£ç†ï¼Œçªç„¶æƒ³åˆ°æœ¬æœºå…¶å®ä¹Ÿå¯ä»¥æš‚ä»£è¿™ä¸ªåŠŸèƒ½çš„ã€‚ For Winä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç½‘ä¸Šå¤§æ¦‚æœ‰ä¸‰ç§æ–¹æ³•ï¼š 1.ä¿®æ”¹hostsï¼Œç›´æ¥æŒ‡å‘github.comï¼Œä½†å®æµ‹æ•ˆæœå¾ˆå·®ï¼› 2.ç äº‘ä¸­è½¬ï¼Œå¤ªéº»çƒ¦äº†ï¼Œè€Œä¸”ç¢°ä¸Šçº§è”ä¾èµ–çš„å°±å¾ˆå¤´å¤§ï¼› 3.ssrå±€åŸŸç½‘å¼€æ”¾ç«¯å£ä»£ç†ï¼Œç”±äºå±€åŸŸç½‘ä¸­æœ¬æœºipä¸º192.168.1.205ï¼Œå°†ä»£ç†æœåŠ¡æŒ‚åˆ°1080ç«¯å£ï¼Œå¦‚ä¸‹ git config --global http.proxy 192.168.1.205:1080 git config --global https.proxy 192.168.1.205:1080 å½“ç„¶ï¼Œè¿™æ ·ä¸€é…ç½®ï¼Œæ‰€æœ‰çš„gitæ“ä½œéƒ½è¦ç»è¿‡ä»£ç†ï¼Œæ‰€ä»¥è¿˜æ˜¯è°ƒæ•´ä¸€ä¸‹ï¼š 1234567# remove the config setting beforegit config --global --unset http.proxygit config --global --unset https.proxy# only for githubgit config --global http.https://github.com.proxy 192.168.1.205:1080git config --global https.https://github.com.proxy 192.168.1.205:1080 For Mac1export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7891","link":"/2019/07/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA-PC-%E4%BB%A3%E7%90%86/"},{"title":"[Tips] ç»ˆç«¯10Xå·¥ä½œæ³•","text":"æ­¤ç¯‡æ–‡ç« è½¬è½½legendtklçš„åšå®¢ç»ˆç«¯10Xå·¥ä½œæ³•ï¼Œæˆ‘ä¸€ç›´å¾ˆå–œæ¬¢terminalä½¿ç”¨ä¸­å¸¦æ¥çš„ä¸€äº›å°tricksï¼Œè¿™ç¯‡æ–‡ç« åˆšå¥½åˆ—ä¸¾äº†ä¸€äº›ä»£è¡¨æ€§çš„ï¼Œä¹‹åæˆ‘ä¼šåœ¨è¿™ç¯‡æ–‡ç« çš„åŸºç¡€ä¸Šï¼Œå°†æˆ‘æ¯”è¾ƒå¸¸ç”¨çš„è®°å½•å¹¶æ”¾åˆ°é¡¶éƒ¨ï¼Œä¹Ÿç®—æ˜¯æ–¹ä¾¿æŸ¥æ‰¾ã€‚ å¦å¤–ä¹Ÿéå¸¸æ„Ÿè°¢legendtklçš„æ–‡ç« åˆæŠ±ä¹‹æœ¨ï¼Œç”Ÿäºæ¯«æœ«ï¼Œä¹Ÿç®—æ˜¯æˆ‘å¼€å§‹å†™åšå®¢çš„åŸå› ä¹‹ä¸€ã€‚ ä»¥ä¸‹ä¸ºæ­£æ–‡å†…å®¹ã€‚ åœ¨ github ä¸Šé¢æœ‰ä¸€ä¸ª 700 å¤šäºº star çš„ repo å«åš Bash-Onelinerï¼Œä»‹ç»äº†å¾ˆå¤šå®ç”¨å¹¶ä¸”å¯ä»¥æœ‰æ•ˆæé«˜å·¥ä½œæ•ˆç‡çš„å‘½ä»¤ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ã€‚åŸæ–‡ç›´è¾¾ï¼šBash-Oneliner ã€‚æ³¨ï¼šå»é™¤äº†éƒ¨åˆ†çœ‹ä¸Šå»æ²¡å•¥ç”¨çš„å‘½ä»¤ï¼Œå¯ä»¥åŸæ–‡æŸ¥çœ‹æ‰€æœ‰å†…å®¹ã€‚ 1. Terminalæ³¨ï¼šä¸‹é¢ä»‹ç»çš„æ˜¯åœ¨ Linux ä¸‹çš„ terminal çš„è¡Œä¸ºï¼Œåœ¨ Mac ä¸‹é¢ä¼šç•¥æœ‰å·®å¼‚ï¼Œå°½é‡è¡¥å…¨ Ctrl ç›¸å…³12345678910111213141516Ctrl + n : ç±»ä¼¼å‘ä¸‹æ–¹å‘é”®Ctrl + p : ç±»ä¼¼å‘ä¸Šæ–¹å‘é”®Ctrl + r : åå‘æœç´¢ terminal çš„å†å²å‘½ä»¤Ctrl + s : åœæ­¢è¯¥ terminalCtrl + q : åœ¨ Ctrl + s åé¢é‡æ–°æ¢å¤è¯¥ terminalCtrl + a : ç§»åŠ¨å…‰æ ‡åˆ°è¡Œçš„å¼€å§‹å¤„ã€‚(è¿™ä¸ªå¾ˆæœ‰ç”¨)Ctrl + e : ç§»åŠ¨å…‰æ ‡åˆ°è¡Œçš„ç»“å°¾å¤„ã€‚(åŒä¸Š)Ctrl + d : å¦‚æœå½“å‰çš„ terminal çš„å‘½ä»¤è¡Œæœ‰è¾“å…¥ï¼Œé‚£ä¹ˆ Ctrl + d ä¼šåˆ é™¤å…‰æ ‡å¤„çš„æ•°å­—ã€‚å¦åˆ™ä¼šé€€å‡ºå½“å‰çš„ terminalCtrl + k : åˆ é™¤ä»å½“å‰å…‰æ ‡å¼€å§‹åˆ°ç»“å°¾çš„æ‰€æœ‰çš„å­—ç¬¦Ctrl + x + backspace: åˆ é™¤ä»å½“å‰å…‰æ ‡åˆ°è¡Œå¼€å§‹çš„æ‰€æœ‰çš„å­—ç¬¦Ctrl + t : äº¤æ¢å½“å‰å…‰æ ‡ä¸‹çš„å­—ç¬¦å’Œå…¶å‰é¢çš„å­—ç¬¦çš„ä½ç½®ã€‚Esc + t äº¤æ¢å…‰æ ‡å‰é¢çš„ä¸¤ä¸ªå•è¯ã€‚(è¿™ä¸ªå¾ˆæœ‰æ„æ€)Ctrl + w : å‰ªåˆ‡å…‰æ ‡ä¹‹å‰çš„å•è¯ã€‚Ctrl + y ç²˜è´´è¯¥å•è¯Ctrl + u : å‰ªåˆ‡å…‰æ ‡ä¹‹å‰çš„æ‰€æœ‰å­—ç¬¦ã€‚Ctrl + y ç²˜è´´åˆšåˆšå‰ªåˆ‡çš„å­—ç¬¦Ctrl + _ : æ’¤é”€å‰é¢çš„æ“ä½œã€‚(å¯ä»¥è¿ç»­æ“ä½œå¤šæ¬¡)Ctrl + l : ç±»ä¼¼ clearã€‚(ç±»ä¼¼ Mac ç»ˆç«¯ä¸‹çš„ Command + k)Ctrl + x + Ctrl + e : å”¤èµ· $EDITOR ç¯å¢ƒå˜é‡è®¾ç½®çš„ç¼–è¾‘å™¨ç¨‹åºï¼Œåœ¨éœ€è¦è¾“å…¥å¤šè¡Œçš„æƒ…å†µä¸‹æ¯”è¾ƒæœ‰ç”¨ã€‚(è¯•éªŒäº†ä¸€ä¸‹å¦‚æœä¹‹å‰æ²¡æœ‰è®¾ç½®ï¼Œ$EDITOR çš„é»˜è®¤å€¼æ˜¯ emacsã€‚ä½ å¯ä»¥å°†å…¶è®¾ç½®ä¸º vimï¼Œå³ export EDITOR=vimã€‚å½“ç„¶ä¹Ÿå¯ä»¥å°†è¿™ä¸ªç¯å¢ƒå˜é‡è®¾ç½®ä¸ºå…¶ä»–çš„åº”ç”¨ç¨‹åºå»å®ç°ä¸€äº›æœ‰è¶£çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæµ‹è¯•è¿‡äº†) æ”¹å˜å­—ç¬¦å¤§å°å†™123Esc + u : å°†å½“å‰å…‰æ ‡å¼€å§‹åˆ°å•è¯ç»“å°¾çš„å­—ç¬¦éƒ½è½¬æ¢æˆå¤§å†™ã€‚(è¿™é‡Œçš„å•è¯æŒ‡çš„æ˜¯å…‰æ ‡æ‰€åœ¨çš„ä½ç½®å‰åä»¥ç©ºæ ¼åˆ†éš”å½¢æˆçš„å•è¯)Esc + l : å°†å½“å‰å…‰æ ‡å¼€å§‹åˆ°å•è¯ç»“å°¾çš„å­—ç¬¦éƒ½è½¬æ¢æˆå°å†™Esc + c : å°†å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦è½¬æ¢æˆå¤§å†™ æ‰§è¡Œå†å²å‘½ä»¤12!53 : æ‰§è¡Œ history ä¸­çš„ 53 å·å‘½ä»¤!! : æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤ æ›¿æ¢ä¸Šä¸€æ¡å‘½ä»¤ï¼Œå¹¶æ›¿æ¢ä¸€äº›å‚æ•°12345678# ä¸Šä¸€æ¡å‘½ä»¤ï¼šecho 'aaa'^aaa^bbb# æ­¤æ—¶å°†ä¸Šä¸€æ¡å‘½ä»¤æ›¿æ¢ä¸º echo 'bbb'ï¼Œè¾“å‡º bbb# éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ ·åªä¼šæ›¿æ¢ç¬¬ä¸€æ¬¡ aaaï¼Œå¦‚æœè¦æ›¿æ¢æ‰€æœ‰çš„ aaaï¼Œéœ€è¦åƒä¸‹é¢è¿™æ ·ä½¿ç”¨^aaa^bbb^:&amp;# æˆ–è€…!!:gs/aaa/bbb/ å‰ç¼€åŒ¹é…æ‰§è¡Œå†å²å‘½ä»¤1234!cat# æˆ–è€…!c# æ‰§è¡Œå†å²å‘½ä»¤ä¸­æœ€è¿‘ä¸€æ¡æ»¡è¶³å‰ç¼€æ˜¯ c æˆ–è€… cat çš„å‘½ä»¤ æ–‡ä»¶åä½¿ç”¨æ­£åˆ™1234567891011# ? è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„ä»»æ„å­—ç¬¦/b?n/?at # åŒ¹é…ä¸Š /bin/cat# * è¡¨ç¤ºå¤šä¸ªä»»æ„å­—ç¬¦/etc/pa*wd # åŒ¹é…ä¸Š /etc/passwd# '[]' è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦èŒƒå›´ls -al [a-z]* # åˆ—å‡ºæ‰€æœ‰ä»¥å­—æ¯å¼€å¤´çš„æ–‡ä»¶# '{}' æ–‡ä»¶ååŒ¹é…å¤šç§æ¨¡å¼ls {*.sh,*.py} # åˆ—å‡ºæ‰€æœ‰çš„ .sh å’Œ .py æ–‡ä»¶ ç¯å¢ƒå˜é‡123456789101112131415$0, $1, $2, $3, ... ï¼š åœ¨æ‰§è¡Œ shell çš„æ—¶å€™ä¼ å‚ä½¿ç”¨ï¼Œ$0 è¡¨ç¤º shell åå­—ï¼Œ$1,$2,$3ä¾æ¬¡è¡¨ç¤ºåé¢çš„å‚æ•°$# : å‚æ•°çš„ä¸ªæ•°$? : æœ€è¿‘çš„ä¸€ä¸ªç»ˆç«¯ foreground å‘½ä»¤çš„é€€å‡ºçŠ¶æ€$- : å½“å‰ shell è®¾ç½®çš„é€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡ echo $- æŸ¥çœ‹$$ : å½“å‰ shell è¿›ç¨‹çš„ pid$! : æœ€è¿‘çš„ä¸€ä¸ªç»ˆç«¯åå°å‘½ä»¤çš„ pid$DESKTOP_SESSION : å½“å‰çš„å±•ç¤ºç®¡ç†å™¨ã€‚(å¯èƒ½è¯´çš„æ˜¯ xWindow)$EDITOR : ç¼–è¾‘å™¨ï¼Œå¯ä»¥é€šè¿‡ä¸Šé¢æåˆ°çš„å¿«æ·é”®å”¤é†’$LANG : è¯­è¨€è®¾ç½®$PATH : è¿™ä¸ªä¸ç”¨è¯´äº†$PWD : å½“å‰ç›®å½•$SHELL : å½“å‰çš„ shell$USER : å½“å‰çš„ username$HOSTNAME : å½“å‰çš„ hostname 2. Grepgrep çš„ç§ç±»12345grep = grep -G # æ”¯æŒåŸºæœ¬çš„æ­£åˆ™è¡¨è¾¾å¼fgrep = grep -F # æŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²egrep = grep -E # æ”¯æŒæ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼pgrep = grep -P # å…¼å®¹ Perl çš„æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•rgrep = grep -r # é€’å½’ grep ç»Ÿè®¡ç©ºè¡Œä¸ªæ•°1grep -c &quot;^$&quot; grep å¹¶ä¸”åªè¿”å›æ•°å­—123grep -o '[0-9]*'#æˆ–è€…grep -oP '\\d' grep å«æœ‰ç‰¹å®šæ•°å­—çš„æ•°å­—12345grep â€˜[0-9]\\{3\\}â€™# orgrep -E â€˜[0-9]{3}â€™# orgrep -P â€˜\\d{3}â€™ æŸ¥æ‰¾ IP åœ°å€123grep -Eo '[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}'# orgrep -Po '\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}' æŸ¥æ‰¾å•è¯12345678# return also 3 lines after matchgrep -A 3 'bbo'# return also 3 lines before matchgrep -B 3 'bbo'# return also 3 lines before and after matchgrep -C 3 'bbo' æŸ¥æ‰¾ç‰¹å®šå­—ç¬¦å¼€å¤´çš„å•è¯1grep -o 'S.*' æå–ä¸¤ä¸ªç‰¹å®šå•è¯ä¹‹é—´çš„æ–‡æœ¬1grep -o -P '(?&lt;=w1).*(?=w2)' æŸ¥æ‰¾ä¸åŒ…å«æŸä¸ªå•è¯çš„æ–‡ä»¶å†…å®¹1grep -v bbo filename æŸ¥æ‰¾ä¸æ˜¯ä»¥ç‰¹å®šå­—ç¬¦å¼€å¤´çš„æ–‡ä»¶å†…å®¹1grep -v '^#' file.txt æŸ¥æ‰¾å«æœ‰ç©ºæ ¼çš„å†…å®¹12bbo=&quot;some strings&quot;grep &quot;$boo&quot; filename æŸ¥æ‰¾ç¬¬ä¸€ä¸ª match æ–‡ä»¶å†…å®¹1grep -m 1 bbo filename æŸ¥æ‰¾å¹¶è¿”å›æ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶å†…å®¹æ¡æ•°1grep -c bbo filename ç»Ÿè®¡å•è¯åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°1grep -o bbo filename |wc -l å¤§å°å†™æ•æ„Ÿçš„æŸ¥æ‰¾1grep -i &quot;bbo&quot; filename åŒ¹é…ç»“æœç€è‰²1grep --color bbo filename æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶123grep -R bbo /path/to/directory# orgrep -r bbo /path/to/directory æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸è¾“å‡ºæ–‡ä»¶å†…å®¹1grep -rh bbo /path/to/directory æŸ¥æ‰¾ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œåªè¾“å‡ºåŒ¹é…çš„æ–‡ä»¶å1grep -rl bbo /path/to/directory OR æŸ¥æ‰¾1grep 'A\\|B\\|C\\|D' AND æŸ¥æ‰¾ï¼ˆæ¯”å¦‚ A and Bï¼‰1grep 'A.*B' æ­£åˆ™æŸ¥æ‰¾ï¼ˆæ¯”å¦‚ ACB æˆ–è€… AEBï¼‰1grep 'A.B' æŸ¥æ‰¾ç‰¹å®šå­—ç¬¦ï¼ˆæ¯”å¦‚ color æˆ–è€… colourï¼‰1grep â€˜colou?râ€™ æŸ¥æ‰¾å¤šä¸ªæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹1grep -f fileA fileB æŸ¥æ‰¾ tab1grep $'\\t' ä»å˜é‡ä¸­æŸ¥æ‰¾1234$echo &quot;$long_str&quot;|grep -q &quot;$short_str&quot;if [ $? -eq 0 ]; then echo 'found'; fi#grep -q will output 0 if match found#remember to add space between []! æŸ¥æ‰¾æ‹¬å·ä¸­é—´çš„å­—ç¬¦ä¸²1grep -oP '\\(\\K[^\\)]+' ç•¥è¿‡ç›®å½•æŸ¥æ‰¾1grep -d skip 'bbo' /path/to/files/* 3. Sedç§»é™¤æ–‡ä»¶ç¬¬ä¸€è¡Œ1sed 1d filename ç§»é™¤æ–‡ä»¶çš„å‰ 100 è¡Œ1sed 1,100d filename ç§»é™¤åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„æ–‡ä»¶è¡Œæ³¨ï¼šè¿™ç§æ–¹å¼å¹¶ä¸ä¼šä¿®æ”¹åŸæ–‡ä»¶ï¼Œå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°æ–°çš„æ–‡ä»¶ä¿å­˜ 123sed &quot;/bbo/d&quot; filename# case insensitive:sed &quot;/bbo/Id&quot; filename ç§»é™¤æ–‡ä»¶ä¸æ»¡è¶³ç¬¬ n ä¸ªå­—ç¬¦ä¸²ä¸ç­‰äºæŸä¸ªå€¼çš„è¡Œ1234# ç¬¬ 5 ä¸ªå­—ç¬¦ä¸ç­‰äº 2sed -E '/^.{5}[^2]/d'#aaaa2aaa (you can stay)#aaaa1aaa (delete!) ä¿®æ”¹åŸæ–‡ä»¶12# åˆ é™¤åŒ…å« bbo çš„è¡Œå¹¶ç›´æ¥ä¿å­˜æ–‡ä»¶sed -i &quot;/bbo/d&quot; filename ä½¿ç”¨å˜é‡çš„æ—¶å€™ä½¿ç”¨åŒå¼•å·1234# e.g. add &gt;$i to the first line (to make a bioinformatics FASTA file)sed &quot;1i &gt;$i&quot;# notice the double quotes! in other examples, you can use a single quote, but here, no way!# '1i' means insert to first line åˆ é™¤ç©ºè¡Œ12345sed '/^\\s*$/d'# orsed '/^$/d' åˆ é™¤æœ€åä¸€è¡Œ1sed '$d' åˆ é™¤æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—ç¬¦1sed -i '$ s/.$//' filename å‘æ–‡ä»¶å¼€å¤´æ’å…¥å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚ â€œ[â€œï¼‰1sed -i '1s/^/[/' file å‘æ–‡ä»¶ä¸­ç‰¹å®šè¡Œä¸­æ’å…¥å­—ç¬¦ä¸²1sed -e '1isomething' -e '3isomething' å‘æ–‡ä»¶ç»“å°¾æ’å…¥å­—ç¬¦ï¼ˆæ¯”å¦‚ â€œ]â€ï¼‰1sed '$s/$/]/' filename å‘æ–‡ä»¶ç»“å°¾æ’å…¥æ–°è¡Œ1sed '$a\\' å‘æ–‡ä»¶çš„æ¯ä¸€è¡Œæ’å…¥æ•°æ®1sed -e 's/^/bbo/' file å‘æ–‡ä»¶çš„æ¯ä¸€è¡Œç»“å°¾æ’å…¥æ•°æ®1sed -e 's/$/\\}\\]/' filename æ¯ n ä¸ªå­—ç¬¦æ’å…¥æ¢è¡Œç¬¦ï¼ˆæ¯”å¦‚æ¯ 4 ä¸ªå­—ç¬¦ï¼‰1sed 's/.\\{4\\}/&amp;\\n/g' è¿æ¥å¤šä¸ªæ–‡ä»¶1sed -s '$a,' *.json &gt; all.json å†…å®¹æ›¿æ¢1sed 's/A/B/g' filename åŸºäºæ­£åˆ™çš„æ–‡ä»¶å†…å®¹æ›¿æ¢1sed &quot;s/aaa=.*/aaa=\\/my\\/new\\/path/g&quot; ç­›é€‰æ–‡ä»¶ä¸­ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å§‹è¡Œ1sed -n '/^@S/p' ####æ‰“å°æ–‡ä»¶ä¸­çš„å¤šè¡Œ 1sed -n 500,5000p filename æ‰“å°æ–‡ä»¶ä¸­ç‰¹å®šè¡Œ123sed -n '0~3p' filename# æ‰“å° 3 çš„å€æ•°è¡Œ æ‰“å°å¥‡æ•°è¡Œ1sed -n '1~2p' filename åˆ é™¤æ–‡ä»¶å¼€å¤´çš„ç©ºæ ¼å’Œ tab12sed -e 's/^[ \\t]*//'# Notice a whitespace before '\\t'!! åªåˆ é™¤ç©ºæ ¼123sed 's/ *//'# notice a whitespace before '*'!! ç§»é™¤æ–‡ä»¶ç»“å°¾çš„é€—å·1sed 's/,$//g' æ–‡ä»¶ç»“å°¾æ·»åŠ ä¸€åˆ—ï¼ˆä»¥ tab åˆ†éš”ï¼‰12345sed &quot;s/$/\\t$i/&quot;# $i is the valuable you want to add# To add the filename to every last column of the filefor i in $(ls);do sed -i &quot;s/$/\\t$i/&quot; $i;done æ‰“å°ç‰¹å®šçš„è¡Œ1sed -n -e '123p' åˆ é™¤æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—ç¬¦1sed '$ s/.$//' æŒ‡å®šä½ç½®æ’å…¥å­—ç¬¦1sed -r -e 's/^.{3}/&amp;#/' file 4. Awkè®¾ç½® tab ä¸ºåˆ†éš”ç¬¦1awk -F $'\\t' è®¾ç½® tab ä¸ºè¾“å‡ºå†…å®¹çš„åˆ†éš”ç¬¦1awk -v OFS='\\t' ä¼ é€’å‚æ•°12a=bbo;b=obb;awk -v a=&quot;$a&quot; -v b=&quot;$b&quot; &quot;$1==a &amp;&amp; $10=b&quot; filename è¾“å‡ºæ–‡ä»¶è¡Œå·ä»¥åŠæ¯è¡Œçš„å­—ç¬¦ä¸ªæ•°1awk '{print NR,length($0);}' filename è¾“å‡º column/field çš„ä¸ªæ•°1awk '{print NF}' åˆ¤æ–­æ˜¯ä¸æ˜¯æœ‰é€—å·1awk '$1~/,/ {print}' è¾“å‡ºå­—ç¬¦ä¸²å‡ºç° n æ¬¡ä¹‹å‰çš„æ‰€æœ‰è¡Œ1awk -v N=7 '{print}/bbo/&amp;&amp; --N&lt;=0 {exit}' è¾“å‡ºæ–‡ä»¶åå’Œå…¶æœ€åä¸€è¡Œ1ls|xargs -n1 -I file awk '{s=$0};END{print FILENAME,s}' file å‘æŒ‡å®šçš„ column æ’å…¥å­—ç¬¦ä¸²1awk 'BEGIN{OFS=&quot;\\t&quot;}$3=&quot;chr&quot;$3' ç§»é™¤åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„è¡Œ1awk '!/bbo/' file ç§»é™¤æœ€åä¸€ä¸ª column1awk 'NF{NF-=1};1' file ç†è§£ NR å’Œ FNR çš„ä½œç”¨1234567891011121314# For example there are two files:# fileA:# a# b# c# fileB:# d# eawk 'print FILENAME, NR,FNR,$0}' fileA fileB# fileA 1 1 a# fileA 2 2 b# fileA 3 3 c# fileB 4 1 d# fileB 5 2 e 5. Xargsè®¾ç½® tab ä¸ºåˆ†éš”ç¬¦1xargs -d\\t æ¯è¡Œæ˜¾ç¤ºä¸‰ä¸ªå…ƒç´ 123echo 1 2 3 4 5 6| xargs -n 3# 1 2 3# 4 5 6 æ‰§è¡Œä¹‹å‰å…ˆè¯¢é—®123$ echo a b c |xargs -p -n 3$ echo a b c ?... #è¾“å…¥ y$ a b c find æ–‡ä»¶å¹¶åˆ é™¤1find . -name &quot;*.html&quot;|xargs rm åˆ é™¤æ–‡ä»¶åä¸­å«æœ‰ç©ºæ ¼çš„æ–‡ä»¶1find . -name &quot;*.c&quot; -print0|xargs -0 rm -rf æ˜¾ç¤º limits1xargs --show-limits ç§»åŠ¨æ–‡ä»¶123456find . -name &quot;*.bak&quot; -print 0|xargs -0 -I {} mv {} ~/old# orfind . -name &quot;*.bak&quot; -print 0|xargs -0 -I file mv file ~/oldls |head -100|xargs -I {} mv {} d1 å¹¶å‘æ‰§è¡Œ1234time echo {1..5} |xargs -n 1 -P 5 sleep# a lot faster than:time echo {1..5} |xargs -n1 sleep åŸºäºæ¡ä»¶çš„æ–‡ä»¶æ‹·è´1234find /dir/to/A -type f -name &quot;*.py&quot; -print 0| xargs -0 -r -I file cp -v -p file --target-directory=/path/to/B# v: verbose|# p: keep detail (e.g. owner) å’Œ sed é…åˆä½¿ç”¨1ls |xargs -n1 -I file sed -i '/^Pos/d' filename å°†æ–‡ä»¶ååŠ å…¥åˆ°æ–‡ä»¶çš„ç¬¬ä¸€è¡Œ1ls |sed 's/.txt//g'|xargs -n1 -I file sed -i -e '1 i\\&gt;file\\' file.txt ç»Ÿè®¡1ls |xargs -n1 wc -l å°†è¾“å‡ºæ•´åˆåˆ°ä¸€è¡Œ1ls -l| xargs ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹é¢å„ä¸ªæ–‡ä»¶çš„è¡Œæ•°å’Œæ€»çš„è¡Œæ•°1ls|xargs wc -l å’Œ grep è”åˆä½¿ç”¨1cat grep_list |xargs -I{} grep {} filename å’Œ sed è”åˆä½¿ç”¨1grep -rl '192.168.1.111' /etc | xargs sed -i 's/192.168.1.111/192.168.2.111/g' 6. Findé€’å½’åˆ—å‡ºæ‰€æœ‰çš„å­ç›®å½•å’Œæ–‡ä»¶1find . åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶1find . -type f åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•1find . -type d ä¿®æ”¹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆå°† â€˜wwwâ€™ æ›¿æ¢æˆ â€˜wâ€™ï¼‰12345find . -name '*.php' -exec sed -i 's/www/w/g' {} \\;# if there are no subdirectoryreplace &quot;www&quot; &quot;w&quot; -- *# a space before * åˆ é™¤å¤§å°å°äº 74 byte çš„æ–‡ä»¶123find . -name &quot;*.mso&quot; -size -74c -delete# M for MB, etc","link":"/2020/01/02/%E7%BB%88%E7%AB%AF10X%E5%B7%A5%E4%BD%9C%E6%B3%95/"},{"title":"[Golang] æœ‰é™çŠ¶æ€æœºFSM","text":"æœ‰é™çŠ¶æ€æœº(Finite State Machine)æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ¨¡å‹ï¼Œç†è®ºä¸Šåªè¦ä½ è€ƒè™‘çš„çŠ¶æ€è¶³å¤Ÿå¤šï¼Œå°±å¯ä»¥æ¨¡æ‹Ÿä¸–ç•Œä¸Šå¤§éƒ¨åˆ†äº‹ç‰©ã€‚ 1.æœ‰é™çŠ¶æ€æœºç®€å•æè¿°æœ‰é™çŠ¶æ€æœºï¼Œå®ƒæœ‰ä¸‰ä¸ªç‰¹å¾ï¼š çŠ¶æ€æ€»æ•°stateæ˜¯æœ‰é™çš„ä»»ä¸€æ—¶åˆ»ï¼Œåªå¤„åœ¨ä¸€ç§çŠ¶æ€ä¹‹ä¸­æŸç§æ¡ä»¶ä¹‹ä¸‹ï¼Œä¼šä»ä¸€ç§çŠ¶æ€è½¬å˜åˆ°å¦ä¸€ç§çŠ¶æ€ è½¬å˜(transition)é€šå¸¸éƒ½æ˜¯æ»¡è¶³æŸä¸ªæ¡ä»¶æˆ–æ˜¯äº‹ä»¶è§¦å‘ï¼Œæ‰§è¡ŒåŠ¨ä½œï¼Œå®ç°çŠ¶æ€çš„è¿ç§»(ä¹Ÿå¯ä»¥æ˜¯ä¿æŒåŸçŠ¶æ€)ã€‚è€Œâ€œåŠ¨ä½œâ€æ˜¯ä¸ç¨³å®šçš„ï¼ŒåŠ¨ä½œçš„è§¦å‘å¾€å¾€æ˜¯æš‚æ—¶çš„ï¼Œä½¿ç”¨çŠ¶æ€çš„æ˜¯ä¸ºäº†ä½¿äº‹åŠ¡çš„è¾¹ç•Œæ›´æ¸…æ™°ï¼Œé€»è¾‘æ›´åŠ åˆ†æ˜ï¼ŒåŒæ—¶ä¿è¯ç¨³å®šï¼Œåœ¨æ²¡æœ‰å¤–éƒ¨æ¡ä»¶è§¦å‘çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªçŠ¶æ€ä¼šä¸€ç›´æŒç»­ä¸‹å»ã€‚ 2.ä¸€ä¸ªä¾‹å­ä»¥ç”µæ¢¯ä¸ºä¾‹ï¼Œç®€å•è€ƒè™‘ï¼Œç”µæ¢¯æ‹¥æœ‰ä¸‰ç§çŠ¶æ€ï¼šâ€œå¼€å¯â€ã€â€œåœæ­¢/å…³é—­â€ã€â€œç§»åŠ¨â€ã€‚æ˜¾ç„¶ä¸ºäº†å®‰å…¨èµ·è§ï¼Œç”µæ¢¯åœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­éœ€è¦ä¿æŒç”µæ¢¯é—¨å…³é—­ï¼›è€Œç”µæ¢¯é—¨åœ¨å¼€å¯çŠ¶æ€ä¸‹ï¼Œå¯ä»¥å†æ¬¡å¼€å¯ç”µæ¢¯é—¨ä»¥è®©å…¶ä»–äººè¿›å…¥ã€‚ç”µæ¢¯ä¸‰ç§çŠ¶æ€çš„è½¬æ¢å¦‚ä¸‹å›¾ï¼š 3.ä»£ç æ­£å¥½ç”¨golangæ¥å®ç°ä¸‹ä¸€ä¸ªç®€å•çš„fsmã€‚ç”±çŠ¶æ€æ¥å£State interface{}ç»Ÿä¸€å®šä¹‰çŠ¶æ€ï¼ŒçŠ¶æ€ç®¡ç†æœºStatemanageræ¥ç®¡ç†çŠ¶æ€ï¼ŒäºŒè€…å®ç°äº†ä¸€ä¸ªç®€å•fsmçš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚ 3.1 çŠ¶æ€æ¥å£state.goä¸ºäº†ç»Ÿä¸€ç®¡ç†çŠ¶æ€ï¼Œéœ€è¦ä½¿ç”¨æ¥å£å®šä¹‰çŠ¶æ€ã€‚çŠ¶æ€æœºä»çŠ¶æ€æ¥å£æŸ¥è¯¢åˆ°ç”¨æˆ·çš„è‡ªå®šä¹‰çŠ¶æ€åº”è¯¥å…·å¤‡çš„å±æ€§æœ‰ï¼š Name(): å¯¹åº”Stateæ¥å£çš„åç§°ï¼› EnableSelfTransit(): æ˜¯å¦å…è®¸åŒçŠ¶æ€è½¬ç§»ï¼› CanTransitTo(): èƒ½å¦è½¬ç§»åˆ°æŒ‡å®šçŠ¶æ€ã€‚ 12345678910111213141516171819package mainimport \"reflect\"type State interface { Name() string EnableSelfTransit() bool OnBegin() OnEnd() CanTransitTo(name string) bool}func GetStateName(s State) string { if s == nil { return \"none\" } // Use reflect to get the name of state (not the var name) return reflect.TypeOf(s).Elem().Name()} éœ€è¦è¯´æ˜GetStateName()æ–¹æ³•ï¼Œç”±äºStateåœ¨åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥ç†è§£ä¸ºOpeningState Stateï¼Œé™¤äº†ç¼ºçœçš„å±æ€§å¤–ï¼Œå…¶ä»–å±æ€§éƒ½æ˜¯ç©ºå€¼ï¼Œè¿™å…¶ä¸­å°±åŒ…æ‹¬å¾ˆå…³é”®çš„nameï¼ŒGetStateName()é€šè¿‡reflectç›´æ¥è·å–å®ä¾‹çš„åç§°ä½œä¸ºnameã€‚ 3.2 çŠ¶æ€ä¿¡æ¯info.goå®šä¹‰äº†ç»“æ„ä½“StateInfoï¼Œç›®çš„æ˜¯ä¸ºäº†åœ¨çŠ¶æ€åˆå§‹åŒ–æ—¶ï¼Œå°†ä¸€äº›å€¼èµ‹ä¸ºç¼ºçœå€¼ï¼Œé¿å…åœ¨å¾ˆå¤šçŠ¶æ€ä¸­é‡å¤ç¼–å†™å¾ˆå¤šä»£ç ã€‚(å½“ç„¶ï¼Œå¯ä»¥é€šè¿‡é‡å†™ä¿®æ”¹ç¼ºçœçš„å€¼) 12345678910111213141516171819202122232425262728type StateInfo struct { name string}func (s *StateInfo) Name() string { return s.name}func (s *StateInfo) setName(name string) { s.name = name}// Default infofunc (s *StateInfo) EnableSelfTransit() bool { // False by default return false}func (s *StateInfo) OnBegin() {}func (s *StateInfo) OnEnd() {}func (s *StateInfo) CanTransitTo(name string) bool { // True by default return true} 3.3 çŠ¶æ€ç®¡ç†statemgr.goStateManagerä¸ºfsmçš„æ ¸å¿ƒï¼Œé€šè¿‡æ˜ å°„stateByNameä¿å­˜æ‰€æœ‰çš„çŠ¶æ€ï¼Œå®šä¹‰å›è°ƒå‡½æ•°OnChange()æä¾›çŠ¶æ€è½¬ç§»çš„é€šçŸ¥(ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–åŠŸèƒ½)ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889package mainimport ( \"errors\")type StateManager struct { stateByName map[string]State // Callback while state gets changed OnChange func(from, to State) curr State}func (sm *StateManager) Get(name string) State { // In case get panic when 'name' do not exist if v, ok := sm.stateByName[name]; ok { return v } return nil}func (sm *StateManager) Add(s State) { name := GetStateName(s) // State does not have any interface of setName() // Though StateInfo gets one s.(interface{ // Actually this method is from StateInfo setName(name string) }).setName(name) // Check name duplication if sm.Get(name) != nil { panic(\"Duplicate state:\" + name) } sm.stateByName[name] = s}// Init StateManagerfunc NewStateManager() *StateManager { return &amp;StateManager{ stateByName: make(map[string]State), }}// Define errorsvar ErrStateNotFound = errors.New(\"state not found\")var ErrForbidSelfStateTransit = errors.New(\"forbid self transit\")var ErrCannotTransitToState = errors.New(\"cannot transit to state\")func (sm *StateManager) GetCurrState() State { return sm.curr}func (sm *StateManager) CanCurrTransitTo(name string) bool { if sm.curr == nil { return true } if sm.curr.Name() == name &amp;&amp; !sm.curr.EnableSelfTransit() { return false } return sm.curr.CanTransitTo(name)}func (sm *StateManager) Transit(name string) error { next := sm.stateByName[name] pre :=sm.curr if next == nil { return ErrStateNotFound } if pre != nil { // Maybe it's more secure to compare with string if GetStateName(pre) == name &amp;&amp; pre.EnableSelfTransit() { goto transitHere } if !pre.CanTransitTo(name) { return ErrCannotTransitToState } pre.OnEnd() }transitHere: sm.curr = next sm.curr.OnBegin() if sm.OnChange != nil { sm.OnChange(pre, sm.curr) } return nil} åœ¨æ–¹æ³•Add()ä¸­æœ‰ä¸ªå¾ˆæœ‰è¶£çš„æ“ä½œï¼š 123s.(interface{ setName(name string)}).setName(name) ç”±äºåœ¨å®ä¾‹åŒ–å„ä¸ªçŠ¶æ€çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†StateInfoä½œä¸ºå†…åµŒç»“æ„ä½“ï¼Œè€Œåœ¨ä¼ åˆ°Add(s State)ä¸­æ—¶ï¼Œç»“æ„ä½“StateInfoåŒ…å«äº†Stateæ¥å£ä¸­å¹¶æœªå®šä¹‰çš„æ–¹æ³•setName()ï¼Œå› æ­¤éœ€è¦é€šè¿‡ä¸€ä¸ªç±»å‹è½¬æ¢ï¼Œæ¥è°ƒç”¨setName()æ–¹æ³•ã€‚å¾ˆéªšï¼Œå­¦ä¼šäº† 3.4 ä¸»æ–¹æ³•main.go12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182package mainimport \"fmt\"type OpeningState struct { StateInfo}func (os *OpeningState) OnBegin() { fmt.Println(\"Elevator is opening\")}func (os *OpeningState) OnEnd() { fmt.Println(\"Elevator is closing\")}// Overwrite EnableSelfTransit()func (os *OpeningState) EnableSelfTransit() bool { return true}// Compete state transiting road-mapfunc (os *OpeningState) CanTransitTo(name string) bool { return name == \"StoppingState\"}type StoppingState struct { StateInfo}func (ss *StoppingState) OnBegin() { fmt.Println(\"Elevator is stopped\")}func (ss *StoppingState) OnEnd() { fmt.Println(\"Watch out, elevator is going to move\")}func (ss *StoppingState) CanTransitTo(name string) bool { return name != \"StoppingState\"}type RunningState struct { StateInfo}func (rs *RunningState) OnBegin() { fmt.Println(\"Elevator is moving\")}func (rs *RunningState) OnEnd() { fmt.Println(\"Elevator reaches target floor\")}func (rs *RunningState) CanTransitTo(name string) bool { return name == \"StoppingState\"}func transitAndReport(sm *StateManager, target string) { if err := sm.Transit(target); err != nil { fmt.Printf(\"FAILED transit from %s to %s\\nError: %s\\n\", GetStateName(sm.curr), target, err.Error()) }}func main() { sm := NewStateManager() sm.OnChange = func(from, to State) { fmt.Printf(\"%s -----&gt; %s\\n\", GetStateName(from), GetStateName(to)) } // Instantiate states and Add them to statemgr sm.Add(new(OpeningState)) sm.Add(new(StoppingState)) sm.Add(new(RunningState)) transitAndReport(sm, \"OpeningState\") transitAndReport(sm, \"OpeningState\") transitAndReport(sm, \"StoppingState\") transitAndReport(sm, \"RunningState\") transitAndReport(sm, \"StoppingState\") transitAndReport(sm, \"OpeningState\")} main.goä¸­å®šä¹‰äº†ä¸‰ç§ä¸åŒçš„çŠ¶æ€ï¼Œå°†StateInfoå†…åµŒä»¥å®ç°å±æ€§çš„é»˜è®¤å€¼è®¾ç½®ï¼Œå¯¹äºéœ€è¦ä¿®æ”¹çš„å±æ€§ï¼Œé‡å†™äº†ç›¸åº”çš„æ–¹æ³•ã€‚ è¾“å‡ºï¼š 12345678910111213141516Elevator is openingnone -----&gt; OpeningStateElevator is openingOpeningState -----&gt; OpeningStateElevator is closingElevator is stoppedOpeningState -----&gt; StoppingStateWatch out, elevator is going to moveElevator is movingStoppingState -----&gt; RunningStateElevator reaches target floorElevator is stoppedRunningState -----&gt; StoppingStateWatch out, elevator is going to moveElevator is openingStoppingState -----&gt; OpeningState å½“ç„¶ï¼Œä¸€äº›é”™è¯¯è½¬æ¢ä¸»æ–¹æ³•ä¸­æ²¡æœ‰æµ‹è¯•ï¼Œä½ ä¹Ÿå¯ä»¥è¯•è¯•ã€‚ 4 å‚è€ƒ https://new-tonywang.github.io/2020/02/12/FSM/ http://www.ruanyifeng.com/blog/2013/09/finite-state_machine_for_javascript.html https://www.zhihu.com/question/31845498","link":"/2020/03/08/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BAFSM/"},{"title":"[NOTE] ç½‘é€Ÿç½‘é€Ÿï¼","text":"è™½ç„¶åç¡•å®˜æ”¹å›ºä»¶ä¸­æœ‰ä¸€ä¸ªå•çº¿å¤šæ‹¨çš„åŠŸèƒ½ï¼Œä½†å¬è¯´ä¸å¤ªç¨³å®šï¼Œå®‰å…¨èµ·è§ï¼Œä½¿ç”¨å®˜æ–¹åŒçº¿åŒæ‹¨åŠŸèƒ½æ¥å¢åŠ å¸¦å®½ã€‚ å…ˆè¯´ç»“æœï¼ŒåŒæ‹¨æˆåŠŸã€‚åœ¨è·¯ç”±ç®¡ç†é¡µé¢é¦–é¡µå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªWANæ¥å…¥ æµ‹è¯•é€Ÿåº¦TP-linkè·¯ç”±å™¨å•æ‹¨æµ‹é€Ÿï¼š Asus-RT-AC86UåŒæ‹¨æµ‹é€Ÿï¼š æ’é™¤è·¯ç”±å™¨ä¹‹é—´çš„å·®å¼‚ï¼ŒAC86Uå¯å°†ä¸¤æ ¹WANç½‘é€Ÿåº¦è·‘æ»¡ã€‚ è¿‡ç¨‹ç®¡ç†é¡µé¢-å¤–éƒ¨ç½‘ç»œ-åŒçº¿è·¯ å‰é¢ä¹Ÿæåˆ°è¿‡ï¼ŒåŒçº¿åŒæ‹¨æ›´ç¨³å®šã€‚å¼€å¯åŒçº¿è·¯ï¼Œä½¿ç”¨LAN1å£ä½œä¸ºå¤‡ç”¨WANå£ å†…éƒ¨ç½‘ç»œï¼Œé…ç½®ç¬¬äºŒä¸ªWANå£ï¼Œç”±äºç½‘çº¿ä¸å¤Ÿé•¿ï¼Œä¸­é—´ç®—æ˜¯ç”¨TP-linkè·¯ç”±å™¨åšäº†ä¸ªæ¡¥æ¥ï¼Œæ‰€ä»¥External LANå£è¿™å¹¶ä¸éœ€è¦æ‹¨å· è·å–æœ¬æœºMACåœ°å€ï¼Œæ³¨æ„ä¸¤ä¸ªWANå£MACåœ°å€è¦åšå‡ºåŒºåˆ«ï¼Œæˆ‘çš„å¤„ç†æ–¹æ³•æ˜¯åœ¨ç¬¬äºŒä¸ªWANå£MACåœ°å€æœ€åä¸€ä½åŠ äº†ä¸ªä¸€ã€‚ åº”ç”¨é…ç½®ï¼ŒæˆåŠŸ","link":"/2019/08/06/%E7%BD%91%E9%80%9F%E7%BD%91%E9%80%9F/"},{"title":"[Debug] è¸©è¿‡çš„å‘-UbuntuDNSé…ç½®","text":"Ubuntu18.04é‡å¯ä¹‹åä¼šå‡ºç°æ— æ³•è¿æ¥ç½‘ç»œçš„é—®é¢˜ï¼Œæ’æŸ¥å¾—é—®é¢˜å‡ºç°åœ¨DNSä¸Šï¼Œç„¶è€Œä¸­æ–‡ç¤¾åŒºå¯¹è¿™ä¸ªæ–¹æ³•çš„è§£å†³éƒ½ä¸ç”šä»¤äººæ»¡æ„ï¼ŒæŠ˜è…¾äº†åŠä¸ªæ™šä¸Šï¼Œæ‰å‘ç°This is pretty simple to fix though. è‹¥å·²ç»è¿ä¸ä¸Šç½‘äº†ï¼Œå…ˆä¿®æ”¹/etc/resolv.confï¼Œæ·»åŠ nameserver 114.114.114.114æˆ–å…¶ä»–ï¼Œä¸è¦restart networkä¹‹ç±»çš„ï¼Œé‚£æ ·ä¼šå¯¼è‡´æ–‡ä»¶è¢«è¦†ç›– sudo apt install resolvconf sudo vi /etc/resolvconf/resolve.conf.d/head # Make edits to /etc/**resolvconf**/**resolv**.**conf**.d/head. nameserver 8.8.4.4 nameserver 8.8.8.8. sudo service resolvconf restart","link":"/2019/07/10/%E8%B8%A9%E8%BF%87%E7%9A%84%E5%9D%91-UbuntuDNS%E9%85%8D%E7%BD%AE/"},{"title":"[NOTE] é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ","text":"æ¯æ¬¡ååˆ†é’Ÿï¼Œå¿«ä¹ä¸€ä¸‡å¹´ é•œåƒåŠ é€Ÿå™¨åœ°å€ï¼š https://0ghk1qyk.mirror.aliyuncs.com ubuntu12345678sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'{ \"registry-mirrors\": [\"https://0ghk1qyk.mirror.aliyuncs.com\"]}EOFsudo systemctl daemon-reloadsudo systemctl restart docker CentOS12345678sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'{ \"registry-mirrors\": [\"https://0ghk1qyk.mirror.aliyuncs.com\"]}EOFsudo systemctl daemon-reloadsudo systemctl restart docker MacDocker for Mac é’ˆå¯¹å®‰è£…äº†Docker Toolboxçš„ç”¨æˆ·ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®æ­¥éª¤ï¼š åˆ›å»ºä¸€å°å®‰è£…æœ‰Dockerç¯å¢ƒçš„Linuxè™šæ‹Ÿæœºï¼ŒæŒ‡å®šæœºå™¨åç§°ä¸ºdefaultï¼ŒåŒæ—¶é…ç½®DockeråŠ é€Ÿå™¨åœ°å€ã€‚ 1docker-machine create --engine-registry-mirror=https://0ghk1qyk.mirror.aliyuncs.com -d virtualbox default æŸ¥çœ‹æœºå™¨çš„ç¯å¢ƒé…ç½®ï¼Œå¹¶é…ç½®åˆ°æœ¬åœ°ï¼Œå¹¶é€šè¿‡Dockerå®¢æˆ·ç«¯è®¿é—®DockeræœåŠ¡ã€‚ 1docker-machine env defaulteval &quot;$(docker-machine env default)&quot;docker info é’ˆå¯¹å®‰è£…äº†Docker for Macçš„ç”¨æˆ·ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®æ­¥éª¤ï¼š å³é”®ç‚¹å‡»æ¡Œé¢é¡¶æ çš„ docker å›¾æ ‡ï¼Œé€‰æ‹© Preferences ï¼Œåœ¨ Daemon æ ‡ç­¾ï¼ˆDocker 17.03 ä¹‹å‰ç‰ˆæœ¬ä¸º Advanced æ ‡ç­¾ï¼‰ä¸‹çš„ Registry mirrors åˆ—è¡¨ä¸­å°†https://0ghk1qyk.mirror.aliyuncs.comåŠ åˆ°â€registry-mirrorsâ€çš„æ•°ç»„é‡Œï¼Œç‚¹å‡» Apply &amp; RestartæŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚","link":"/2019/08/08/%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/"}],"tags":[{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"hadoop","slug":"hadoop","link":"/tags/hadoop/"},{"name":"NOTE","slug":"NOTE","link":"/tags/NOTE/"},{"name":"golang","slug":"golang","link":"/tags/golang/"},{"name":"Golang","slug":"Golang","link":"/tags/Golang/"},{"name":"hugo","slug":"hugo","link":"/tags/hugo/"},{"name":"Nginx","slug":"Nginx","link":"/tags/Nginx/"},{"name":"https","slug":"https","link":"/tags/https/"},{"name":"algorithm","slug":"algorithm","link":"/tags/algorithm/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"Kubernetes","slug":"Kubernetes","link":"/tags/Kubernetes/"},{"name":"linux","slug":"linux","link":"/tags/linux/"},{"name":"backup","slug":"backup","link":"/tags/backup/"},{"name":"shell","slug":"shell","link":"/tags/shell/"},{"name":"Java","slug":"Java","link":"/tags/Java/"},{"name":"Debug","slug":"Debug","link":"/tags/Debug/"},{"name":"VMware","slug":"VMware","link":"/tags/VMware/"},{"name":"docker","slug":"docker","link":"/tags/docker/"},{"name":"frp","slug":"frp","link":"/tags/frp/"},{"name":"leetcode","slug":"leetcode","link":"/tags/leetcode/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"ssh","slug":"ssh","link":"/tags/ssh/"},{"name":"database","slug":"database","link":"/tags/database/"},{"name":"FSM","slug":"FSM","link":"/tags/FSM/"}],"categories":[{"name":"Operations","slug":"Operations","link":"/categories/Operations/"},{"name":"Developments","slug":"Developments","link":"/categories/Developments/"},{"name":"Others","slug":"Others","link":"/categories/Others/"},{"name":"Spring Cloud","slug":"Spring-Cloud","link":"/categories/Spring-Cloud/"},{"name":"undefined","slug":"undefined","link":"/categories/undefined/"},{"name":"essay","slug":"essay","link":"/categories/essay/"},{"name":"tips","slug":"tips","link":"/categories/tips/"}]}